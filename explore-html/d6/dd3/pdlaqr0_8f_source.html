<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ScaLAPACK 2.1: SRC/pdlaqr0.f Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../ScaLAPACK logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ScaLAPACK 2.1
   &#160;<span id="projectnumber">2.1</span>
   </div>
   <div id="projectbrief">ScaLAPACK: Scalable Linear Algebra PACKage</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d6/dd3/pdlaqr0_8f_source.html','../../');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">pdlaqr0.f</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d6/dd3/pdlaqr0_8f.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;      <span class="keywordtype">RECURSIVE</span> <span class="keyword">SUBROUTINE </span><a class="code" href="../../d6/dd3/pdlaqr0_8f.html#afdd0414fd613914f2935567408480ffb">pdlaqr0</a>( WANTT, WANTZ, N, ILO, IHI, H,</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;     $     DESCH, WR, WI, ILOZ, IHIZ, Z, DESCZ, WORK, LWORK,</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;     $     IWORK, LIWORK, INFO, RECLEVEL )</div>
<div class="line"><a name="l00004"></a><span class="lineno"><a class="line" href="../../d6/dd3/pdlaqr0_8f.html#afdd0414fd613914f2935567408480ffb">    4</a></span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">*     Contribution from the Department of Computing Science and HPC2N,</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">*     Umea University, Sweden</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">*  -- ScaLAPACK auxiliary routine (version 2.0.1) --</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">*     University of Tennessee, Knoxville, Oak Ridge National Laboratory,</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">*     Univ. of Colorado Denver and University of California, Berkeley.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">*     January, 2012</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">*     .. Scalar Arguments ..</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;      <span class="keywordtype">INTEGER</span>            ihi, ihiz, ilo, iloz, info, liwork, lwork, n,</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;     $                   reclevel</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;      <span class="keywordtype">LOGICAL</span>            wantt, wantz</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">*     .. Array Arguments ..</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;      <span class="keywordtype">INTEGER</span>            desch( * ), descz( * ), iwork( * )</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span>   h( * ), wi( n ), work( * ), wr( n ),</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;     $                   z( * )</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">*  Purpose</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">*  =======</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">*  PDLAQR0 computes the eigenvalues of a Hessenberg matrix H</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">*  and, optionally, the matrices T and Z from the Schur decomposition</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">*  H = Z*T*Z**T, where T is an upper quasi-triangular matrix (the</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">*  Schur form), and Z is the orthogonal matrix of Schur vectors.</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">*  Optionally Z may be postmultiplied into an input orthogonal</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">*  matrix Q so that this routine can give the Schur factorization</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">*  of a matrix A which has been reduced to the Hessenberg form H</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">*  by the orthogonal matrix Q:</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">*       A = Q * H * Q**T = (QZ) * T * (QZ)**T.</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">*  Notes</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">*  =====</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">*  Each global data object is described by an associated description</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">*  vector.  This vector stores the information required to establish</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">*  the mapping between an object element and its corresponding process</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">*  and memory location.</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">*  Let A be a generic term for any 2D block cyclicly distributed array.</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">*  Such a global array has an associated description vector DESCA.</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">*  In the following comments, the character _ should be read as</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">*  &quot;of the global array&quot;.</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">*  NOTATION        STORED IN      EXPLANATION</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">*  --------------- -------------- --------------------------------------</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">*  DTYPE_A(global) DESCA( DTYPE_ )The descriptor type.  In this case,</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">*                                 DTYPE_A = 1.</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">*  CTXT_A (global) DESCA( CTXT_ ) The BLACS context handle, indicating</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">*                                 the BLACS process grid A is distribu-</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">*                                 ted over. The context itself is glo-</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">*                                 bal, but the handle (the integer</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">*                                 value) may vary.</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">*  M_A    (global) DESCA( M_ )    The number of rows in the global</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">*                                 array A.</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">*  N_A    (global) DESCA( N_ )    The number of columns in the global</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">*                                 array A.</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">*  MB_A   (global) DESCA( MB_ )   The blocking factor used to distribute</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">*                                 the rows of the array.</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">*  NB_A   (global) DESCA( NB_ )   The blocking factor used to distribute</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">*                                 the columns of the array.</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">*  RSRC_A (global) DESCA( RSRC_ ) The process row over which the first</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">*                                 row of the array A is distributed.</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">*  CSRC_A (global) DESCA( CSRC_ ) The process column over which the</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">*                                 first column of the array A is</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">*                                 distributed.</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">*  LLD_A  (local)  DESCA( LLD_ )  The leading dimension of the local</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">*                                 array.  LLD_A &gt;= MAX(1,LOCr(M_A)).</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">*  Let K be the number of rows or columns of a distributed matrix,</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">*  and assume that its process grid has dimension p x q.</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">*  LOCr( K ) denotes the number of elements of K that a process</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">*  would receive if K were distributed over the p processes of its</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">*  process column.</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">*  Similarly, LOCc( K ) denotes the number of elements of K that a</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">*  process would receive if K were distributed over the q processes of</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">*  its process row.</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">*  The values of LOCr() and LOCc() may be determined via a call to the</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">*  ScaLAPACK tool function, NUMROC:</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">*          LOCr( M ) = NUMROC( M, MB_A, MYROW, RSRC_A, NPROW ),</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">*          LOCc( N ) = NUMROC( N, NB_A, MYCOL, CSRC_A, NPCOL ).</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">*  An upper bound for these quantities may be computed by:</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">*          LOCr( M ) &lt;= ceil( ceil(M/MB_A)/NPROW )*MB_A</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">*          LOCc( N ) &lt;= ceil( ceil(N/NB_A)/NPCOL )*NB_A</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">*  Arguments</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">*  =========</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">*  WANTT   (global input) LOGICAL</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">*          = .TRUE. : the full Schur form T is required;</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">*          = .FALSE.: only eigenvalues are required.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">*  WANTZ   (global input) LOGICAL</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">*          = .TRUE. : the matrix of Schur vectors Z is required;</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">*          = .FALSE.: Schur vectors are not required.</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">*  N       (global input) INTEGER</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">*          The order of the Hessenberg matrix H (and Z if WANTZ).</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">*          N &gt;= 0.</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">*  ILO     (global input) INTEGER</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">*  IHI     (global input) INTEGER</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">*          It is assumed that H is already upper triangular in rows</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">*          and columns 1:ILO-1 and IHI+1:N. ILO and IHI are normally</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">*          set by a previous call to PDGEBAL, and then passed to PDGEHRD</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">*          when the matrix output by PDGEBAL is reduced to Hessenberg</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">*          form. Otherwise ILO and IHI should be set to 1 and N</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">*          respectively.  If N.GT.0, then 1.LE.ILO.LE.IHI.LE.N.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">*          If N = 0, then ILO = 1 and IHI = 0.</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">*  H       (global input/output) DOUBLE PRECISION array, dimension</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">*          (DESCH(LLD_),*)</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">*          On entry, the upper Hessenberg matrix H.</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">*          On exit, if JOB = &#39;S&#39;, H is upper quasi-triangular in</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">*          rows and columns ILO:IHI, with 1-by-1 and 2-by-2 blocks on</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">*          the main diagonal.  The 2-by-2 diagonal blocks (corresponding</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">*          to complex conjugate pairs of eigenvalues) are returned in</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">*          standard form, with H(i,i) = H(i+1,i+1) and</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">*          H(i+1,i)*H(i,i+1).LT.0. If INFO = 0 and JOB = &#39;E&#39;, the</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">*          contents of H are unspecified on exit.</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">*  DESCH   (global and local input) INTEGER array of dimension DLEN_.</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">*          The array descriptor for the distributed matrix H.</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">*  WR      (global output) DOUBLE PRECISION array, dimension (N)</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">*  WI      (global output) DOUBLE PRECISION array, dimension (N)</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">*          The real and imaginary parts, respectively, of the computed</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">*          eigenvalues ILO to IHI are stored in the corresponding</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">*          elements of WR and WI. If two eigenvalues are computed as a</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">*          complex conjugate pair, they are stored in consecutive</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">*          elements of WR and WI, say the i-th and (i+1)th, with</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">*          WI(i) &gt; 0 and WI(i+1) &lt; 0. If JOB = &#39;S&#39;, the</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">*          eigenvalues are stored in the same order as on the diagonal</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">*          of the Schur form returned in H.</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">*  Z       (global input/output) DOUBLE PRECISION array.</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">*          If COMPZ = &#39;V&#39;, on entry Z must contain the current</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">*          matrix Z of accumulated transformations from, e.g., PDGEHRD,</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">*          and on exit Z has been updated; transformations are applied</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">*          only to the submatrix Z(ILO:IHI,ILO:IHI).</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">*          If COMPZ = &#39;N&#39;, Z is not referenced.</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">*          If COMPZ = &#39;I&#39;, on entry Z need not be set and on exit,</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">*          if INFO = 0, Z contains the orthogonal matrix Z of the Schur</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">*           vectors of H.</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">*  DESCZ   (global and local input) INTEGER array of dimension DLEN_.</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">*          The array descriptor for the distributed matrix Z.</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">*  WORK    (local workspace) DOUBLE PRECISION array, dimension(DWORK)</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">*  LWORK   (local input) INTEGER</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">*          The length of the workspace array WORK.</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">*  IWORK   (local workspace) INTEGER array, dimension (LIWORK)</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">*  LIWORK  (local input) INTEGER</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">*          The length of the workspace array IWORK.</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">*  INFO    (output) INTEGER</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">*          =    0:  successful exit</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">*          .LT. 0:  if INFO = -i, the i-th argument had an illegal</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">*                   value</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">*          .GT. 0:  if INFO = i, PDLAQR0 failed to compute all of</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">*                   the eigenvalues.  Elements 1:ilo-1 and i+1:n of WR</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">*                   and WI contain those eigenvalues which have been</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">*                   successfully computed.  (Failures are rare.)</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">*                If INFO .GT. 0 and JOB = &#39;E&#39;, then on exit, the</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">*                remaining unconverged eigenvalues are the eigen-</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">*                values of the upper Hessenberg matrix rows and</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">*                columns ILO through INFO of the final, output</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">*                value of H.</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">*                If INFO .GT. 0 and JOB   = &#39;S&#39;, then on exit</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">*           (*)  (initial value of H)*U  = U*(final value of H)</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">*                where U is an orthogonal matrix.  The final</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">*                value of H is upper Hessenberg and quasi-triangular</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">*                in rows and columns INFO+1 through IHI.</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">*                If INFO .GT. 0 and COMPZ = &#39;V&#39;, then on exit</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">*                  (final value of Z)  =  (initial value of Z)*U</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">*                where U is the orthogonal matrix in (*) (regard-</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">*                less of the value of JOB.)</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">*                If INFO .GT. 0 and COMPZ = &#39;I&#39;, then on exit</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">*                      (final value of Z)  = U</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">*                where U is the orthogonal matrix in (*) (regard-</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">*                less of the value of JOB.)</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">*                If INFO .GT. 0 and COMPZ = &#39;N&#39;, then Z is not</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">*                accessed.</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">*     ================================================================</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">*     Based on contributions by</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">*        Robert Granat, Department of Computing Science and HPC2N,</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">*        Umea University, Sweden.</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">*     ================================================================</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">*     Restrictions: The block size in H and Z must be square and larger</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">*     than or equal to six (6) due to restrictions in PDLAQR1, PDLAQR5</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">*     and DLAQR6. Moreover, H and Z need to be distributed identically</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">*     with the same context.</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">*     ================================================================</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">*     References:</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">*       K. Braman, R. Byers, and R. Mathias,</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">*       The Multi-Shift QR Algorithm Part I: Maintaining Well Focused</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">*       Shifts, and Level 3 Performance.</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">*       SIAM J. Matrix Anal. Appl., 23(4):929--947, 2002.</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">*       K. Braman, R. Byers, and R. Mathias,</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">*       The Multi-Shift QR Algorithm Part II: Aggressive Early</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">*       Deflation.</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">*       SIAM J. Matrix Anal. Appl., 23(4):948--973, 2002.</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">*       R. Granat, B. Kagstrom, and D. Kressner,</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">*       A Novel Parallel QR Algorithm for Hybrid Distributed Momory HPC</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">*       Systems.</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">*       SIAM J. Sci. Comput., 32(4):2345--2378, 2010.</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">*     ================================================================</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">*     .. Parameters ..</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">*     ==== Exceptional deflation windows:  try to cure rare</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">*     .    slow convergence by increasing the size of the</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">*     .    deflation window after KEXNW iterations. =====</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">*     ==== Exceptional shifts: try to cure rare slow convergence</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">*     .    with ad-hoc exceptional shifts every KEXSH iterations.</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">*     .    The constants WILK1 and WILK2 are used to form the</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">*     .    exceptional shifts. ====</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="keywordtype">INTEGER</span>            block_cyclic_2d, csrc_, ctxt_, dlen_, dtype_,</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;     $                   lld_, mb_, m_, nb_, n_, rsrc_</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="keywordtype">INTEGER</span>            recmax</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <span class="keywordtype">PARAMETER</span>          ( block_cyclic_2d = 1, dlen_ = 9, dtype_ = 1,</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;     $                     ctxt_ = 2, m_ = 3, n_ = 4, mb_ = 5, nb_ = 6,</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;     $                     rsrc_ = 7, csrc_ = 8, lld_ = 9, recmax = 3 )</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="keywordtype">INTEGER</span>            ntiny</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <span class="keywordtype">PARAMETER</span>          ( ntiny = 11 )</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="keywordtype">INTEGER</span>            kexnw, kexsh</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      parameter( kexnw = 5, kexsh = 6 )</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span>   wilk1, wilk2</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      parameter( wilk1 = 0.75d0, wilk2 = -0.4375d0 )</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span>   zero, one</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      parameter( zero = 0.0d0, one = 1.0d0 )</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">*     .. Local Scalars ..</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span>   aa, bb, cc, cs, dd, sn, ss, swap, elem, t0,</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;     $                   elem1, elem2, elem3, alpha, sdsum, stamp</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="keywordtype">INTEGER</span>            i, j, inf, it, itmax, k, kacc22, kbot, kdu, ks,</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;     $                   kt, ktop, ku, kv, kwh, kwtop, kwv, ld, ls,</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;     $                   lwkopt, ndfl, nh, nho, nibble, nmin, ns, nsmax,</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;     $                   nsr, nve, nw, nwmax, nwr, lldh, lldz, ii, jj,</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;     $                   ictxt, nprow, npcol, myrow, mycol, ipv, ipt,</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;     $                   ipw, ipwrk, vrows, vcols, trows, tcols, wrows,</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;     $                   wcols, hrsrc, hcsrc, nb, is, ie, nprocs, kk,</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;     $                   iroffh, icoffh, hrsrc3, hcsrc3, nwin, totit,</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;     $                   sweep, jw, totns, liwkopt, npmin, ictxt_new,</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;     $                   myrow_new, mycol_new</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <span class="keywordtype">LOGICAL</span>            nwinc, sorted, lquery, recursion</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="keywordtype">CHARACTER</span>          jbcmpz*2</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">*     .. External Functions ..</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="keywordtype">INTEGER</span>            <a class="code" href="../../dc/d00/pilaenvx_8f.html#acd31afd7cd48a41160245dd25b19ac72">pilaenvx</a>, <a class="code" href="../../d4/d48/numroc_8f.html#aeaf233ca9d355163e321443f8b4611af">numroc</a>, <a class="code" href="../../d6/d88/indxg2p_8f.html#a9ce1dd9878d80910658c5a110815e642">indxg2p</a>, <a class="code" href="../../df/d07/iceil_8f.html#aef3085a2d6d5e24b028a01a1aa8132e3">iceil</a>, blacs_pnum</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="keywordtype">EXTERNAL</span>           <a class="code" href="../../dc/d00/pilaenvx_8f.html#acd31afd7cd48a41160245dd25b19ac72">pilaenvx</a>, <a class="code" href="../../d4/d48/numroc_8f.html#aeaf233ca9d355163e321443f8b4611af">numroc</a>, <a class="code" href="../../d6/d88/indxg2p_8f.html#a9ce1dd9878d80910658c5a110815e642">indxg2p</a>, <a class="code" href="../../df/d07/iceil_8f.html#aef3085a2d6d5e24b028a01a1aa8132e3">iceil</a>, blacs_pnum</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">*     .. Local Arrays ..</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <span class="keywordtype">INTEGER</span>            descv( dlen_ ), desct( dlen_ ), descw( dlen_ ),</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;     $                   pmap( 64*64 )</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span>   zdum( 1, 1 )</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">*     .. External Subroutines ..</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <span class="keywordtype">EXTERNAL</span>           <a class="code" href="../../da/dc2/pdlacpy_8f.html#aa636d5b0fc7e696760b0583b9ae2c59b">pdlacpy</a>, <a class="code" href="../../da/dd8/pdlaqr1_8f.html#a47a41c4fbb749e0f0ab6a20e78b22f62">pdlaqr1</a>, dlanv2, <a class="code" href="../../d9/d91/pdlaqr3_8f.html#ad5273e920e9ff33a76d6ab98a672b262">pdlaqr3</a>, <a class="code" href="../../d6/d6b/pdlaqr5_8f.html#a3ebbe3bfa5f285b4112b2180c9d3889a">pdlaqr5</a>,</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;     $                   <a class="code" href="../../db/dfa/pdelget_8f.html#a8bcf89b372b70ee2d2d9035c00ea794c">pdelget</a>, dlaqr0, dlaset, pdgemr2d</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">*     .. Intrinsic Functions ..</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <span class="keywordtype">INTRINSIC</span>          abs, dble, int, <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>, <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>, mod</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">*     .. Executable Statements ..</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      info = 0</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      ictxt = desch( ctxt_ )</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="keyword">CALL </span>blacs_gridinfo( ictxt, nprow, npcol, myrow, mycol )</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      nprocs = nprow*npcol</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      recursion = reclevel .LT. recmax</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">*     Quick return for N = 0: nothing to do.</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <span class="keywordflow">IF</span>( n.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;         work( 1 ) = one</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;         iwork( 1 ) = 1</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;         <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">*     Set up job flags for PILAENV.</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="keywordflow">IF</span>( wantt ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;         jbcmpz( 1: 1 ) = <span class="stringliteral">&#39;S&#39;</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;         jbcmpz( 1: 1 ) = <span class="stringliteral">&#39;E&#39;</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="keywordflow">IF</span>( wantz ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;         jbcmpz( 2: 2 ) = <span class="stringliteral">&#39;V&#39;</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;         jbcmpz( 2: 2 ) = <span class="stringliteral">&#39;N&#39;</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">*     Check if workspace query</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      lquery = lwork.EQ.-1 .OR. liwork.EQ.-1</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">*     Extract local leading dimensions and block factors of matrices</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">*     H and Z</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      lldh = desch( lld_ )</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      lldz = descz( lld_ )</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      nb = desch( mb_ )</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">*     Tiny (sub-) matrices must use PDLAQR1. (Stops recursion)</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="keywordflow">IF</span>( n.LE.ntiny ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">*     Estimate optimal workspace.</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../da/dd8/pdlaqr1_8f.html#a47a41c4fbb749e0f0ab6a20e78b22f62">pdlaqr1</a>( wantt, wantz, n, ilo, ihi, h, desch, wr, wi,</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;     $        iloz, ihiz, z, descz, work, lwork, iwork, liwork, info )</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;         lwkopt = int( work(1) )</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;         liwkopt = iwork(1)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">*     Completely local matrices uses LAPACK. (Stops recursion)</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <span class="keywordflow">ELSEIF</span>( n.LE.nb ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;         <span class="keywordflow">IF</span>( myrow.EQ.desch(rsrc_) .AND. mycol.EQ.desch(csrc_) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            <span class="keyword">CALL </span>dlaqr0( wantt, wantz, n, ilo, ihi, h, desch(lld_),</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;     $           wr, wi, iloz, ihiz, z, descz(lld_), work, lwork, info )</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            <span class="keywordflow">IF</span>( n.GT.2 )</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;     $         <span class="keyword">CALL </span>dlaset( <span class="stringliteral">&#39;L&#39;</span>, n-2, n-2, zero, zero, h(3),</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;     $              desch(lld_) )</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            lwkopt = int( work(1) )</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            liwkopt = 1</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;         <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            lwkopt = 1</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            liwkopt = 1</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">*     Do one more step of recursion</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">*        Zero out iteration and sweep counters for debugging purposes</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;         totit = 0</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;         sweep = 0</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;         totns = 0</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">*        Use small bulge multi-shift QR with aggressive early</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">*        deflation on larger-than-tiny matrices.</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">*        Hope for the best.</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;         info = 0</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">*        NWR = recommended deflation window size.  At this</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">*        point,  N .GT. NTINY = 11, so there is enough</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">*        subdiagonal workspace for NWR.GE.2 as required.</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">*        (In fact, there is enough subdiagonal space for</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">*        NWR.GE.3.)</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;         nwr = <a class="code" href="../../dc/d00/pilaenvx_8f.html#acd31afd7cd48a41160245dd25b19ac72">pilaenvx</a>( ictxt, 13, <span class="stringliteral">&#39;PDLAQR0&#39;</span>, jbcmpz, n, ilo, ihi,</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;     $        lwork )</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;         nwr = <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( 2, nwr )</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;         nwr = <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( ihi-ilo+1, nwr )</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;         nw = nwr</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">*        NSR = recommended number of simultaneous shifts.</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">*        At this point N .GT. NTINY = 11, so there is at</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">*        enough subdiagonal workspace for NSR to be even</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">*        and greater than or equal to two as required.</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;         nwin = <a class="code" href="../../dc/d00/pilaenvx_8f.html#acd31afd7cd48a41160245dd25b19ac72">pilaenvx</a>( ictxt, 19, <span class="stringliteral">&#39;PDLAQR0&#39;</span>, jbcmpz, n, nb, nb, nb )</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;         nsr = <a class="code" href="../../dc/d00/pilaenvx_8f.html#acd31afd7cd48a41160245dd25b19ac72">pilaenvx</a>( ictxt, 15, <span class="stringliteral">&#39;PDLAQR0&#39;</span>, jbcmpz, n, ilo, ihi,</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;     $        <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>(nwin,nb) )</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;         nsr = <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( nsr, ihi-ilo )</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;         nsr = <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( 2, nsr-mod( nsr, 2 ) )</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">*        Estimate optimal workspace</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;         lwkopt = 3*<a class="code" href="../../df/d07/iceil_8f.html#aef3085a2d6d5e24b028a01a1aa8132e3">iceil</a>(nwr,nprow)*<a class="code" href="../../df/d07/iceil_8f.html#aef3085a2d6d5e24b028a01a1aa8132e3">iceil</a>(nwr,npcol)</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">*        Workspace query call to PDLAQR3</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d9/d91/pdlaqr3_8f.html#ad5273e920e9ff33a76d6ab98a672b262">pdlaqr3</a>( wantt, wantz, n, ilo, ihi, nwr+1, h,</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;     $        desch, iloz, ihiz, z, descz, ls, ld, wr, wi, h,</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;     $        desch, n, h, desch, n, h, desch, work, -1, iwork,</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;     $        liwork, reclevel )</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;         lwkopt = lwkopt + int( work( 1 ) )</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;         liwkopt = iwork( 1 )</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">*        Workspace query call to PDLAQR5</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d6/d6b/pdlaqr5_8f.html#a3ebbe3bfa5f285b4112b2180c9d3889a">pdlaqr5</a>( wantt, wantz, 2, n, 1, n, n, wr, wi, h,</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;     $        desch, iloz, ihiz, z, descz, work, -1, iwork,</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;     $        liwork )</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">*        Optimal workspace = MAX(PDLAQR3, PDLAQR5)</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;         lwkopt = <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( lwkopt, int( work( 1 ) ) )</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;         liwkopt = <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( liwkopt, iwork( 1 ) )</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">*        Quick return in case of workspace query.</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;         <span class="keywordflow">IF</span>( lquery ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            work( 1 ) = dble( lwkopt )</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            iwork( 1 ) = liwkopt</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">*        PDLAQR1/PDLAQR0 crossover point.</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;         nmin = <a class="code" href="../../dc/d00/pilaenvx_8f.html#acd31afd7cd48a41160245dd25b19ac72">pilaenvx</a>( ictxt, 12, <span class="stringliteral">&#39;PDLAQR0&#39;</span>, jbcmpz, n, ilo, ihi,</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;     $        lwork )</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;         nmin = <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( ntiny, nmin )</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">*        Nibble crossover point.</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;         nibble = <a class="code" href="../../dc/d00/pilaenvx_8f.html#acd31afd7cd48a41160245dd25b19ac72">pilaenvx</a>( ictxt, 14, <span class="stringliteral">&#39;PDLAQR0&#39;</span>, jbcmpz, n, ilo, ihi,</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;     $        lwork )</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;         nibble = <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( 0, nibble )</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">*        Accumulate reflections during ttswp?  Use block</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">*        2-by-2 structure during matrix-matrix multiply?</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;         kacc22 = <a class="code" href="../../dc/d00/pilaenvx_8f.html#acd31afd7cd48a41160245dd25b19ac72">pilaenvx</a>( ictxt, 16, <span class="stringliteral">&#39;PDLAQR0&#39;</span>, jbcmpz, n, ilo, ihi,</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;     $        lwork )</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;         kacc22 = <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( 1, kacc22 )</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;         kacc22 = <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( 2, kacc22 )</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">*        NWMAX = the largest possible deflation window for</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">*        which there is sufficient workspace.</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;         nwmax = <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( ( n-1 ) / 3, lwork / 2 )</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">*        NSMAX = the Largest number of simultaneous shifts</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">*        for which there is sufficient workspace.</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;         nsmax = <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( ( n+6 ) / 9, lwork - lwork/3 )</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;         nsmax = nsmax - mod( nsmax, 2 )</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">*        NDFL: an iteration count restarted at deflation.</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;         ndfl = 1</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">*        ITMAX = iteration limit</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;         itmax = <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( 30, 2*kexsh )*<a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( 10, ( ihi-ilo+1 ) )</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">*        Last row and column in the active block.</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;         kbot = ihi</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">*        Main Loop.</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;         <span class="keywordflow">DO</span> 110 it = 1, itmax</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            totit = totit + 1</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">*           Done when KBOT falls below ILO.</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            <span class="keywordflow">IF</span>( kbot.LT.ilo )</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;     $         <span class="keywordflow">GO TO</span> 120</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">*           Locate active block.</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            <span class="keywordflow">DO</span> 10 k = kbot, ilo + 1, -1</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;               <span class="keyword">CALL </span><a class="code" href="../../d9/de1/infog2l_8f.html#a6e7ce55b8c4d7899bea557e986142537">infog2l</a>( k, k-1, desch, nprow, npcol, myrow, mycol,</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;     $              ii, jj, hrsrc, hcsrc )</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;               <span class="keywordflow">IF</span>( myrow.EQ.hrsrc .AND. mycol.EQ.hcsrc ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                  <span class="keywordflow">IF</span>( h( ii + (jj-1)*lldh ).EQ.zero )</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;     $               <span class="keywordflow">GO TO</span> 20</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; 10         <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            k = ilo</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; 20         <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            ktop = k</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            <span class="keywordflow">IF</span>( nprocs.GT.1 )</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;     $         <span class="keyword">CALL </span>igamx2d( ictxt, <span class="stringliteral">&#39;All&#39;</span>, <span class="stringliteral">&#39;1-Tree&#39;</span>, 1, 1, ktop, 1,</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;     $              -1, -1, -1, -1, -1 )</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">*           Select deflation window size.</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            nh = kbot - ktop + 1</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            <span class="keywordflow">IF</span>( nh.LE.ntiny ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;               nw = nh</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            <span class="keywordflow">ELSEIF</span>( ndfl.LT.kexnw .OR. nh.LT.nw ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">*              Typical deflation window.  If possible and</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">*              advisable, nibble the entire active block.</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">*              If not, use size NWR or NWR+1 depending upon</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">*              which has the smaller corresponding subdiagonal</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">*              entry (a heuristic).</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;               nwinc = .true.</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;               <span class="keywordflow">IF</span>( nh.LE.<a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( nmin, nwmax ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                  nw = nh</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;               <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                  nw = <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( nwr, nh, nwmax )</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                  <span class="keywordflow">IF</span>( nw.LT.nwmax ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                     <span class="keywordflow">IF</span>( nw.GE.nh-1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                        nw = nh</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                        kwtop = kbot - nw + 1</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="../../db/dfa/pdelget_8f.html#a8bcf89b372b70ee2d2d9035c00ea794c">pdelget</a>( <span class="stringliteral">&#39;All&#39;</span>, <span class="stringliteral">&#39;1-Tree&#39;</span>, elem1, h, kwtop,</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;     $                       kwtop-1, desch )</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="../../db/dfa/pdelget_8f.html#a8bcf89b372b70ee2d2d9035c00ea794c">pdelget</a>( <span class="stringliteral">&#39;All&#39;</span>, <span class="stringliteral">&#39;1-Tree&#39;</span>, elem2, h,</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;     $                       kwtop-1, kwtop-2, desch )</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                        <span class="keywordflow">IF</span>( abs( elem1 ).GT.abs( elem2 ) ) nw = nw + 1</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="keywordflow">                     END IF</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">*              Exceptional deflation window.  If there have</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">*              been no deflations in KEXNW or more iterations,</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">*              then vary the deflation window size.   At first,</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">*              because, larger windows are, in general, more</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">*              powerful than smaller ones, rapidly increase the</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">*              window up to the maximum reasonable and possible.</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">*              Then maybe try a slightly smaller window.</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;               <span class="keywordflow">IF</span>( nwinc .AND. nw.LT.<a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( nwmax, nh ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                  nw = <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( nwmax, nh, 2*nw )</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;               <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                  nwinc = .false.</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                  <span class="keywordflow">IF</span>( nw.EQ.nh .AND. nh.GT.2 )</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;     $               nw = nh - 1</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">*           Aggressive early deflation:</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">*           split workspace into</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">*             - an NW-by-NW work array V for orthogonal matrix</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">*             - an NW-by-at-least-NW-but-more-is-better</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">*               (NW-by-NHO) horizontal work array for Schur factor</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">*             - an at-least-NW-but-more-is-better (NVE-by-NW)</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">*               vertical work array for matrix multiplications</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">*             - align T, V and W with the deflation window</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            kv = n - nw + 1</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            kt = nw + 1</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            nho = ( n-nw-1 ) - kt + 1</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            kwv = nw + 2</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            nve = ( n-nw ) - kwv + 1</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            jw = <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( nw, kbot-ktop+1 )</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            kwtop = kbot - jw + 1</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            iroffh = mod( kwtop - 1, nb )</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            icoffh = iroffh</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            hrsrc = <a class="code" href="../../d6/d88/indxg2p_8f.html#a9ce1dd9878d80910658c5a110815e642">indxg2p</a>( kwtop, nb, myrow, desch(rsrc_), nprow )</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            hcsrc = <a class="code" href="../../d6/d88/indxg2p_8f.html#a9ce1dd9878d80910658c5a110815e642">indxg2p</a>( kwtop, nb, mycol, desch(csrc_), npcol )</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            vrows = <a class="code" href="../../d4/d48/numroc_8f.html#aeaf233ca9d355163e321443f8b4611af">numroc</a>( jw+iroffh, nb, myrow, hrsrc, nprow )</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            vcols = <a class="code" href="../../d4/d48/numroc_8f.html#aeaf233ca9d355163e321443f8b4611af">numroc</a>( jw+icoffh, nb, mycol, hcsrc, npcol )</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            <span class="keyword">CALL </span><a class="code" href="../../dd/d22/descinit_8f.html#a0e387a421d9eded2573efdf5b350d479">descinit</a>( descv, jw+iroffh, jw+icoffh, nb, nb,</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;     $           hrsrc, hcsrc, ictxt, <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>(1, vrows), info )</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            trows = <a class="code" href="../../d4/d48/numroc_8f.html#aeaf233ca9d355163e321443f8b4611af">numroc</a>( jw+iroffh, nb, myrow, hrsrc, nprow )</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            tcols = <a class="code" href="../../d4/d48/numroc_8f.html#aeaf233ca9d355163e321443f8b4611af">numroc</a>( jw+icoffh, nb, mycol, hcsrc, npcol )</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            <span class="keyword">CALL </span><a class="code" href="../../dd/d22/descinit_8f.html#a0e387a421d9eded2573efdf5b350d479">descinit</a>( desct, jw+iroffh, jw+icoffh, nb, nb,</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;     $           hrsrc, hcsrc, ictxt, <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>(1, trows), info )</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            wrows = <a class="code" href="../../d4/d48/numroc_8f.html#aeaf233ca9d355163e321443f8b4611af">numroc</a>( jw+iroffh, nb, myrow, hrsrc, nprow )</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            wcols = <a class="code" href="../../d4/d48/numroc_8f.html#aeaf233ca9d355163e321443f8b4611af">numroc</a>( jw+icoffh, nb, mycol, hcsrc, npcol )</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            <span class="keyword">CALL </span><a class="code" href="../../dd/d22/descinit_8f.html#a0e387a421d9eded2573efdf5b350d479">descinit</a>( descw, jw+iroffh, jw+icoffh, nb, nb,</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;     $           hrsrc, hcsrc, ictxt, <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>(1, wrows), info )</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            ipv   = 1</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            ipt   = ipv + descv( lld_ ) * vcols</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            ipw   = ipt + desct( lld_ ) * tcols</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            ipwrk = ipw + descw( lld_ ) * wcols</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">*           Aggressive early deflation</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            iwork(1) = it</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            <span class="keyword">CALL </span><a class="code" href="../../d9/d91/pdlaqr3_8f.html#ad5273e920e9ff33a76d6ab98a672b262">pdlaqr3</a>( wantt, wantz, n, ktop, kbot, nw, h,</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;     $           desch, iloz, ihiz, z, descz, ls, ld, wr, wi,</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;     $           work(ipv), descv, nho, work(ipt), desct, nve,</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;     $           work(ipw), descw, work(ipwrk), lwork-ipwrk+1,</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;     $           iwork, liwork, reclevel )</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">*           Adjust KBOT accounting for new deflations.</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            kbot = kbot - ld</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">*           KS points to the shifts.</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            ks = kbot - ls + 1</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">*           Skip an expensive QR sweep if there is a (partly</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">*           heuristic) reason to expect that many eigenvalues</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment">*           will deflate without it.  Here, the QR sweep is</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">*           skipped if many eigenvalues have just been deflated</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">*           or if the remaining active block is small.</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            <span class="keywordflow">IF</span>( ( ld.EQ.0 ) .OR. ( ( 100*ld.LE.nw*nibble ) .AND. ( kbot-</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;     $           ktop+1.GT.<a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( nmin, nwmax ) ) ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">*              NS = nominal number of simultaneous shifts.</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">*              This may be lowered (slightly) if PDLAQR3</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">*              did not provide that many shifts.</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;               ns = <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( nsmax, nsr, <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( 2, kbot-ktop ) )</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;               ns = ns - mod( ns, 2 )</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">*              If there have been no deflations</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">*              in a multiple of KEXSH iterations,</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">*              then try exceptional shifts.</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">*              Otherwise use shifts provided by</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">*              PDLAQR3 above or from the eigenvalues</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">*              of a trailing principal submatrix.</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;               <span class="keywordflow">IF</span>( mod( ndfl, kexsh ).EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                  ks = kbot - ns + 1</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                  <span class="keywordflow">DO</span> 30 i = kbot, <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( ks+1, ktop+2 ), -2</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                     <span class="keyword">CALL </span><a class="code" href="../../db/dfa/pdelget_8f.html#a8bcf89b372b70ee2d2d9035c00ea794c">pdelget</a>( <span class="stringliteral">&#39;All&#39;</span>, <span class="stringliteral">&#39;1-Tree&#39;</span>, elem1, h, i, i-1,</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;     $                    desch )</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                     <span class="keyword">CALL </span><a class="code" href="../../db/dfa/pdelget_8f.html#a8bcf89b372b70ee2d2d9035c00ea794c">pdelget</a>( <span class="stringliteral">&#39;All&#39;</span>, <span class="stringliteral">&#39;1-Tree&#39;</span>, elem2, h, i-1, i-2,</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;     $                    desch )</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                     <span class="keyword">CALL </span><a class="code" href="../../db/dfa/pdelget_8f.html#a8bcf89b372b70ee2d2d9035c00ea794c">pdelget</a>( <span class="stringliteral">&#39;All&#39;</span>, <span class="stringliteral">&#39;1-Tree&#39;</span>, elem3, h, i, i,</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;     $                    desch )</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                     ss = abs( elem1 ) + abs( elem2 )</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                     aa = wilk1*ss + elem3</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                     bb = ss</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                     cc = wilk2*ss</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                     dd = aa</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                     <span class="keyword">CALL </span>dlanv2( aa, bb, cc, dd, wr( i-1 ), wi( i-1 ),</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;     $                    wr( i ), wi( i ), cs, sn )</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; 30               <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                  <span class="keywordflow">IF</span>( ks.EQ.ktop ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                     <span class="keyword">CALL </span><a class="code" href="../../db/dfa/pdelget_8f.html#a8bcf89b372b70ee2d2d9035c00ea794c">pdelget</a>( <span class="stringliteral">&#39;All&#39;</span>, <span class="stringliteral">&#39;1-Tree&#39;</span>, elem1, h, ks+1,</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;     $                    ks+1, desch )</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                     wr( ks+1 ) = elem1</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                     wi( ks+1 ) = zero</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                     wr( ks ) = wr( ks+1 )</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                     wi( ks ) = wi( ks+1 )</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;               <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">*                 Got NS/2 or fewer shifts? Use PDLAQR0 or</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">*                 PDLAQR1 on a trailing principal submatrix to</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">*                 get more.</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                  <span class="keywordflow">IF</span>( kbot-ks+1.LE.ns / 2 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                     ks = kbot - ns + 1</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                     kt = n - ns + 1</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                     npmin = <a class="code" href="../../dc/d00/pilaenvx_8f.html#acd31afd7cd48a41160245dd25b19ac72">pilaenvx</a>( ictxt, 23, <span class="stringliteral">&#39;PDLAQR0&#39;</span>, <span class="stringliteral">&#39;EN&#39;</span>, ns,</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;     $                    nb, nprow, npcol )</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">c</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">c   Temporarily force NPMIN &lt;= 8 since only PDLAQR1 is used.</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">c</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                     npmin = <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>(npmin, 8)</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                     <span class="keywordflow">IF</span>( <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>(nprow, npcol).LE.npmin+1 .OR.</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;     $                    reclevel.GE.1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">*                       The window is large enough. Compute the Schur</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">*                       decomposition with all processors.</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                        iroffh = mod( ks - 1, nb )</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                        icoffh = iroffh</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                        <span class="keywordflow">IF</span>( ns.GT.nmin ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                           hrsrc = <a class="code" href="../../d6/d88/indxg2p_8f.html#a9ce1dd9878d80910658c5a110815e642">indxg2p</a>( ks, nb, myrow, desch(rsrc_),</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;     $                          nprow )</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                           hcsrc = <a class="code" href="../../d6/d88/indxg2p_8f.html#a9ce1dd9878d80910658c5a110815e642">indxg2p</a>( ks, nb, myrow, desch(csrc_),</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;     $                          npcol )</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                           hrsrc = 0</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                           hcsrc = 0</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="keywordflow">                        END IF</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                        trows = <a class="code" href="../../d4/d48/numroc_8f.html#aeaf233ca9d355163e321443f8b4611af">numroc</a>( ns+iroffh, nb, myrow, hrsrc,</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;     $                       nprow )</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                        tcols = <a class="code" href="../../d4/d48/numroc_8f.html#aeaf233ca9d355163e321443f8b4611af">numroc</a>( ns+icoffh, nb, mycol, hcsrc,</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;     $                       npcol )</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="../../dd/d22/descinit_8f.html#a0e387a421d9eded2573efdf5b350d479">descinit</a>( desct, ns+iroffh, ns+icoffh, nb,</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;     $                       nb, hrsrc, hcsrc, ictxt, <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>(1, trows),</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;     $                       info )</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                        ipt = 1</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                        ipwrk = ipt + desct(lld_) * tcols</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                        <span class="keywordflow">IF</span>( ns.GT.nmin .AND. recursion ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                           <span class="keyword">CALL </span><a class="code" href="../../da/dc2/pdlacpy_8f.html#aa636d5b0fc7e696760b0583b9ae2c59b">pdlacpy</a>( <span class="stringliteral">&#39;All&#39;</span>, ns, ns, h, ks, ks,</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;     $                          desch, work(ipt), 1+iroffh, 1+icoffh,</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;     $                          desct )</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                           <span class="keyword">CALL </span><a class="code" href="../../d6/dd3/pdlaqr0_8f.html#afdd0414fd613914f2935567408480ffb">pdlaqr0</a>( .false., .false., iroffh+ns,</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;     $                          1+iroffh, iroffh+ns, work(ipt),</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;     $                          desct, wr( ks-iroffh ),</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;     $                          wi( ks-iroffh ), 1, 1, zdum,</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;     $                          descz, work( ipwrk ),</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;     $                          lwork-ipwrk+1, iwork, liwork,</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;     $                          inf, reclevel+1 )</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                           <span class="keyword">CALL </span><a class="code" href="../../d5/d4b/pdlamve_8f.html#afdc2478cbfbb062d620156785ea2bfd5">pdlamve</a>( <span class="stringliteral">&#39;All&#39;</span>, ns, ns, h, ks, ks,</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;     $                          desch, work(ipt), 1+iroffh, 1+icoffh,</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;     $                          desct, work(ipwrk) )</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                           <span class="keyword">CALL </span><a class="code" href="../../da/dd8/pdlaqr1_8f.html#a47a41c4fbb749e0f0ab6a20e78b22f62">pdlaqr1</a>( .false., .false., iroffh+ns,</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;     $                          1+iroffh, iroffh+ns, work(ipt),</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;     $                          desct, wr( ks-iroffh ),</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;     $                          wi( ks-iroffh ), 1+iroffh, iroffh+ns,</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;     $                          zdum, descz, work( ipwrk ),</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;     $                          lwork-ipwrk+1, iwork, liwork, inf )</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="keywordflow">                        END IF</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">*                       The window is too small. Redistribute the AED</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">*                       window to a subgrid and do the computation on</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment">*                       the subgrid.</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                        ictxt_new = ictxt</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                        <span class="keywordflow">DO</span> 50 i = 0, npmin-1</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                           <span class="keywordflow">DO</span> 40 j = 0, npmin-1</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                              pmap( j+1+i*npmin ) =</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;     $                             blacs_pnum( ictxt, i, j )</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; 40                        <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; 50                     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                        <span class="keyword">CALL </span>blacs_gridmap( ictxt_new, pmap, npmin,</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;     $                       npmin, npmin )</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                        <span class="keyword">CALL </span>blacs_gridinfo( ictxt_new, npmin, npmin,</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;     $                       myrow_new, mycol_new )</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                        <span class="keywordflow">IF</span>( myrow.GE.npmin .OR. mycol.GE.npmin )</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;     $                     ictxt_new = -1</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                        <span class="keywordflow">IF</span>( ictxt_new.GE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                           trows = <a class="code" href="../../d4/d48/numroc_8f.html#aeaf233ca9d355163e321443f8b4611af">numroc</a>( ns, nb, myrow_new, 0, npmin )</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                           tcols = <a class="code" href="../../d4/d48/numroc_8f.html#aeaf233ca9d355163e321443f8b4611af">numroc</a>( ns, nb, mycol_new, 0, npmin )</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                           <span class="keyword">CALL </span><a class="code" href="../../dd/d22/descinit_8f.html#a0e387a421d9eded2573efdf5b350d479">descinit</a>( desct, ns, ns, nb, nb, 0, 0,</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;     $                          ictxt_new, <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>(1,trows), info )</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                           ipt = 1</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                           ipwrk = ipt + desct(lld_) * tcols</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                           ipt = 1</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                           ipwrk = 2</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                           desct( ctxt_ ) = -1</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                           inf = 0</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="keywordflow">                        END IF</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                        <span class="keyword">CALL </span>pdgemr2d( ns, ns, h, ks, ks, desch,</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;     $                       work(ipt), 1, 1, desct, ictxt )</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment">c</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment">c   This part is still not perfect.</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment">c   Either PDLAQR0 or PDLAQR1 can work, but not both.</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">c</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">c                        NMIN = PILAENVX( ICTXT_NEW, 12, &#39;PDLAQR0&#39;,</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">c     $                       &#39;EN&#39;, NS, 1, NS, LWORK )</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                        <span class="keywordflow">IF</span>( ictxt_new.GE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment">c                           IF( NS.GT.NMIN .AND. RECLEVEL.LT.1 ) THEN</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment">c                              CALL PDLAQR0( .FALSE., .FALSE., NS, 1,</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment">c     $                             NS, WORK(IPT), DESCT, WR( KS ),</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment">c     $                             WI( KS ), 1, 1, ZDUM, DESCT,</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment">c     $                             WORK( IPWRK ), LWORK-IPWRK+1, IWORK,</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment">c     $                             LIWORK, INF, RECLEVEL+1 )</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment">c                           ELSE</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                              <span class="keyword">CALL </span><a class="code" href="../../da/dd8/pdlaqr1_8f.html#a47a41c4fbb749e0f0ab6a20e78b22f62">pdlaqr1</a>( .false., .false., ns, 1,</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;     $                             ns, work(ipt), desct, wr( ks ),</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;     $                             wi( ks ), 1, ns, zdum, desct,</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;     $                             work( ipwrk ), lwork-ipwrk+1, iwork,</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;     $                             liwork, inf )</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment">c                           END IF</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                           <span class="keyword">CALL </span>blacs_gridexit( ictxt_new )</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="keywordflow">                        END IF</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                        <span class="keywordflow">IF</span>( myrow+mycol.GT.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                           <span class="keywordflow">DO</span> 60 j = 0, ns-1</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                              wr( ks+j ) = zero</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                              wi( ks+j ) = zero</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; 60                        <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="keywordflow">                        END IF</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                        <span class="keyword">CALL </span>igamn2d( ictxt, <span class="stringliteral">&#39;All&#39;</span>, <span class="stringliteral">&#39;1-Tree&#39;</span>, 1, 1, inf,</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;     $                       1, -1, -1, -1, -1, -1 )</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                        <span class="keyword">CALL </span>dgsum2d( ictxt, <span class="stringliteral">&#39;All&#39;</span>, <span class="stringliteral">&#39; &#39;</span>, ns, 1, wr(ks),</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;     $                       ns, -1, -1 )</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                        <span class="keyword">CALL </span>dgsum2d( ictxt, <span class="stringliteral">&#39;All&#39;</span>, <span class="stringliteral">&#39; &#39;</span>, ns, 1, wi(ks),</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;     $                       ns, -1, -1 )</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="keywordflow">                     END IF</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                     ks = ks + inf</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment">*                    In case of a rare QR failure use</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment">*                    eigenvalues of the trailing 2-by-2</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment">*                    principal submatrix.</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                     <span class="keywordflow">IF</span>( ks.GE.kbot ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="../../db/dfa/pdelget_8f.html#a8bcf89b372b70ee2d2d9035c00ea794c">pdelget</a>( <span class="stringliteral">&#39;All&#39;</span>, <span class="stringliteral">&#39;1-Tree&#39;</span>, aa, h, kbot-1,</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;     $                       kbot-1, desch )</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="../../db/dfa/pdelget_8f.html#a8bcf89b372b70ee2d2d9035c00ea794c">pdelget</a>( <span class="stringliteral">&#39;All&#39;</span>, <span class="stringliteral">&#39;1-Tree&#39;</span>, cc, h, kbot,</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;     $                       kbot-1, desch )</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="../../db/dfa/pdelget_8f.html#a8bcf89b372b70ee2d2d9035c00ea794c">pdelget</a>( <span class="stringliteral">&#39;All&#39;</span>, <span class="stringliteral">&#39;1-Tree&#39;</span>, bb, h, kbot-1,</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;     $                       kbot, desch )</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="../../db/dfa/pdelget_8f.html#a8bcf89b372b70ee2d2d9035c00ea794c">pdelget</a>( <span class="stringliteral">&#39;All&#39;</span>, <span class="stringliteral">&#39;1-Tree&#39;</span>, dd, h, kbot,</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;     $                       kbot, desch )</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                        <span class="keyword">CALL </span>dlanv2( aa, bb, cc, dd, wr( kbot-1 ),</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;     $                       wi( kbot-1 ), wr( kbot ),</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;     $                       wi( kbot ), cs, sn )</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                        ks = kbot - 1</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="keywordflow">                     END IF</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                  <span class="keywordflow">IF</span>( kbot-ks+1.GT.ns ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">*                    Sort the shifts (helps a little)</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment">*                    Bubble sort keeps complex conjugate</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">*                    pairs together.</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                     sorted = .false.</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                     <span class="keywordflow">DO</span> 80 k = kbot, ks + 1, -1</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                        <span class="keywordflow">IF</span>( sorted )</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;     $                     <span class="keywordflow">GO TO</span> 90</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                        sorted = .true.</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                        <span class="keywordflow">DO</span> 70 i = ks, k - 1</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                           <span class="keywordflow">IF</span>( abs( wr( i ) )+abs( wi( i ) ).LT.</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;     $                          abs( wr( i+1 ) )+abs( wi( i+1 ) ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                              sorted = .false.</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                              swap = wr( i )</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                              wr( i ) = wr( i+1 )</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                              wr( i+1 ) = swap</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                              swap = wi( i )</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                              wi( i ) = wi( i+1 )</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                              wi( i+1 ) = swap</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="keywordflow">                           END IF</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160; 70                     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160; 80                  <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160; 90                  <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment">*                 Shuffle shifts into pairs of real shifts</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="comment">*                 and pairs of complex conjugate shifts</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment">*                 assuming complex conjugate shifts are</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment">*                 already adjacent to one another. (Yes,</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment">*                 they are.)</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                  <span class="keywordflow">DO</span> 100 i = kbot, ks + 2, -2</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                     <span class="keywordflow">IF</span>( wi( i ).NE.-wi( i-1 ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                        swap = wr( i )</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                        wr( i ) = wr( i-1 )</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                        wr( i-1 ) = wr( i-2 )</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                        wr( i-2 ) = swap</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                        swap = wi( i )</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                        wi( i ) = wi( i-1 )</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                        wi( i-1 ) = wi( i-2 )</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                        wi( i-2 ) = swap</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="keywordflow">                     END IF</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160; 100              <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment">*              If there are only two shifts and both are</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment">*              real, then use only one.</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;               <span class="keywordflow">IF</span>( kbot-ks+1.EQ.2 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                  <span class="keywordflow">IF</span>( wi( kbot ).EQ.zero ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                     <span class="keyword">CALL </span><a class="code" href="../../db/dfa/pdelget_8f.html#a8bcf89b372b70ee2d2d9035c00ea794c">pdelget</a>( <span class="stringliteral">&#39;All&#39;</span>, <span class="stringliteral">&#39;1-Tree&#39;</span>, elem, h, kbot,</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;     $                    kbot, desch )</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                     <span class="keywordflow">IF</span>( abs( wr( kbot )-elem ).LT.</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;     $                    abs( wr( kbot-1 )-elem ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                        wr( kbot-1 ) = wr( kbot )</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                        wr( kbot ) = wr( kbot-1 )</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="keywordflow">                     END IF</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment">*              Use up to NS of the the smallest magnatiude</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">*              shifts.  If there aren&#39;t NS shifts available,</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">*              then use them all, possibly dropping one to</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">*              make the number of shifts even.</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;               ns = <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( ns, kbot-ks+1 )</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;               ns = ns - mod( ns, 2 )</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;               ks = kbot - ns + 1</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment">*              Small-bulge multi-shift QR sweep.</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;               totns = totns + ns</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;               sweep = sweep + 1</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;               <span class="keyword">CALL </span><a class="code" href="../../d6/d6b/pdlaqr5_8f.html#a3ebbe3bfa5f285b4112b2180c9d3889a">pdlaqr5</a>( wantt, wantz, kacc22, n, ktop, kbot,</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;     $              ns, wr( ks ), wi( ks ), h, desch, iloz, ihiz, z,</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;     $              descz, work, lwork, iwork, liwork )</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="comment">*           Note progress (or the lack of it).</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            <span class="keywordflow">IF</span>( ld.GT.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;               ndfl = 1</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;               ndfl = ndfl + 1</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="comment">*           End of main loop.</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160; 110     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="comment">*        Iteration limit exceeded.  Set INFO to show where</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment">*        the problem occurred and exit.</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;         info = kbot</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160; 120     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">*     Return the optimal value of LWORK.</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      work( 1 ) = dble( lwkopt )</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      iwork( 1 ) = liwkopt</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      <span class="keywordflow">IF</span>( .NOT. lquery ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;         iwork( 1 ) = totit</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;         iwork( 2 ) = sweep</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;         iwork( 3 ) = totns</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment">*     End of PDLAQR0</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      <span class="keyword">END</span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aindxg2p_8f_html_a9ce1dd9878d80910658c5a110815e642"><div class="ttname"><a href="../../d6/d88/indxg2p_8f.html#a9ce1dd9878d80910658c5a110815e642">indxg2p</a></div><div class="ttdeci">integer function indxg2p(INDXGLOB, NB, IPROC, ISRCPROC, NPROCS)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d88/indxg2p_8f_source.html#l00002">indxg2p.f:2</a></div></div>
<div class="ttc" id="apcgemr_8c_html_a24e753bacac6be5f30e18f8a2bdefda4"><div class="ttname"><a href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a></div><div class="ttdeci">#define max(A, B)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dad/pcgemr_8c_source.html#l00180">pcgemr.c:180</a></div></div>
<div class="ttc" id="ainfog2l_8f_html_a6e7ce55b8c4d7899bea557e986142537"><div class="ttname"><a href="../../d9/de1/infog2l_8f.html#a6e7ce55b8c4d7899bea557e986142537">infog2l</a></div><div class="ttdeci">subroutine infog2l(GRINDX, GCINDX, DESC, NPROW, NPCOL, MYROW, MYCOL, LRINDX, LCINDX, RSRC, CSRC)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de1/infog2l_8f_source.html#l00003">infog2l.f:3</a></div></div>
<div class="ttc" id="apilaenvx_8f_html_acd31afd7cd48a41160245dd25b19ac72"><div class="ttname"><a href="../../dc/d00/pilaenvx_8f.html#acd31afd7cd48a41160245dd25b19ac72">pilaenvx</a></div><div class="ttdeci">integer function pilaenvx(ICTXT, ISPEC, NAME, OPTS, N1, N2, N3, N4)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/pilaenvx_8f_source.html#l00003">pilaenvx.f:3</a></div></div>
<div class="ttc" id="apdelget_8f_html_a8bcf89b372b70ee2d2d9035c00ea794c"><div class="ttname"><a href="../../db/dfa/pdelget_8f.html#a8bcf89b372b70ee2d2d9035c00ea794c">pdelget</a></div><div class="ttdeci">subroutine pdelget(SCOPE, TOP, ALPHA, A, IA, JA, DESCA)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfa/pdelget_8f_source.html#l00002">pdelget.f:2</a></div></div>
<div class="ttc" id="apdlaqr1_8f_html_a47a41c4fbb749e0f0ab6a20e78b22f62"><div class="ttname"><a href="../../da/dd8/pdlaqr1_8f.html#a47a41c4fbb749e0f0ab6a20e78b22f62">pdlaqr1</a></div><div class="ttdeci">recursive subroutine pdlaqr1(WANTT, WANTZ, N, ILO, IHI, A, DESCA, WR, WI, ILOZ, IHIZ, Z, DESCZ, WORK, LWORK, IWORK, ILWORK, INFO)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dd8/pdlaqr1_8f_source.html#l00005">pdlaqr1.f:5</a></div></div>
<div class="ttc" id="adescinit_8f_html_a0e387a421d9eded2573efdf5b350d479"><div class="ttname"><a href="../../dd/d22/descinit_8f.html#a0e387a421d9eded2573efdf5b350d479">descinit</a></div><div class="ttdeci">subroutine descinit(DESC, M, N, MB, NB, IRSRC, ICSRC, ICTXT, LLD, INFO)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d22/descinit_8f_source.html#l00003">descinit.f:3</a></div></div>
<div class="ttc" id="apdlaqr3_8f_html_ad5273e920e9ff33a76d6ab98a672b262"><div class="ttname"><a href="../../d9/d91/pdlaqr3_8f.html#ad5273e920e9ff33a76d6ab98a672b262">pdlaqr3</a></div><div class="ttdeci">recursive subroutine pdlaqr3(WANTT, WANTZ, N, KTOP, KBOT, NW, H, DESCH, ILOZ, IHIZ, Z, DESCZ, NS, ND, SR, SI, V, DESCV, NH, T, DESCT, NV, WV, DESCW, WORK, LWORK, IWORK, LIWORK, RECLEVEL)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d91/pdlaqr3_8f_source.html#l00006">pdlaqr3.f:6</a></div></div>
<div class="ttc" id="apdlaqr0_8f_html_afdd0414fd613914f2935567408480ffb"><div class="ttname"><a href="../../d6/dd3/pdlaqr0_8f.html#afdd0414fd613914f2935567408480ffb">pdlaqr0</a></div><div class="ttdeci">recursive subroutine pdlaqr0(WANTT, WANTZ, N, ILO, IHI, H, DESCH, WR, WI, ILOZ, IHIZ, Z, DESCZ, WORK, LWORK, IWORK, LIWORK, INFO, RECLEVEL)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd3/pdlaqr0_8f_source.html#l00004">pdlaqr0.f:4</a></div></div>
<div class="ttc" id="anumroc_8f_html_aeaf233ca9d355163e321443f8b4611af"><div class="ttname"><a href="../../d4/d48/numroc_8f.html#aeaf233ca9d355163e321443f8b4611af">numroc</a></div><div class="ttdeci">integer function numroc(N, NB, IPROC, ISRCPROC, NPROCS)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d48/numroc_8f_source.html#l00002">numroc.f:2</a></div></div>
<div class="ttc" id="apdlamve_8f_html_afdc2478cbfbb062d620156785ea2bfd5"><div class="ttname"><a href="../../d5/d4b/pdlamve_8f.html#afdc2478cbfbb062d620156785ea2bfd5">pdlamve</a></div><div class="ttdeci">subroutine pdlamve(UPLO, M, N, A, IA, JA, DESCA, B, IB, JB, DESCB, DWORK)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d4b/pdlamve_8f_source.html#l00003">pdlamve.f:3</a></div></div>
<div class="ttc" id="apdlacpy_8f_html_aa636d5b0fc7e696760b0583b9ae2c59b"><div class="ttname"><a href="../../da/dc2/pdlacpy_8f.html#aa636d5b0fc7e696760b0583b9ae2c59b">pdlacpy</a></div><div class="ttdeci">subroutine pdlacpy(UPLO, M, N, A, IA, JA, DESCA, B, IB, JB, DESCB)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dc2/pdlacpy_8f_source.html#l00003">pdlacpy.f:3</a></div></div>
<div class="ttc" id="apdlaqr5_8f_html_a3ebbe3bfa5f285b4112b2180c9d3889a"><div class="ttname"><a href="../../d6/d6b/pdlaqr5_8f.html#a3ebbe3bfa5f285b4112b2180c9d3889a">pdlaqr5</a></div><div class="ttdeci">subroutine pdlaqr5(WANTT, WANTZ, KACC22, N, KTOP, KBOT, NSHFTS, SR, SI, H, DESCH, ILOZ, IHIZ, Z, DESCZ, WORK, LWORK, IWORK, LIWORK)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6b/pdlaqr5_8f_source.html#l00004">pdlaqr5.f:4</a></div></div>
<div class="ttc" id="apcgemr_8c_html_a2d017cd3beb218080a7988e2deed2a11"><div class="ttname"><a href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a></div><div class="ttdeci">#define min(A, B)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dad/pcgemr_8c_source.html#l00181">pcgemr.c:181</a></div></div>
<div class="ttc" id="aiceil_8f_html_aef3085a2d6d5e24b028a01a1aa8132e3"><div class="ttname"><a href="../../df/d07/iceil_8f.html#aef3085a2d6d5e24b028a01a1aa8132e3">iceil</a></div><div class="ttdeci">integer function iceil(INUM, IDENOM)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d07/iceil_8f_source.html#l00002">iceil.f:2</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_1e771ff450ae847412a8c28572c155bb.html">SRC</a></li><li class="navelem"><a class="el" href="../../d6/dd3/pdlaqr0_8f.html">pdlaqr0.f</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
  </ul>
</div>
</body>
</html>
