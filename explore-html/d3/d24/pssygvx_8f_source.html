<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ScaLAPACK 2.1: SRC/pssygvx.f Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../ScaLAPACK logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ScaLAPACK 2.1
   &#160;<span id="projectnumber">2.1</span>
   </div>
   <div id="projectbrief">ScaLAPACK: Scalable Linear Algebra PACKage</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d3/d24/pssygvx_8f_source.html','../../');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">pssygvx.f</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d3/d24/pssygvx_8f.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;      <span class="keyword">SUBROUTINE </span><a class="code" href="../../d3/d24/pssygvx_8f.html#a28f097fa6725bb411a63cb0196b35a6a">pssygvx</a>( IBTYPE, JOBZ, RANGE, UPLO, N, A, IA, JA,</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;     $                    DESCA, B, IB, JB, DESCB, VL, VU, IL, IU,</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;     $                    ABSTOL, M, NZ, W, ORFAC, Z, IZ, JZ, DESCZ,</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;     $                    WORK, LWORK, IWORK, LIWORK, IFAIL, ICLUSTR,</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;     $                    GAP, INFO )</div>
<div class="line"><a name="l00006"></a><span class="lineno"><a class="line" href="../../d3/d24/pssygvx_8f.html#a28f097fa6725bb411a63cb0196b35a6a">    6</a></span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">*  -- ScaLAPACK routine (version 1.7) --</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">*     University of Tennessee, Knoxville, Oak Ridge National Laboratory,</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">*     and University of California, Berkeley.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">*     October 15, 1999</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">*     .. Scalar Arguments ..</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;      <span class="keywordtype">CHARACTER</span>          JOBZ, RANGE, UPLO</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;      <span class="keywordtype">INTEGER</span>            IA, IB, IBTYPE, IL, INFO, IU, IZ, JA, JB, JZ,</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;     $                   LIWORK, LWORK, M, N, NZ</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;      <span class="keywordtype">REAL</span>               ABSTOL, ORFAC, VL, VU</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">*     .. Array Arguments ..</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;      <span class="keywordtype">INTEGER</span>            DESCA( * ), DESCB( * ), DESCZ( * ),</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;     $                   ICLUSTR( * ), IFAIL( * ), IWORK( * )</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;      <span class="keywordtype">REAL</span>               A( * ), B( * ), GAP( * ), W( * ), WORK( * ),</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;     $                   Z( * )</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">*  Purpose</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">*  =======</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">*  PSSYGVX computes all the eigenvalues, and optionally,</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">*  the eigenvectors</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">*  of a real generalized SY-definite eigenproblem, of the form</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">*  sub( A )*x=(lambda)*sub( B )*x,  sub( A )*sub( B )x=(lambda)*x,  or</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">*  sub( B )*sub( A )*x=(lambda)*x.</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">*  Here sub( A ) denoting A( IA:IA+N-1, JA:JA+N-1 ) is assumed to be</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">*  SY, and sub( B ) denoting B( IB:IB+N-1, JB:JB+N-1 ) is assumed</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">*  to be symmetric positive definite.</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">*  Notes</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">*  =====</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">*  Each global data object is described by an associated description</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">*  vector.  This vector stores the information required to establish</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">*  the mapping between an object element and its corresponding process</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">*  and memory location.</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">*  Let A be a generic term for any 2D block cyclicly distributed array.</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">*  Such a global array has an associated description vector DESCA.</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">*  In the following comments, the character _ should be read as</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">*  &quot;of the global array&quot;.</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">*  NOTATION        STORED IN      EXPLANATION</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">*  --------------- -------------- --------------------------------------</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">*  DTYPE_A(global) DESCA( DTYPE_ )The descriptor type.  In this case,</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">*                                 DTYPE_A = 1.</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">*  CTXT_A (global) DESCA( CTXT_ ) The BLACS context handle, indicating</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">*                                 the BLACS process grid A is distribu-</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">*                                 ted over. The context itself is glo-</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">*                                 bal, but the handle (the integer</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">*                                 value) may vary.</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">*  M_A    (global) DESCA( M_ )    The number of rows in the global</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">*                                 array A.</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">*  N_A    (global) DESCA( N_ )    The number of columns in the global</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">*                                 array A.</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">*  MB_A   (global) DESCA( MB_ )   The blocking factor used to distribute</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">*                                 the rows of the array.</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">*  NB_A   (global) DESCA( NB_ )   The blocking factor used to distribute</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">*                                 the columns of the array.</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">*  RSRC_A (global) DESCA( RSRC_ ) The process row over which the first</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">*                                 row of the array A is distributed.</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">*  CSRC_A (global) DESCA( CSRC_ ) The process column over which the</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">*                                 first column of the array A is</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">*                                 distributed.</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">*  LLD_A  (local)  DESCA( LLD_ )  The leading dimension of the local</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">*                                 array.  LLD_A &gt;= MAX(1,LOCr(M_A)).</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">*  Let K be the number of rows or columns of a distributed matrix,</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">*  and assume that its process grid has dimension p x q.</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">*  LOCr( K ) denotes the number of elements of K that a process</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">*  would receive if K were distributed over the p processes of its</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">*  process column.</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">*  Similarly, LOCc( K ) denotes the number of elements of K that a</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">*  process would receive if K were distributed over the q processes of</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">*  its process row.</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">*  The values of LOCr() and LOCc() may be determined via a call to the</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">*  ScaLAPACK tool function, NUMROC:</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">*          LOCr( M ) = NUMROC( M, MB_A, MYROW, RSRC_A, NPROW ),</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">*          LOCc( N ) = NUMROC( N, NB_A, MYCOL, CSRC_A, NPCOL ).</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">*  An upper bound for these quantities may be computed by:</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">*          LOCr( M ) &lt;= ceil( ceil(M/MB_A)/NPROW )*MB_A</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">*          LOCc( N ) &lt;= ceil( ceil(N/NB_A)/NPCOL )*NB_A</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">*  Arguments</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">*  =========</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">*  IBTYPE   (global input) INTEGER</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">*          Specifies the problem type to be solved:</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">*          = 1:  sub( A )*x = (lambda)*sub( B )*x</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">*          = 2:  sub( A )*sub( B )*x = (lambda)*x</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">*          = 3:  sub( B )*sub( A )*x = (lambda)*x</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">*  JOBZ    (global input) CHARACTER*1</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">*          = &#39;N&#39;:  Compute eigenvalues only;</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">*          = &#39;V&#39;:  Compute eigenvalues and eigenvectors.</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">*  RANGE   (global input) CHARACTER*1</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">*          = &#39;A&#39;: all eigenvalues will be found.</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">*          = &#39;V&#39;: all eigenvalues in the interval [VL,VU] will be found.</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">*          = &#39;I&#39;: the IL-th through IU-th eigenvalues will be found.</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">*  UPLO    (global input) CHARACTER*1</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">*          = &#39;U&#39;:  Upper triangles of sub( A ) and sub( B ) are stored;</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">*          = &#39;L&#39;:  Lower triangles of sub( A ) and sub( B ) are stored.</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">*  N       (global input) INTEGER</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">*          The order of the matrices sub( A ) and sub( B ).  N &gt;= 0.</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">*  A       (local input/local output) REAL pointer into the</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">*          local memory to an array of dimension (LLD_A, LOCc(JA+N-1)).</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">*          On entry, this array contains the local pieces of the</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">*          N-by-N symmetric distributed matrix sub( A ). If UPLO = &#39;U&#39;,</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">*          the leading N-by-N upper triangular part of sub( A ) contains</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">*          the upper triangular part of the matrix.  If UPLO = &#39;L&#39;, the</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">*          leading N-by-N lower triangular part of sub( A ) contains</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">*          the lower triangular part of the matrix.</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">*          On exit, if JOBZ = &#39;V&#39;, then if INFO = 0, sub( A ) contains</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">*          the distributed matrix Z of eigenvectors.  The eigenvectors</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">*          are normalized as follows:</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">*          if IBTYPE = 1 or 2, Z**T*sub( B )*Z = I;</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">*          if IBTYPE = 3, Z**T*inv( sub( B ) )*Z = I.</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">*          If JOBZ = &#39;N&#39;, then on exit the upper triangle (if UPLO=&#39;U&#39;)</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">*          or the lower triangle (if UPLO=&#39;L&#39;) of sub( A ), including</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">*          the diagonal, is destroyed.</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">*  IA      (global input) INTEGER</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">*          The row index in the global array A indicating the first</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">*          row of sub( A ).</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">*  JA      (global input) INTEGER</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">*          The column index in the global array A indicating the</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">*          first column of sub( A ).</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">*  DESCA   (global and local input) INTEGER array of dimension DLEN_.</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">*          The array descriptor for the distributed matrix A.</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">*          If DESCA( CTXT_ ) is incorrect, PSSYGVX cannot guarantee</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">*          correct error reporting.</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">*  B       (local input/local output) REAL pointer into the</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">*          local memory to an array of dimension (LLD_B, LOCc(JB+N-1)).</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">*          On entry, this array contains the local pieces of the</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">*          N-by-N symmetric distributed matrix sub( B ). If UPLO = &#39;U&#39;,</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">*          the leading N-by-N upper triangular part of sub( B ) contains</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">*          the upper triangular part of the matrix.  If UPLO = &#39;L&#39;, the</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">*          leading N-by-N lower triangular part of sub( B ) contains</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">*          the lower triangular part of the matrix.</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">*          On exit, if INFO &lt;= N, the part of sub( B ) containing the</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">*          matrix is overwritten by the triangular factor U or L from</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">*          the Cholesky factorization sub( B ) = U**T*U or</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">*          sub( B ) = L*L**T.</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">*  IB      (global input) INTEGER</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">*          The row index in the global array B indicating the first</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">*          row of sub( B ).</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">*  JB      (global input) INTEGER</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">*          The column index in the global array B indicating the</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">*          first column of sub( B ).</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">*  DESCB   (global and local input) INTEGER array of dimension DLEN_.</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">*          The array descriptor for the distributed matrix B.</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">*          DESCB( CTXT_ ) must equal DESCA( CTXT_ )</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">*  VL      (global input) REAL</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">*          If RANGE=&#39;V&#39;, the lower bound of the interval to be searched</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">*          for eigenvalues.  Not referenced if RANGE = &#39;A&#39; or &#39;I&#39;.</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">*  VU      (global input) REAL</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">*          If RANGE=&#39;V&#39;, the upper bound of the interval to be searched</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">*          for eigenvalues.  Not referenced if RANGE = &#39;A&#39; or &#39;I&#39;.</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">*  IL      (global input) INTEGER</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">*          If RANGE=&#39;I&#39;, the index (from smallest to largest) of the</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">*          smallest eigenvalue to be returned.  IL &gt;= 1.</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">*          Not referenced if RANGE = &#39;A&#39; or &#39;V&#39;.</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">*  IU      (global input) INTEGER</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">*          If RANGE=&#39;I&#39;, the index (from smallest to largest) of the</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">*          largest eigenvalue to be returned.  min(IL,N) &lt;= IU &lt;= N.</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">*          Not referenced if RANGE = &#39;A&#39; or &#39;V&#39;.</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">*  ABSTOL  (global input) REAL</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">*          If JOBZ=&#39;V&#39;, setting ABSTOL to PSLAMCH( CONTEXT, &#39;U&#39;) yields</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">*          the most orthogonal eigenvectors.</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">*          The absolute error tolerance for the eigenvalues.</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">*          An approximate eigenvalue is accepted as converged</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">*          when it is determined to lie in an interval [a,b]</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">*          of width less than or equal to</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">*                  ABSTOL + EPS *   max( |a|,|b| ) ,</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">*          where EPS is the machine precision.  If ABSTOL is less than</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">*          or equal to zero, then EPS*norm(T) will be used in its place,</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">*          where norm(T) is the 1-norm of the tridiagonal matrix</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">*          obtained by reducing A to tridiagonal form.</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">*          Eigenvalues will be computed most accurately when ABSTOL is</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">*          set to twice the underflow threshold 2*PSLAMCH(&#39;S&#39;) not zero.</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">*          If this routine returns with ((MOD(INFO,2).NE.0) .OR.</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">*          (MOD(INFO/8,2).NE.0)), indicating that some eigenvalues or</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">*          eigenvectors did not converge, try setting ABSTOL to</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">*          2*PSLAMCH(&#39;S&#39;).</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">*          See &quot;Computing Small Singular Values of Bidiagonal Matrices</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">*          with Guaranteed High Relative Accuracy,&quot; by Demmel and</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">*          Kahan, LAPACK Working Note #3.</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">*          See &quot;On the correctness of Parallel Bisection in Floating</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">*          Point&quot; by Demmel, Dhillon and Ren, LAPACK Working Note #70</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">*  M       (global output) INTEGER</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">*          Total number of eigenvalues found.  0 &lt;= M &lt;= N.</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">*  NZ      (global output) INTEGER</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">*          Total number of eigenvectors computed.  0 &lt;= NZ &lt;= M.</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">*          The number of columns of Z that are filled.</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">*          If JOBZ .NE. &#39;V&#39;, NZ is not referenced.</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">*          If JOBZ .EQ. &#39;V&#39;, NZ = M unless the user supplies</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">*          insufficient space and PSSYGVX is not able to detect this</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">*          before beginning computation.  To get all the eigenvectors</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">*          requested, the user must supply both sufficient</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">*          space to hold the eigenvectors in Z (M .LE. DESCZ(N_))</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">*          and sufficient workspace to compute them.  (See LWORK below.)</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">*          PSSYGVX is always able to detect insufficient space without</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">*          computation unless RANGE .EQ. &#39;V&#39;.</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">*  W       (global output) REAL array, dimension (N)</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">*          On normal exit, the first M entries contain the selected</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">*          eigenvalues in ascending order.</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">*  ORFAC   (global input) REAL</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">*          Specifies which eigenvectors should be reorthogonalized.</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">*          Eigenvectors that correspond to eigenvalues which are within</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">*          tol=ORFAC*norm(A) of each other are to be reorthogonalized.</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">*          However, if the workspace is insufficient (see LWORK),</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">*          tol may be decreased until all eigenvectors to be</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">*          reorthogonalized can be stored in one process.</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">*          No reorthogonalization will be done if ORFAC equals zero.</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">*          A default value of 10^-3 is used if ORFAC is negative.</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">*          ORFAC should be identical on all processes.</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">*  Z       (local output) REAL array,</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">*          global dimension (N, N),</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">*          local dimension ( LLD_Z, LOCc(JZ+N-1) )</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">*          If JOBZ = &#39;V&#39;, then on normal exit the first M columns of Z</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">*          contain the orthonormal eigenvectors of the matrix</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">*          corresponding to the selected eigenvalues.  If an eigenvector</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">*          fails to converge, then that column of Z contains the latest</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">*          approximation to the eigenvector, and the index of the</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">*          eigenvector is returned in IFAIL.</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">*          If JOBZ = &#39;N&#39;, then Z is not referenced.</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">*  IZ      (global input) INTEGER</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">*          The row index in the global array Z indicating the first</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">*          row of sub( Z ).</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">*  JZ      (global input) INTEGER</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">*          The column index in the global array Z indicating the</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">*          first column of sub( Z ).</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">*  DESCZ   (global and local input) INTEGER array of dimension DLEN_.</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">*          The array descriptor for the distributed matrix Z.</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">*          DESCZ( CTXT_ ) must equal DESCA( CTXT_ )</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">*  WORK    (local workspace/output) REAL array,</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">*             dimension max(3,LWORK)</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">*          if JOBZ=&#39;N&#39; WORK(1) = optimal amount of workspace</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">*             required to compute eigenvalues efficiently</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">*          if JOBZ=&#39;V&#39; WORK(1) = optimal amount of workspace</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">*             required to compute eigenvalues and eigenvectors</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">*             efficiently with no guarantee on orthogonality.</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">*             If RANGE=&#39;V&#39;, it is assumed that all eigenvectors</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">*             may be required.</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">*  LWORK   (local input) INTEGER</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">*          See below for definitions of variables used to define LWORK.</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">*          If no eigenvectors are requested (JOBZ = &#39;N&#39;) then</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">*             LWORK &gt;= 5 * N + MAX( 5 * NN, NB * ( NP0 + 1 ) )</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">*          If eigenvectors are requested (JOBZ = &#39;V&#39; ) then</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">*             the amount of workspace required to guarantee that all</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">*             eigenvectors are computed is:</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">*             LWORK &gt;= 5 * N + MAX( 5*NN, NP0 * MQ0 + 2 * NB * NB ) +</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">*               ICEIL( NEIG, NPROW*NPCOL)*NN</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">*             The computed eigenvectors may not be orthogonal if the</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">*             minimal workspace is supplied and ORFAC is too small.</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">*             If you want to guarantee orthogonality (at the cost</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">*             of potentially poor performance) you should add</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">*             the following to LWORK:</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">*                (CLUSTERSIZE-1)*N</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">*             where CLUSTERSIZE is the number of eigenvalues in the</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">*             largest cluster, where a cluster is defined as a set of</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">*             close eigenvalues: { W(K),...,W(K+CLUSTERSIZE-1) |</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">*                                  W(J+1) &lt;= W(J) + ORFAC*2*norm(A) }</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">*          Variable definitions:</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">*             NEIG = number of eigenvectors requested</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">*             NB = DESCA( MB_ ) = DESCA( NB_ ) = DESCZ( MB_ ) =</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">*                  DESCZ( NB_ )</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">*             NN = MAX( N, NB, 2 )</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">*             DESCA( RSRC_ ) = DESCA( NB_ ) = DESCZ( RSRC_ ) =</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">*                              DESCZ( CSRC_ ) = 0</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">*             NP0 = NUMROC( NN, NB, 0, 0, NPROW )</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">*             MQ0 = NUMROC( MAX( NEIG, NB, 2 ), NB, 0, 0, NPCOL )</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">*             ICEIL( X, Y ) is a ScaLAPACK function returning</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">*             ceiling(X/Y)</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">*          When LWORK is too small:</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">*             If LWORK is too small to guarantee orthogonality,</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">*             PSSYGVX attempts to maintain orthogonality in</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">*             the clusters with the smallest</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">*             spacing between the eigenvalues.</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">*             If LWORK is too small to compute all the eigenvectors</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">*             requested, no computation is performed and INFO=-23</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">*             is returned.  Note that when RANGE=&#39;V&#39;, PSSYGVX does</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">*             not know how many eigenvectors are requested until</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">*             the eigenvalues are computed.  Therefore, when RANGE=&#39;V&#39;</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">*             and as long as LWORK is large enough to allow PSSYGVX to</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">*             compute the eigenvalues, PSSYGVX will compute the</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">*             eigenvalues and as many eigenvectors as it can.</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">*          Relationship between workspace, orthogonality &amp; performance:</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">*             Greater performance can be achieved if adequate workspace</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">*             is provided.  On the other hand, in some situations,</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">*             performance can decrease as the workspace provided</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">*             increases above the workspace amount shown below:</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">*             For optimal performance, greater workspace may be</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">*             needed, i.e.</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">*                LWORK &gt;=  MAX( LWORK, 5 * N + NSYTRD_LWOPT,</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">*                  NSYGST_LWOPT )</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">*                Where:</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">*                  LWORK, as defined previously, depends upon the number</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">*                     of eigenvectors requested, and</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">*                  NSYTRD_LWOPT = N + 2*( ANB+1 )*( 4*NPS+2 ) +</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">*                    ( NPS + 3 ) *  NPS</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">*                  NSYGST_LWOPT =  2*NP0*NB + NQ0*NB + NB*NB</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">*                  ANB = PJLAENV( DESCA( CTXT_), 3, &#39;PSSYTTRD&#39;, &#39;L&#39;,</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">*                     0, 0, 0, 0)</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">*                  SQNPC = INT( SQRT( DBLE( NPROW * NPCOL ) ) )</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">*                  NPS = MAX( NUMROC( N, 1, 0, 0, SQNPC ), 2*ANB )</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">*                  NB = DESCA( MB_ )</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">*                  NP0 = NUMROC( N, NB, 0, 0, NPROW )</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">*                  NQ0 = NUMROC( N, NB, 0, 0, NPCOL )</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">*                  NUMROC is a ScaLAPACK tool functions;</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">*                  PJLAENV is a ScaLAPACK envionmental inquiry function</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">*                  MYROW, MYCOL, NPROW and NPCOL can be determined by</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">*                    calling the subroutine BLACS_GRIDINFO.</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">*                For large N, no extra workspace is needed, however the</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">*                biggest boost in performance comes for small N, so it</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">*                is wise to provide the extra workspace (typically less</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">*                than a Megabyte per process).</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">*             If CLUSTERSIZE &gt;= N/SQRT(NPROW*NPCOL), then providing</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">*             enough space to compute all the eigenvectors</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">*             orthogonally will cause serious degradation in</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">*             performance. In the limit (i.e. CLUSTERSIZE = N-1)</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">*             PSSTEIN will perform no better than SSTEIN on 1 processor.</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">*             For CLUSTERSIZE = N/SQRT(NPROW*NPCOL) reorthogonalizing</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">*             all eigenvectors will increase the total execution time</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">*             by a factor of 2 or more.</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">*             For CLUSTERSIZE &gt; N/SQRT(NPROW*NPCOL) execution time will</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">*             grow as the square of the cluster size, all other factors</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">*             remaining equal and assuming enough workspace.  Less</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">*             workspace means less reorthogonalization but faster</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">*             execution.</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">*          If LWORK = -1, then LWORK is global input and a workspace</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">*          query is assumed; the routine only calculates the size</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">*          required for optimal performance on all work arrays.</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">*          Each of these values is returned in the first entry of the</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">*          corresponding work array, and no error message is issued by</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">*          PXERBLA.</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">*  IWORK   (local workspace) INTEGER array</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">*          On return, IWORK(1) contains the amount of integer workspace</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">*          required.</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">*  LIWORK  (local input) INTEGER</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">*          size of IWORK</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">*          LIWORK &gt;= 6 * NNP</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">*          Where:</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">*            NNP = MAX( N, NPROW*NPCOL + 1, 4 )</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">*          If LIWORK = -1, then LIWORK is global input and a workspace</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">*          query is assumed; the routine only calculates the minimum</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">*          and optimal size for all work arrays. Each of these</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">*          values is returned in the first entry of the corresponding</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">*          work array, and no error message is issued by PXERBLA.</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">*  IFAIL   (output) INTEGER array, dimension (N)</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">*          IFAIL provides additional information when INFO .NE. 0</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">*          If (MOD(INFO/16,2).NE.0) then IFAIL(1) indicates the order of</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">*          the smallest minor which is not positive definite.</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">*          If (MOD(INFO,2).NE.0) on exit, then IFAIL contains the</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">*          indices of the eigenvectors that failed to converge.</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">*          If neither of the above error conditions hold and JOBZ = &#39;V&#39;,</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">*          then the first M elements of IFAIL are set to zero.</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">*  ICLUSTR (global output) integer array, dimension (2*NPROW*NPCOL)</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">*          This array contains indices of eigenvectors corresponding to</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">*          a cluster of eigenvalues that could not be reorthogonalized</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">*          due to insufficient workspace (see LWORK, ORFAC and INFO).</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">*          Eigenvectors corresponding to clusters of eigenvalues indexed</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">*          ICLUSTR(2*I-1) to ICLUSTR(2*I), could not be</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">*          reorthogonalized due to lack of workspace. Hence the</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">*          eigenvectors corresponding to these clusters may not be</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">*          orthogonal.  ICLUSTR() is a zero terminated array.</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">*          (ICLUSTR(2*K).NE.0 .AND. ICLUSTR(2*K+1).EQ.0) if and only if</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">*          K is the number of clusters</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">*          ICLUSTR is not referenced if JOBZ = &#39;N&#39;</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">*  GAP     (global output) REAL array,</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">*             dimension (NPROW*NPCOL)</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">*          This array contains the gap between eigenvalues whose</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">*          eigenvectors could not be reorthogonalized. The output</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">*          values in this array correspond to the clusters indicated</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">*          by the array ICLUSTR. As a result, the dot product between</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">*          eigenvectors correspoding to the I^th cluster may be as high</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">*          as ( C * n ) / GAP(I) where C is a small constant.</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">*  INFO    (global output) INTEGER</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">*          = 0:  successful exit</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">*          &lt; 0:  If the i-th argument is an array and the j-entry had</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">*                an illegal value, then INFO = -(i*100+j), if the i-th</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">*                argument is a scalar and had an illegal value, then</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">*                INFO = -i.</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">*          &gt; 0:  if (MOD(INFO,2).NE.0), then one or more eigenvectors</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">*                  failed to converge.  Their indices are stored</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">*                  in IFAIL.  Send e-mail to scalapack@cs.utk.edu</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">*                if (MOD(INFO/2,2).NE.0),then eigenvectors corresponding</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">*                  to one or more clusters of eigenvalues could not be</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">*                  reorthogonalized because of insufficient workspace.</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">*                  The indices of the clusters are stored in the array</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">*                  ICLUSTR.</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">*                if (MOD(INFO/4,2).NE.0), then space limit prevented</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">*                  PSSYGVX from computing all of the eigenvectors</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">*                  between VL and VU.  The number of eigenvectors</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">*                  computed is returned in NZ.</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">*                if (MOD(INFO/8,2).NE.0), then PSSTEBZ failed to</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">*                  compute eigenvalues.</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">*                  Send e-mail to scalapack@cs.utk.edu</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">*                if (MOD(INFO/16,2).NE.0), then B was not positive</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">*                  definite.  IFAIL(1) indicates the order of</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">*                  the smallest minor which is not positive definite.</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">*  Alignment requirements</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">*  ======================</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">*  The distributed submatrices A(IA:*, JA:*), C(IC:IC+M-1,JC:JC+N-1),</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">*  and B( IB:IB+N-1, JB:JB+N-1 ) must verify some alignment properties,</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">*  namely the following expressions should be true:</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">*     DESCA(MB_) = DESCA(NB_)</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">*     IA = IB = IZ</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">*     JA = IB = JZ</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">*     DESCA(M_) = DESCB(M_) =DESCZ(M_)</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">*     DESCA(N_) = DESCB(N_)= DESCZ(N_)</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">*     DESCA(MB_) = DESCB(MB_) = DESCZ(MB_)</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">*     DESCA(NB_) = DESCB(NB_) = DESCZ(NB_)</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">*     DESCA(RSRC_) = DESCB(RSRC_) = DESCZ(RSRC_)</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">*     DESCA(CSRC_) = DESCB(CSRC_) = DESCZ(CSRC_)</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">*     MOD( IA-1, DESCA( MB_ ) ) = 0</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">*     MOD( JA-1, DESCA( NB_ ) ) = 0</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">*     MOD( IB-1, DESCB( MB_ ) ) = 0</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">*     MOD( JB-1, DESCB( NB_ ) ) = 0</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">*  =====================================================================</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">*     .. Parameters ..</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      <span class="keywordtype">INTEGER</span>            BLOCK_CYCLIC_2D, DLEN_, DTYPE_, CTXT_, M_, N_,</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;     $                   MB_, NB_, RSRC_, CSRC_, LLD_</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <span class="keywordtype">PARAMETER</span>          ( BLOCK_CYCLIC_2D = 1, dlen_ = 9, dtype_ = 1,</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;     $                   ctxt_ = 2, m_ = 3, n_ = 4, mb_ = 5, nb_ = 6,</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;     $                   rsrc_ = 7, csrc_ = 8, lld_ = 9 )</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="keywordtype">      REAL</span>               ONE</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      parameter( one = 1.0e+0 )</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="keywordtype">      REAL</span>               FIVE, ZERO</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      <span class="keywordtype">PARAMETER</span>          ( FIVE = 5.0e+0, zero = 0.0e+0 )</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <span class="keywordtype">INTEGER</span>            IERRNPD</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      parameter( ierrnpd = 16 )</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">*     .. Local Scalars ..</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="keywordtype">LOGICAL</span>            ALLEIG, INDEIG, LQUERY, UPPER, VALEIG, WANTZ</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <span class="keywordtype">CHARACTER</span>          TRANS</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <span class="keywordtype">INTEGER</span>            ANB, IACOL, IAROW, IBCOL, IBROW, ICOFFA,</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;     $                   ICOFFB, ICTXT, IROFFA, IROFFB, LIWMIN, LWMIN,</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;     $                   lwopt, mq0, mycol, myrow, nb, neig, nn, np0,</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;     $                   npcol, nprow, nps, nq0, nsygst_lwopt,</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;     $                   nsytrd_lwopt, sqnpc</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="keywordtype">      REAL</span>               EPS, SCALE</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">*     .. Local Arrays ..</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      <span class="keywordtype">INTEGER</span>            IDUM1( 5 ), IDUM2( 5 )</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">*     .. External Functions ..</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="keywordtype">LOGICAL</span>            LSAME</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      <span class="keywordtype">INTEGER</span>            ICEIL, INDXG2P, NUMROC, PJLAENV</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      <span class="keywordtype">REAL</span>               PSLAMCH</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      <span class="keywordtype">EXTERNAL</span>           LSAME, ICEIL, INDXG2P, NUMROC, PJLAENV, PSLAMCH</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">*     .. External Subroutines ..</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      <span class="keywordtype">EXTERNAL</span>           blacs_gridinfo, <a class="code" href="../../d0/d57/chk1mat_8f.html#a4ea2ce0e3d95747357fb5c46465ab98c">chk1mat</a>, <a class="code" href="../../d5/d1d/pchkxmat_8f.html#ab9a003118373986afd74a380d10f3a9e">pchk1mat</a>, <a class="code" href="../../d5/d1d/pchkxmat_8f.html#a436662124356bd17e3767f91b4414759">pchk2mat</a>,</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;     $                   <a class="code" href="../../de/d0a/pspotrf_8f.html#af89c235028347988371bdd3b417f2ee4">pspotrf</a>, <a class="code" href="../../d4/de2/pssyevx_8f.html#adb5996ca5439cc3e8e629291cab4ca0c">pssyevx</a>, <a class="code" href="../../d0/d32/pssyngst_8f.html#a27b8296a7ff8cbbf0d735291ef4e4257">pssyngst</a>, pstrmm, pstrsm,</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;     $                   <a class="code" href="../../d3/dab/pxerbla_8f.html#a3e66ae54cb1f6eaf7e10e2c2974cc057">pxerbla</a>, sgebr2d, sgebs2d, sscal</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">*     .. Intrinsic Functions ..</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      <span class="keywordtype">INTRINSIC</span>          abs, dble, ichar, int, <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>, <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>, mod, real,</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;     $                   sqrt</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">*     .. Executable Statements ..</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">*       This is just to keep ftnchek and toolpack/1 happy</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <span class="keywordflow">IF</span>( block_cyclic_2d*csrc_*ctxt_*dlen_*dtype_*lld_*mb_*m_*nb_*n_*</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;     $    rsrc_.LT.0 )<span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">*     Get grid parameters</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      ictxt = desca( ctxt_ )</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      <span class="keyword">CALL </span>blacs_gridinfo( ictxt, nprow, npcol, myrow, mycol )</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">*     Test the input parameters</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      info = 0</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <span class="keywordflow">IF</span>( nprow.EQ.-1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;         info = -( 900+ctxt_ )</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( desca( ctxt_ ).NE.descb( ctxt_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;         info = -( 1300+ctxt_ )</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( desca( ctxt_ ).NE.descz( ctxt_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;         info = -( 2600+ctxt_ )</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">*     Get machine constants.</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;         eps = pslamch( desca( ctxt_ ), <span class="stringliteral">&#39;Precision&#39;</span> )</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;         wantz = lsame( jobz, <span class="stringliteral">&#39;V&#39;</span> )</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;         upper = lsame( uplo, <span class="stringliteral">&#39;U&#39;</span> )</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;         alleig = lsame( range, <span class="stringliteral">&#39;A&#39;</span> )</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;         valeig = lsame( range, <span class="stringliteral">&#39;V&#39;</span> )</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;         indeig = lsame( range, <span class="stringliteral">&#39;I&#39;</span> )</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d0/d57/chk1mat_8f.html#a4ea2ce0e3d95747357fb5c46465ab98c">chk1mat</a>( n, 4, n, 4, ia, ja, desca, 9, info )</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d0/d57/chk1mat_8f.html#a4ea2ce0e3d95747357fb5c46465ab98c">chk1mat</a>( n, 4, n, 4, ib, jb, descb, 13, info )</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d0/d57/chk1mat_8f.html#a4ea2ce0e3d95747357fb5c46465ab98c">chk1mat</a>( n, 4, n, 4, iz, jz, descz, 26, info )</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;         <span class="keywordflow">IF</span>( info.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            <span class="keywordflow">IF</span>( myrow.EQ.0 .AND. mycol.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;               work( 1 ) = abstol</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;               <span class="keywordflow">IF</span>( valeig ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                  work( 2 ) = vl</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                  work( 3 ) = vu</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;               <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                  work( 2 ) = zero</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                  work( 3 ) = zero</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;               <span class="keyword">CALL </span>sgebs2d( desca( ctxt_ ), <span class="stringliteral">&#39;ALL&#39;</span>, <span class="stringliteral">&#39; &#39;</span>, 3, 1, work, 3 )</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;               <span class="keyword">CALL </span>sgebr2d( desca( ctxt_ ), <span class="stringliteral">&#39;ALL&#39;</span>, <span class="stringliteral">&#39; &#39;</span>, 3, 1, work, 3,</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;     $                       0, 0 )</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            iarow = indxg2p( ia, desca( mb_ ), myrow, desca( rsrc_ ),</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;     $              nprow )</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            ibrow = indxg2p( ib, descb( mb_ ), myrow, descb( rsrc_ ),</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;     $              nprow )</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            iacol = indxg2p( ja, desca( nb_ ), mycol, desca( csrc_ ),</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;     $              npcol )</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            ibcol = indxg2p( jb, descb( nb_ ), mycol, descb( csrc_ ),</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;     $              npcol )</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            iroffa = mod( ia-1, desca( mb_ ) )</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            icoffa = mod( ja-1, desca( nb_ ) )</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            iroffb = mod( ib-1, descb( mb_ ) )</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            icoffb = mod( jb-1, descb( nb_ ) )</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">*     Compute the total amount of space needed</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            lquery = .false.</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            <span class="keywordflow">IF</span>( lwork.EQ.-1 .OR. liwork.EQ.-1 )</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;     $         lquery = .true.</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            liwmin = 6*<a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( n, ( nprow*npcol )+1, 4 )</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            nb = desca( mb_ )</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            nn = <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( n, nb, 2 )</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            np0 = numroc( nn, nb, 0, 0, nprow )</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            <span class="keywordflow">IF</span>( ( .NOT.wantz ) .OR. ( valeig .AND. ( .NOT.lquery ) ) )</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;     $           <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;               lwmin = 5*n + <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( 5*nn, nb*( np0+1 ) )</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;               <span class="keywordflow">IF</span>( wantz ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                  mq0 = numroc( <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( n, nb, 2 ), nb, 0, 0, npcol )</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                  lwopt = 5*n + <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( 5*nn, np0*mq0+2*nb*nb )</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;               <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                  lwopt = lwmin</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;               neig = 0</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;               <span class="keywordflow">IF</span>( alleig .OR. valeig ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                  neig = n</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;               <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( indeig ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                  neig = iu - il + 1</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;               mq0 = numroc( <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( neig, nb, 2 ), nb, 0, 0, npcol )</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;               lwmin = 5*n + <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( 5*nn, np0*mq0+2*nb*nb ) +</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;     $                 iceil( neig, nprow*npcol )*nn</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;               lwopt = lwmin</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">*           Compute how much workspace is needed to use the</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">*           new TRD and GST algorithms</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            anb = pjlaenv( ictxt, 3, <span class="stringliteral">&#39;PSSYTTRD&#39;</span>, <span class="stringliteral">&#39;L&#39;</span>, 0, 0, 0, 0 )</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            sqnpc = int( sqrt( dble( nprow*npcol ) ) )</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            nps = <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( numroc( n, 1, 0, 0, sqnpc ), 2*anb )</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            nsytrd_lwopt = 2*( anb+1 )*( 4*nps+2 ) + ( nps+4 )*nps</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            nb = desca( mb_ )</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            np0 = numroc( n, nb, 0, 0, nprow )</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            nq0 = numroc( n, nb, 0, 0, npcol )</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            nsygst_lwopt = 2*np0*nb + nq0*nb + nb*nb</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            lwopt = <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( lwopt, n+nsytrd_lwopt, nsygst_lwopt )</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">*       Version 1.0 Limitations</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            <span class="keywordflow">IF</span>( ibtype.LT.1 .OR. ibtype.GT.3 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;               info = -1</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( .NOT.( wantz .OR. lsame( jobz, <span class="stringliteral">&#39;N&#39;</span> ) ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;               info = -2</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( .NOT.( alleig .OR. valeig .OR. indeig ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;               info = -3</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( .NOT.upper .AND. .NOT.lsame( uplo, <span class="stringliteral">&#39;L&#39;</span> ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;               info = -4</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( n.LT.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;               info = -5</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( iroffa.NE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;               info = -7</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( icoffa.NE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;               info = -8</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( desca( mb_ ).NE.desca( nb_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;               info = -( 900+nb_ )</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( desca( m_ ).NE.descb( m_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;               info = -( 1300+m_ )</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( desca( n_ ).NE.descb( n_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;               info = -( 1300+n_ )</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( desca( mb_ ).NE.descb( mb_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;               info = -( 1300+mb_ )</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( desca( nb_ ).NE.descb( nb_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;               info = -( 1300+nb_ )</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( desca( rsrc_ ).NE.descb( rsrc_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;               info = -( 1300+rsrc_ )</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( desca( csrc_ ).NE.descb( csrc_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;               info = -( 1300+csrc_ )</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( desca( ctxt_ ).NE.descb( ctxt_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;               info = -( 1300+ctxt_ )</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( desca( m_ ).NE.descz( m_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;               info = -( 2200+m_ )</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( desca( n_ ).NE.descz( n_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;               info = -( 2200+n_ )</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( desca( mb_ ).NE.descz( mb_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;               info = -( 2200+mb_ )</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( desca( nb_ ).NE.descz( nb_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;               info = -( 2200+nb_ )</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( desca( rsrc_ ).NE.descz( rsrc_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;               info = -( 2200+rsrc_ )</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( desca( csrc_ ).NE.descz( csrc_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;               info = -( 2200+csrc_ )</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( desca( ctxt_ ).NE.descz( ctxt_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;               info = -( 2200+ctxt_ )</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( iroffb.NE.0 .OR. ibrow.NE.iarow ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;               info = -11</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( icoffb.NE.0 .OR. ibcol.NE.iacol ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;               info = -12</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( valeig .AND. n.GT.0 .AND. vu.LE.vl ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;               info = -15</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( indeig .AND. ( il.LT.1 .OR. il.GT.<a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( 1, n ) ) )</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;     $                <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;               info = -16</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( indeig .AND. ( iu.LT.<a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( n, il ) .OR. iu.GT.n ) )</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;     $                <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;               info = -17</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( valeig .AND. ( abs( work( 2 )-vl ).GT.five*eps*</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;     $               abs( vl ) ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;               info = -14</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( valeig .AND. ( abs( work( 3 )-vu ).GT.five*eps*</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;     $               abs( vu ) ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;               info = -15</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( abs( work( 1 )-abstol ).GT.five*eps*abs( abstol ) )</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;     $                <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;               info = -18</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( lwork.LT.lwmin .AND. .NOT.lquery ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;               info = -28</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( liwork.LT.liwmin .AND. .NOT.lquery ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;               info = -30</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;         idum1( 1 ) = ibtype</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;         idum2( 1 ) = 1</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;         <span class="keywordflow">IF</span>( wantz ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;            idum1( 2 ) = ichar( <span class="stringliteral">&#39;V&#39;</span> )</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;         <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            idum1( 2 ) = ichar( <span class="stringliteral">&#39;N&#39;</span> )</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;         idum2( 2 ) = 2</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;         <span class="keywordflow">IF</span>( upper ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;            idum1( 3 ) = ichar( <span class="stringliteral">&#39;U&#39;</span> )</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;         <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;            idum1( 3 ) = ichar( <span class="stringliteral">&#39;L&#39;</span> )</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;         idum2( 3 ) = 3</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;         <span class="keywordflow">IF</span>( alleig ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            idum1( 4 ) = ichar( <span class="stringliteral">&#39;A&#39;</span> )</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( indeig ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            idum1( 4 ) = ichar( <span class="stringliteral">&#39;I&#39;</span> )</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;         <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            idum1( 4 ) = ichar( <span class="stringliteral">&#39;V&#39;</span> )</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;         idum2( 4 ) = 4</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;         <span class="keywordflow">IF</span>( lquery ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            idum1( 5 ) = -1</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;         <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            idum1( 5 ) = 1</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;         idum2( 5 ) = 5</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d5/d1d/pchkxmat_8f.html#a436662124356bd17e3767f91b4414759">pchk2mat</a>( n, 4, n, 4, ia, ja, desca, 9, n, 4, n, 4, ib,</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;     $                  jb, descb, 13, 5, idum1, idum2, info )</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d5/d1d/pchkxmat_8f.html#ab9a003118373986afd74a380d10f3a9e">pchk1mat</a>( n, 4, n, 4, iz, jz, descz, 26, 0, idum1, idum2,</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;     $                  info )</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      iwork( 1 ) = liwmin</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      work( 1 ) = real( lwopt )</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      <span class="keywordflow">IF</span>( info.NE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d3/dab/pxerbla_8f.html#a3e66ae54cb1f6eaf7e10e2c2974cc057">pxerbla</a>( ictxt, <span class="stringliteral">&#39;PSSYGVX &#39;</span>, -info )</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;         <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( lquery ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;         <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment">*     Form a Cholesky factorization of sub( B ).</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      <span class="keyword">CALL </span><a class="code" href="../../de/d0a/pspotrf_8f.html#af89c235028347988371bdd3b417f2ee4">pspotrf</a>( uplo, n, b, ib, jb, descb, info )</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      <span class="keywordflow">IF</span>( info.NE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;         iwork( 1 ) = liwmin</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;         work( 1 ) = real( lwopt )</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;         ifail( 1 ) = info</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;         info = ierrnpd</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;         <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment">*     Transform problem to standard eigenvalue problem and solve.</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      <span class="keyword">CALL </span><a class="code" href="../../d0/d32/pssyngst_8f.html#a27b8296a7ff8cbbf0d735291ef4e4257">pssyngst</a>( ibtype, uplo, n, a, ia, ja, desca, b, ib, jb,</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;     $               descb, scale, work, lwork, info )</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      <span class="keyword">CALL </span><a class="code" href="../../d4/de2/pssyevx_8f.html#adb5996ca5439cc3e8e629291cab4ca0c">pssyevx</a>( jobz, range, uplo, n, a, ia, ja, desca, vl, vu, il,</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;     $              iu, abstol, m, nz, w, orfac, z, iz, jz, descz, work,</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;     $              lwork, iwork, liwork, ifail, iclustr, gap, info )</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      <span class="keywordflow">IF</span>( wantz ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment">*        Backtransform eigenvectors to the original problem.</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;         neig = m</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;         <span class="keywordflow">IF</span>( ibtype.EQ.1 .OR. ibtype.EQ.2 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment">*           For sub( A )*x=(lambda)*sub( B )*x and</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment">*           sub( A )*sub( B )*x=(lambda)*x; backtransform eigenvectors:</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment">*           x = inv(L)&#39;*y or inv(U)*y</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            <span class="keywordflow">IF</span>( upper ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;               trans = <span class="stringliteral">&#39;N&#39;</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;               trans = <span class="stringliteral">&#39;T&#39;</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            <span class="keyword">CALL </span>pstrsm( <span class="stringliteral">&#39;Left&#39;</span>, uplo, trans, <span class="stringliteral">&#39;Non-unit&#39;</span>, n, neig, one,</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;     $                   b, ib, jb, descb, z, iz, jz, descz )</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( ibtype.EQ.3 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment">*           For sub( B )*sub( A )*x=(lambda)*x;</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment">*           backtransform eigenvectors: x = L*y or U&#39;*y</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            <span class="keywordflow">IF</span>( upper ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;               trans = <span class="stringliteral">&#39;T&#39;</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;               trans = <span class="stringliteral">&#39;N&#39;</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            <span class="keyword">CALL </span>pstrmm( <span class="stringliteral">&#39;Left&#39;</span>, uplo, trans, <span class="stringliteral">&#39;Non-unit&#39;</span>, n, neig, one,</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;     $                   b, ib, jb, descb, z, iz, jz, descz )</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      <span class="keywordflow">IF</span>( scale.NE.one ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;         <span class="keyword">CALL </span>sscal( n, scale, w, 1 )</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      iwork( 1 ) = liwmin</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      work( 1 ) = real( lwopt )</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">*     End of PSSYGVX</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      <span class="keyword">END</span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="apssygvx_8f_html_a28f097fa6725bb411a63cb0196b35a6a"><div class="ttname"><a href="../../d3/d24/pssygvx_8f.html#a28f097fa6725bb411a63cb0196b35a6a">pssygvx</a></div><div class="ttdeci">subroutine pssygvx(IBTYPE, JOBZ, RANGE, UPLO, N, A, IA, JA, DESCA, B, IB, JB, DESCB, VL, VU, IL, IU, ABSTOL, M, NZ, W, ORFAC, Z, IZ, JZ, DESCZ, WORK, LWORK, IWORK, LIWORK, IFAIL, ICLUSTR, GAP, INFO)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d24/pssygvx_8f_source.html#l00006">pssygvx.f:6</a></div></div>
<div class="ttc" id="apcgemr_8c_html_a24e753bacac6be5f30e18f8a2bdefda4"><div class="ttname"><a href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a></div><div class="ttdeci">#define max(A, B)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dad/pcgemr_8c_source.html#l00180">pcgemr.c:180</a></div></div>
<div class="ttc" id="apssyevx_8f_html_adb5996ca5439cc3e8e629291cab4ca0c"><div class="ttname"><a href="../../d4/de2/pssyevx_8f.html#adb5996ca5439cc3e8e629291cab4ca0c">pssyevx</a></div><div class="ttdeci">subroutine pssyevx(JOBZ, RANGE, UPLO, N, A, IA, JA, DESCA, VL, VU, IL, IU, ABSTOL, M, NZ, W, ORFAC, Z, IZ, JZ, DESCZ, WORK, LWORK, IWORK, LIWORK, IFAIL, ICLUSTR, GAP, INFO)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/de2/pssyevx_8f_source.html#l00005">pssyevx.f:5</a></div></div>
<div class="ttc" id="apchkxmat_8f_html_ab9a003118373986afd74a380d10f3a9e"><div class="ttname"><a href="../../d5/d1d/pchkxmat_8f.html#ab9a003118373986afd74a380d10f3a9e">pchk1mat</a></div><div class="ttdeci">subroutine pchk1mat(MA, MAPOS0, NA, NAPOS0, IA, JA, DESCA, DESCAPOS0, NEXTRA, EX, EXPOS, INFO)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d1d/pchkxmat_8f_source.html#l00003">pchkxmat.f:3</a></div></div>
<div class="ttc" id="apchkxmat_8f_html_a436662124356bd17e3767f91b4414759"><div class="ttname"><a href="../../d5/d1d/pchkxmat_8f.html#a436662124356bd17e3767f91b4414759">pchk2mat</a></div><div class="ttdeci">subroutine pchk2mat(MA, MAPOS0, NA, NAPOS0, IA, JA, DESCA, DESCAPOS0, MB, MBPOS0, NB, NBPOS0, IB, JB, DESCB, DESCBPOS0, NEXTRA, EX, EXPOS, INFO)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d1d/pchkxmat_8f_source.html#l00175">pchkxmat.f:175</a></div></div>
<div class="ttc" id="achk1mat_8f_html_a4ea2ce0e3d95747357fb5c46465ab98c"><div class="ttname"><a href="../../d0/d57/chk1mat_8f.html#a4ea2ce0e3d95747357fb5c46465ab98c">chk1mat</a></div><div class="ttdeci">subroutine chk1mat(MA, MAPOS0, NA, NAPOS0, IA, JA, DESCA, DESCAPOS0, INFO)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d57/chk1mat_8f_source.html#l00003">chk1mat.f:3</a></div></div>
<div class="ttc" id="apspotrf_8f_html_af89c235028347988371bdd3b417f2ee4"><div class="ttname"><a href="../../de/d0a/pspotrf_8f.html#af89c235028347988371bdd3b417f2ee4">pspotrf</a></div><div class="ttdeci">subroutine pspotrf(UPLO, N, A, IA, JA, DESCA, INFO)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d0a/pspotrf_8f_source.html#l00002">pspotrf.f:2</a></div></div>
<div class="ttc" id="apxerbla_8f_html_a3e66ae54cb1f6eaf7e10e2c2974cc057"><div class="ttname"><a href="../../d3/dab/pxerbla_8f.html#a3e66ae54cb1f6eaf7e10e2c2974cc057">pxerbla</a></div><div class="ttdeci">subroutine pxerbla(ICTXT, SRNAME, INFO)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dab/pxerbla_8f_source.html#l00002">pxerbla.f:2</a></div></div>
<div class="ttc" id="apssyngst_8f_html_a27b8296a7ff8cbbf0d735291ef4e4257"><div class="ttname"><a href="../../d0/d32/pssyngst_8f.html#a27b8296a7ff8cbbf0d735291ef4e4257">pssyngst</a></div><div class="ttdeci">subroutine pssyngst(IBTYPE, UPLO, N, A, IA, JA, DESCA, B, IB, JB, DESCB, SCALE, WORK, LWORK, INFO)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d32/pssyngst_8f_source.html#l00003">pssyngst.f:3</a></div></div>
<div class="ttc" id="apcgemr_8c_html_a2d017cd3beb218080a7988e2deed2a11"><div class="ttname"><a href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a></div><div class="ttdeci">#define min(A, B)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dad/pcgemr_8c_source.html#l00181">pcgemr.c:181</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_1e771ff450ae847412a8c28572c155bb.html">SRC</a></li><li class="navelem"><a class="el" href="../../d3/d24/pssygvx_8f.html">pssygvx.f</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
  </ul>
</div>
</body>
</html>
