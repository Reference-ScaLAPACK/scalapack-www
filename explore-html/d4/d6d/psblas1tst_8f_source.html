<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ScaLAPACK 2.1: PBLAS/TESTING/psblas1tst.f Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../ScaLAPACK logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ScaLAPACK 2.1
   &#160;<span id="projectnumber">2.1</span>
   </div>
   <div id="projectbrief">ScaLAPACK: Scalable Linear Algebra PACKage</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d4/d6d/psblas1tst_8f_source.html','../../');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">psblas1tst.f</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d4/d6d/psblas1tst_8f.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;      <span class="keyword">BLOCK DATA</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;      <span class="keywordtype">INTEGER</span> NSUBS</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;      parameter(nsubs = 8)</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;      <span class="keywordtype">CHARACTER*7</span>        SNAMES( NSUBS )</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;      <span class="keyword">COMMON</span>             /snamec/snames</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;      <span class="keyword">DATA</span>               snames/<span class="stringliteral">&#39;PSSWAP &#39;</span>, <span class="stringliteral">&#39;PSSCAL &#39;</span>, <span class="stringliteral">&#39;PSCOPY &#39;</span>,</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;     $     <span class="stringliteral">&#39;PSAXPY &#39;</span>, <span class="stringliteral">&#39;PSDOT  &#39;</span>, <span class="stringliteral">&#39;PSNRM2 &#39;</span>,</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;     $     <span class="stringliteral">&#39;PSASUM &#39;</span>, <span class="stringliteral">&#39;PSAMAX &#39;</span>/</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;      <span class="keyword">END BLOCK DATA</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160; </div>
<div class="line"><a name="l00011"></a><span class="lineno"><a class="line" href="../../d4/d6d/psblas1tst_8f.html#ab8d905d8ee4ce77e78b9fcabba828092">   11</a></span>&#160;      <span class="keyword">PROGRAM</span> <a class="code" href="../../d4/d6d/psblas1tst_8f.html#ab8d905d8ee4ce77e78b9fcabba828092">psbla1tst</a></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">*  -- PBLAS testing driver (version 2.0.2) --</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">*     Univ. of Tennessee, Univ. of California Berkeley, Univ. of Colorado Denver</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">*     May 1 2012</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">*  Purpose</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">*  =======</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">*  PSBLA1TST is the main testing program for the PBLAS Level 1 routines.</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">*  The program must be driven by a short data file.  An  annotated exam-</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">*  ple of a data file can be obtained by deleting the first 3 characters</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">*  from the following 44 lines:</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">*  &#39;Level 1 PBLAS, Testing input file&#39;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">*  &#39;Intel iPSC/860 hypercube, gamma model.&#39;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">*  &#39;PSBLAS1TST.SUMM&#39;            output file name (if any)</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">*  6       device out</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">*  F       logical flag, T to stop on failures</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">*  F       logical flag, T to test error exits</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">*  0       verbosity, 0 for pass/fail, 1-3 for matrix dump on errors</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">*  10      the leading dimension gap</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">*  1       number of process grids (ordered pairs of P &amp; Q)</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">*  2 2 1 4 2 3 8        values of P</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">*  2 2 4 1 3 2 1        values of Q</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">*  1.0E0                value of ALPHA</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">*  2                    number of tests problems</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">*  3  4                 values of N</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">*  6 10                 values of M_X</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">*  6 10                 values of N_X</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">*  2  5                 values of IMB_X</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">*  2  5                 values of INB_X</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">*  2  5                 values of MB_X</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">*  2  5                 values of NB_X</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">*  0  1                 values of RSRC_X</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">*  0  0                 values of CSRC_X</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">*  1  1                 values of IX</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">*  1  1                 values of JX</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">*  1  1                 values of INCX</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">*  6 10                 values of M_Y</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">*  6 10                 values of N_Y</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">*  2  5                 values of IMB_Y</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">*  2  5                 values of INB_Y</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">*  2  5                 values of MB_Y</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">*  2  5                 values of NB_Y</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">*  0  1                 values of RSRC_Y</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">*  0  0                 values of CSRC_Y</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">*  1  1                 values of IY</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">*  1  1                 values of JY</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">*  6  1                 values of INCY</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">*  PSSWAP  T            put F for no test in the same column</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">*  PSSCAL  T            put F for no test in the same column</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">*  PSCOPY  T            put F for no test in the same column</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">*  PSAXPY  T            put F for no test in the same column</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">*  PSDOT   T            put F for no test in the same column</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">*  PSNRM2  T            put F for no test in the same column</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">*  PSASUM  T            put F for no test in the same column</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">*  PSAMAX  T            put F for no test in the same column</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">*  Internal Parameters</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">*  ===================</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">*  TOTMEM  INTEGER</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">*          TOTMEM  is  a machine-specific parameter indicating the maxi-</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">*          mum  amount  of  available  memory per  process in bytes. The</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">*          user  should  customize TOTMEM to his  platform.  Remember to</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">*          leave  room  in  memory  for the  operating system, the BLACS</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">*          buffer, etc.  For  example,  on  a system with 8 MB of memory</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">*          per process (e.g., one processor  on an Intel iPSC/860),  the</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">*          parameters we use are TOTMEM=6200000  (leaving 1.8 MB for OS,</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">*          code, BLACS buffer, etc).  However,  for PVM,  we usually set</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">*          TOTMEM = 2000000.  Some experimenting  with the maximum value</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">*          of TOTMEM may be required. By default, TOTMEM is 2000000.</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">*  REALSZ  INTEGER</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">*          REALSZ  indicates  the  length in bytes on the given platform</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">*          for  a  single  precision  real. By default, REALSZ is set to</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">*          four.</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">*  MEM     REAL array</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">*          MEM is an array of dimension TOTMEM / REALSZ.</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">*          All arrays used by SCALAPACK routines are allocated from this</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">*          array MEM and referenced by pointers. The  integer  IPA,  for</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">*          example, is a pointer to the starting element of MEM for  the</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">*          matrix A.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">*  -- Written on April 1, 1998 by</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">*     Antoine Petitet, University  of  Tennessee, Knoxville 37996, USA.</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">*  =====================================================================</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">*     .. Parameters ..</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="keywordtype">INTEGER</span>            maxtests, maxgrids, gapmul, realsz, totmem,</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;     $                   memsiz, nsubs</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="keywordtype">      REAL</span>               padval, zero</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      parameter( maxtests = 20, maxgrids = 20, gapmul = 10,</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;     $                   realsz = 4, totmem = 2000000,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;     $                   memsiz = totmem / realsz, zero = 0.0e+0,</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;     $                   padval = -9923.0e+0, nsubs = 8 )</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keywordtype">INTEGER</span>            block_cyclic_2d_inb, csrc_, ctxt_, dlen_,</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;     $                   dtype_, imb_, inb_, lld_, mb_, m_, nb_, n_,</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;     $                   rsrc_</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      parameter( block_cyclic_2d_inb = 2, dlen_ = 11,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;     $                   dtype_ = 1, ctxt_ = 2, m_ = 3, n_ = 4,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;     $                   imb_ = 5, inb_ = 6, mb_ = 7, nb_ = 8,</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;     $                   rsrc_ = 9, csrc_ = 10, lld_ = 11 )</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">*     .. Local Scalars ..</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="keywordtype">LOGICAL</span>            errflg, sof, tee</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="keywordtype">INTEGER</span>            csrcx, csrcy, i, iam, ictxt, igap, imbx, imby,</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;     $                   imidx, imidy, inbx, inby, incx, incy, ipmatx,</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;     $                   ipmaty, ipostx, iposty, iprex, iprey, ipw, ipx,</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;     $                   ipy, iverb, ix, ixseed, iy, iyseed, j, jx, jy,</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;     $                   k, ldx, ldy, mbx, mby, memreqd, mpx, mpy, mx,</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;     $                   my, mycol, myrow, n, nbx, nby, ngrids, nout,</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;     $                   npcol, nprocs, nprow, nqx, nqy, ntests, nx, ny,</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;     $                   pisclr, rsrcx, rsrcy, tskip, tstcnt</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="keywordtype">      REAL</span>               alpha, psclr, pusclr</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">*     .. Local Arrays ..</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="keywordtype">CHARACTER*80</span>       outfile</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="keywordtype">LOGICAL</span>            ltest( nsubs ), ycheck( nsubs )</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="keywordtype">INTEGER</span>            cscxval( maxtests ), cscyval( maxtests ),</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;     $                   descx( dlen_ ), descxr( dlen_ ),</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;     $                   descy( dlen_ ), descyr( dlen_ ), ierr( 4 ),</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;     $                   imbxval( maxtests ), imbyval( maxtests ),</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;     $                   inbxval( maxtests ), inbyval( maxtests ),</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;     $                   incxval( maxtests ), incyval( maxtests ),</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;     $                   ixval( maxtests ), iyval( maxtests ),</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;     $                   jxval( maxtests ), jyval( maxtests ),</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;     $                   kfail( nsubs ), kpass( nsubs ), kskip( nsubs ),</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;     $                   ktests( nsubs ), mbxval( maxtests ),</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;     $                   mbyval( maxtests ), mxval( maxtests ),</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;     $                   myval( maxtests ), nbxval( maxtests ),</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;     $                   nbyval( maxtests ), nval( maxtests ),</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;     $                   nxval( maxtests ), nyval( maxtests ),</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;     $                   pval( maxtests ), qval( maxtests ),</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;     $                   rscxval( maxtests ), rscyval( maxtests )</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keywordtype">      REAL</span>               mem( memsiz )</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">*     .. External Subroutines ..</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keywordtype">EXTERNAL</span>           blacs_exit, blacs_get, blacs_gridexit,</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;     $                   blacs_gridinfo, blacs_gridinit, blacs_pinfo,</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;     $                   igsum2d, <a class="code" href="../../d1/d4b/pblastst_8f.html#a670947594ecdfbf17d5bb2f70e9b8ec0">pb_descset2</a>, <a class="code" href="../../da/d4c/psblastst_8f.html#af309b458118977fe95237d297515daba">pb_pslaprnt</a>, <a class="code" href="../../da/d4c/psblastst_8f.html#a21215553eb9b46033953f7e246405806">pb_schekpad</a>,</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;     $                   <a class="code" href="../../da/d4c/psblastst_8f.html#a53140a30d5b1435b4faad1c7e72eb54a">pb_sfillpad</a>, psamax, psasum, psaxpy,</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;     $                   <a class="code" href="../../d4/d6d/psblas1tst_8f.html#ad2436bcddc0ca469999b3187b2c8304b">psbla1tstinfo</a>, <a class="code" href="../../d4/d6d/psblas1tst_8f.html#a57554860850376f1ecad2714c22dc91b">psblas1tstchk</a>, <a class="code" href="../../d4/d6d/psblas1tst_8f.html#aef7dc3dabf5d74e083bda14c3e76cf84">psblas1tstchke</a>,</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;     $                   <a class="code" href="../../d4/d6d/psblas1tst_8f.html#a0e7ba7d1b520a00e8806b2744bda0b66">pschkarg1</a>, <a class="code" href="../../da/d4c/psblastst_8f.html#a8168722944c9e4e0138bbea6a8d5091c">pschkvout</a>, pscopy, psdot, <a class="code" href="../../da/d4c/psblastst_8f.html#a7e786c7f84eeeff7336fd70cdf729c96">pslagen</a>,</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;     $                   <a class="code" href="../../da/d4c/psblastst_8f.html#a4a5cf80922ff74c2571d743096f5c8dd">psmprnt</a>, psnrm2, psscal, psswap, <a class="code" href="../../da/d4c/psblastst_8f.html#af5576b27c92043bc8282f79f64b7c53b">psvprnt</a>,</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;     $                   <a class="code" href="../../d1/d4b/pblastst_8f.html#ac822f48a34940852a1b5ccf19c7dff69">pvdescchk</a>, <a class="code" href="../../d1/d4b/pblastst_8f.html#a821ce4870ec238e28c06a75f188ec19c">pvdimchk</a></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">*     .. Intrinsic Functions ..</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="keywordtype">INTRINSIC</span>          abs, <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>, mod</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">*     .. Common Blocks ..</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="keywordtype">CHARACTER*7</span>        snames( nsubs )</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="keywordtype">LOGICAL</span>            abrtflg</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="keywordtype">INTEGER</span>            info, nblog</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <span class="keyword">COMMON</span>             /snamec/snames</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="keyword">COMMON</span>             /infoc/info, nblog</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="keyword">COMMON</span>             /pberrorc/nout, abrtflg</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">*     .. Data Statements ..</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <span class="keyword">DATA</span>               ycheck/.true., .false., .true., .true., .true.,</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;     $                   .false., .false., .false./</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">*     .. Executable Statements ..</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">*     Initialization</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">*     Set flag so that the PBLAS error handler will abort on errors.</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      abrtflg = .false.</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">*     So far no error, will become true as soon as one error is found.</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      errflg = .false.</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">*     Test counters</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      tskip  = 0</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      tstcnt = 0</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">*     Seeds for random matrix generations.</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      ixseed = 100</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      iyseed = 200</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">*     So far no tests have been performed.</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <span class="keywordflow">DO</span> 10 i = 1, nsubs</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;         kpass( i )  = 0</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;         kskip( i )  = 0</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;         kfail( i )  = 0</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;         ktests( i ) = 0</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;   10 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">*     Get starting information</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keyword">CALL </span>blacs_pinfo( iam, nprocs )</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="keyword">CALL </span><a class="code" href="../../d4/d6d/psblas1tst_8f.html#ad2436bcddc0ca469999b3187b2c8304b">psbla1tstinfo</a>( outfile, nout, ntests, nval, mxval, nxval,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;     $                    imbxval, mbxval, inbxval, nbxval, rscxval,</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;     $                    cscxval, ixval, jxval, incxval, myval,</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;     $                    nyval, imbyval, mbyval, inbyval, nbyval,</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;     $                    rscyval, cscyval, iyval, jyval, incyval,</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;     $                    maxtests, ngrids, pval, maxgrids, qval,</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;     $                    maxgrids, ltest, sof, tee, iam, igap, iverb,</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;     $                    nprocs, alpha, mem )</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="keywordflow">IF</span>( iam.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = 9979 )</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = * )</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">*     If TEE is set then Test Error Exits of routines.</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <span class="keywordflow">IF</span>( tee )</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;     $   <span class="keyword">CALL </span><a class="code" href="../../d4/d6d/psblas1tst_8f.html#aef7dc3dabf5d74e083bda14c3e76cf84">psblas1tstchke</a>( ltest, nout, nprocs )</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">*     Loop over different process grids</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="keywordflow">DO</span> 60 i = 1, ngrids</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;         nprow = pval( i )</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;         npcol = qval( i )</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">*        Make sure grid information is correct</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;         ierr( 1 ) = 0</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;         <span class="keywordflow">IF</span>( nprow.LT.1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <span class="keywordflow">IF</span>( iam.EQ.0 )</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;     $         <span class="keyword">WRITE</span>( nout, fmt = 9999 ) <span class="stringliteral">&#39;GRID SIZE&#39;</span>, <span class="stringliteral">&#39;NPROW&#39;</span>, nprow</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            ierr( 1 ) = 1</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( npcol.LT.1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <span class="keywordflow">IF</span>( iam.EQ.0 )</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;     $         <span class="keyword">WRITE</span>( nout, fmt = 9999 ) <span class="stringliteral">&#39;GRID SIZE&#39;</span>, <span class="stringliteral">&#39;NPCOL&#39;</span>, npcol</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            ierr( 1 ) = 1</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( nprow*npcol.GT.nprocs ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            <span class="keywordflow">IF</span>( iam.EQ.0 )</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;     $         <span class="keyword">WRITE</span>( nout, fmt = 9998 ) nprow*npcol, nprocs</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            ierr( 1 ) = 1</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;         <span class="keywordflow">IF</span>( ierr( 1 ).GT.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            <span class="keywordflow">IF</span>( iam.EQ.0 )</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;     $         <span class="keyword">WRITE</span>( nout, fmt = 9997 ) <span class="stringliteral">&#39;GRID&#39;</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            tskip = tskip + 1</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <span class="keywordflow">GO TO</span> 60</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">*        Define process grid</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;         <span class="keyword">CALL </span>blacs_get( -1, 0, ictxt )</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;         <span class="keyword">CALL </span>blacs_gridinit( ictxt, <span class="stringliteral">&#39;Row-major&#39;</span>, nprow, npcol )</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;         <span class="keyword">CALL </span>blacs_gridinfo( ictxt, nprow, npcol, myrow, mycol )</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">*        Go to bottom of process grid loop if this case doesn&#39;t use my</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">*        process</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;         <span class="keywordflow">IF</span>( myrow.GE.nprow .OR. mycol.GE.npcol )</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;     $      <span class="keywordflow">GO TO</span> 60</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">*        Loop over number of tests</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;         <span class="keywordflow">DO</span> 50 j = 1, ntests</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">*           Get the test parameters</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            n     = nval( j )</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            mx    = mxval( j )</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            nx    = nxval( j )</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            imbx  = imbxval( j )</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            mbx   = mbxval( j )</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            inbx  = inbxval( j )</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            nbx   = nbxval( j )</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            rsrcx = rscxval( j )</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            csrcx = cscxval( j )</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            ix    = ixval( j )</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            jx    = jxval( j )</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            incx  = incxval( j )</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            my    = myval( j )</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            ny    = nyval( j )</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            imby  = imbyval( j )</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            mby   = mbyval( j )</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            inby  = inbyval( j )</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            nby   = nbyval( j )</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            rsrcy = rscyval( j )</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            csrcy = cscyval( j )</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            iy    = iyval( j )</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            jy    = jyval( j )</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            incy  = incyval( j )</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="keywordflow">IF</span>( iam.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;               tstcnt = tstcnt + 1</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;               <span class="keyword">WRITE</span>( nout, fmt = * )</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;               <span class="keyword">WRITE</span>( nout, fmt = 9996 ) tstcnt, nprow, npcol</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;               <span class="keyword">WRITE</span>( nout, fmt = * )</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;               <span class="keyword">WRITE</span>( nout, fmt = 9995 )</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;               <span class="keyword">WRITE</span>( nout, fmt = 9994 )</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;               <span class="keyword">WRITE</span>( nout, fmt = 9995 )</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;               <span class="keyword">WRITE</span>( nout, fmt = 9993 ) n, ix, jx, mx, nx, imbx, inbx,</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;     $                                   mbx, nbx, rsrcx, csrcx, incx</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;               <span class="keyword">WRITE</span>( nout, fmt = 9995 )</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;               <span class="keyword">WRITE</span>( nout, fmt = 9992 )</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;               <span class="keyword">WRITE</span>( nout, fmt = 9995 )</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;               <span class="keyword">WRITE</span>( nout, fmt = 9993 ) n, iy, jy, my, ny, imby, inby,</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;     $                                   mby, nby, rsrcy, csrcy, incy</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;               <span class="keyword">WRITE</span>( nout, fmt = 9995 )</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">*           Check the validity of the input and initialize DESC_</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#ac822f48a34940852a1b5ccf19c7dff69">pvdescchk</a>( ictxt, nout, <span class="stringliteral">&#39;X&#39;</span>, descx,</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;     $                      block_cyclic_2d_inb, mx, nx, imbx, inbx,</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;     $                      mbx, nbx, rsrcx, csrcx, incx, mpx, nqx,</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;     $                      iprex, imidx, ipostx, igap, gapmul,</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;     $                      ierr( 1 ) )</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#ac822f48a34940852a1b5ccf19c7dff69">pvdescchk</a>( ictxt, nout, <span class="stringliteral">&#39;Y&#39;</span>, descy,</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;     $                      block_cyclic_2d_inb, my, ny, imby, inby,</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;     $                      mby, nby, rsrcy, csrcy, incy, mpy, nqy,</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;     $                      iprey, imidy, iposty, igap, gapmul,</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;     $                      ierr( 2 ) )</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <span class="keywordflow">IF</span>( ierr( 1 ).GT.0 .OR. ierr( 2 ).GT.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;               tskip = tskip + 1</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;               <span class="keywordflow">GO TO</span> 40</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            ldx = <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( 1, mx )</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            ldy = <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( 1, my )</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">*           Assign pointers into MEM for matrices corresponding to</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">*           vectors X and Y. Ex: IPX starts at position MEM( IPREX+1 ).</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            ipx    = iprex + 1</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            ipy    = ipx + descx( lld_ ) * nqx + ipostx + iprey</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            ipmatx = ipy + descy( lld_ ) * nqy + iposty</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            ipmaty = ipmatx + mx * nx</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            ipw    = ipmaty + my * ny</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">*           Check if sufficient memory.</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">*           Requirement = mem for local part of parallel matrices +</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">*                         mem for whole matrices for comp. check +</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">*                         mem for recving comp. check error vals.</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            memreqd = ipw - 1 +</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;     $                <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( imbx, mbx ), <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( imby, mby ) )</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            ierr( 1 ) = 0</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            <span class="keywordflow">IF</span>( memreqd.GT.memsiz ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;               <span class="keywordflow">IF</span>( iam.EQ.0 )</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;     $            <span class="keyword">WRITE</span>( nout, fmt = 9990 ) memreqd*realsz</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;               ierr( 1 ) = 1</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">*           Check all processes for an error</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="keyword">CALL </span>igsum2d( ictxt, <span class="stringliteral">&#39;All&#39;</span>, <span class="stringliteral">&#39; &#39;</span>, 1, 1, ierr, 1, -1, 0 )</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <span class="keywordflow">IF</span>( ierr( 1 ).GT.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;               <span class="keywordflow">IF</span>( iam.EQ.0 )</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;     $            <span class="keyword">WRITE</span>( nout, fmt = 9991 )</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;               tskip = tskip + 1</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;               <span class="keywordflow">GO TO</span> 40</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">*           Loop over all PBLAS 1 routines</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            <span class="keywordflow">DO</span> 30 k = 1, nsubs</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">*              Continue only if this sub has to be tested.</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;               <span class="keywordflow">IF</span>( .NOT.ltest( k ) )</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;     $            <span class="keywordflow">GO TO</span> 30</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;               <span class="keywordflow">IF</span>( iam.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                  <span class="keyword">WRITE</span>( nout, fmt = * )</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                  <span class="keyword">WRITE</span>( nout, fmt = 9989 ) snames( k )</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">*              Check the validity of the operand sizes</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;               <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a821ce4870ec238e28c06a75f188ec19c">pvdimchk</a>( ictxt, nout, n, <span class="stringliteral">&#39;X&#39;</span>, ix, jx, descx, incx,</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;     $                        ierr( 1 ) )</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;               <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a821ce4870ec238e28c06a75f188ec19c">pvdimchk</a>( ictxt, nout, n, <span class="stringliteral">&#39;Y&#39;</span>, iy, jy, descy, incy,</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;     $                        ierr( 2 ) )</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;               <span class="keywordflow">IF</span>( ierr( 1 ).NE.0 .OR. ierr( 2 ).NE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                  kskip( k ) = kskip( k ) + 1</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                  <span class="keywordflow">GO TO</span> 30</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">*              Generate distributed matrices X and Y</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;               <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a7e786c7f84eeeff7336fd70cdf729c96">pslagen</a>( .false., <span class="stringliteral">&#39;None&#39;</span>, <span class="stringliteral">&#39;No diag&#39;</span>, 0, mx, nx, 1,</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;     $                       1, descx, ixseed, mem( ipx ),</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;     $                       descx( lld_ ) )</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;               <span class="keywordflow">IF</span>( ycheck( k ) )</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;     $            <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a7e786c7f84eeeff7336fd70cdf729c96">pslagen</a>( .false., <span class="stringliteral">&#39;None&#39;</span>, <span class="stringliteral">&#39;No diag&#39;</span>, 0, my, ny,</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;     $                          1, 1, descy, iyseed, mem( ipy ),</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;     $                          descy( lld_ ) )</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">*              Generate entire matrices on each process.</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;               <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a670947594ecdfbf17d5bb2f70e9b8ec0">pb_descset2</a>( descxr, mx, nx, imbx, inbx, mbx, nbx,</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;     $                           -1, -1, ictxt, <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( 1, mx ) )</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;               <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a7e786c7f84eeeff7336fd70cdf729c96">pslagen</a>( .false., <span class="stringliteral">&#39;None&#39;</span>, <span class="stringliteral">&#39;No diag&#39;</span>, 0, mx, nx, 1,</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;     $                       1, descxr, ixseed, mem( ipmatx ),</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;     $                       descxr( lld_ ) )</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;               <span class="keywordflow">IF</span>( ycheck( k ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a670947594ecdfbf17d5bb2f70e9b8ec0">pb_descset2</a>( descyr, my, ny, imby, inby, mby,</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;     $                              nby, -1, -1, ictxt, <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( 1, my ) )</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a7e786c7f84eeeff7336fd70cdf729c96">pslagen</a>( .false., <span class="stringliteral">&#39;None&#39;</span>, <span class="stringliteral">&#39;No diag&#39;</span>, 0, my, ny,</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;     $                          1, 1, descyr, iyseed, mem( ipmaty ),</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;     $                          descyr( lld_ ) )</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">*              Pad the guard zones of X, and Y</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;               <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a53140a30d5b1435b4faad1c7e72eb54a">pb_sfillpad</a>( ictxt, mpx, nqx, mem( ipx-iprex ),</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;     $                           descx( lld_ ), iprex, ipostx, padval )</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;               <span class="keywordflow">IF</span>( ycheck( k ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a53140a30d5b1435b4faad1c7e72eb54a">pb_sfillpad</a>( ictxt, mpy, nqy, mem( ipy-iprey ),</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;     $                              descy( lld_ ), iprey, iposty,</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;     $                              padval )</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">*              Initialize the check for INPUT only args.</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;               info = 0</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;               <span class="keyword">CALL </span><a class="code" href="../../d4/d6d/psblas1tst_8f.html#a0e7ba7d1b520a00e8806b2744bda0b66">pschkarg1</a>( ictxt, nout, snames( k ), n, alpha, ix,</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;     $                         jx, descx, incx, iy, jy, descy, incy,</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;     $                         info )</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;               info = 0</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;               psclr  = zero</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;               pusclr = zero</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;               pisclr = 0</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">*              Print initial parallel data if IVERB &gt;= 2.</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;               <span class="keywordflow">IF</span>( iverb.EQ.2 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                  <span class="keywordflow">IF</span>( incx.EQ.descx( m_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                     <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#af309b458118977fe95237d297515daba">pb_pslaprnt</a>( 1, n, mem( ipx ), ix, jx, descx,</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;     $                                 0, 0, <span class="stringliteral">&#39;PARALLEL_INITIAL_X&#39;</span>, nout,</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;     $                                 mem( ipw ) )</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                     <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#af309b458118977fe95237d297515daba">pb_pslaprnt</a>( n, 1, mem( ipx ), ix, jx, descx,</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;     $                                 0, 0, <span class="stringliteral">&#39;PARALLEL_INITIAL_X&#39;</span>, nout,</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;     $                                 mem( ipw ) )</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                  <span class="keywordflow">IF</span>( ycheck( k ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                     <span class="keywordflow">IF</span>( incy.EQ.descy( m_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#af309b458118977fe95237d297515daba">pb_pslaprnt</a>( 1, n, mem( ipy ), iy, jy,</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;     $                                    descy, 0, 0,</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;     $                                    <span class="stringliteral">&#39;PARALLEL_INITIAL_Y&#39;</span>, nout,</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;     $                                    mem( ipw ) )</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#af309b458118977fe95237d297515daba">pb_pslaprnt</a>( n, 1, mem( ipy ), iy, jy,</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;     $                                    descy, 0, 0,</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;     $                                    <span class="stringliteral">&#39;PARALLEL_INITIAL_Y&#39;</span>, nout,</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;     $                                    mem( ipw ) )</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="keywordflow">                     END IF</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;               <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( iverb.GE.3 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#af309b458118977fe95237d297515daba">pb_pslaprnt</a>( mx, nx, mem( ipx ), 1, 1, descx, 0,</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;     $                              0, <span class="stringliteral">&#39;PARALLEL_INITIAL_X&#39;</span>, nout,</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;     $                              mem( ipw ) )</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                  <span class="keywordflow">IF</span>( ycheck( k ) )</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;     $               <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#af309b458118977fe95237d297515daba">pb_pslaprnt</a>( my, ny, mem( ipy ), 1, 1, descy,</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;     $                                 0, 0, <span class="stringliteral">&#39;PARALLEL_INITIAL_Y&#39;</span>, nout,</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;     $                                 mem( ipw ) )</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">*              Call the PBLAS routine</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;               <span class="keywordflow">IF</span>( k.EQ.1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">*                 Test PSSWAP</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                  <span class="keyword">CALL </span>psswap( n, mem( ipx ), ix, jx, descx, incx,</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;     $                         mem( ipy ), iy, jy, descy, incy )</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;               <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( k.EQ.2 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">*                 Test PSSCAL</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                  psclr = alpha</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                  <span class="keyword">CALL </span>psscal( n, alpha, mem( ipx ), ix, jx, descx,</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;     $                         incx )</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;               <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( k.EQ.3 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">*                 Test PSCOPY</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                  <span class="keyword">CALL </span>pscopy( n, mem( ipx ), ix, jx, descx, incx,</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;     $                         mem( ipy ), iy, jy, descy, incy )</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;               <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( k.EQ.4 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">*                 Test PSAXPY</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                  psclr = alpha</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                  <span class="keyword">CALL </span>psaxpy( n, alpha, mem( ipx ), ix, jx, descx,</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;     $                         incx, mem( ipy ), iy, jy, descy, incy )</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;               <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( k.EQ.5 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">*                 Test PSDOT</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                  <span class="keyword">CALL </span>psdot( n, psclr, mem( ipx ), ix, jx, descx, incx,</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;     $                        mem( ipy ), iy, jy, descy, incy )</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;               <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( k.EQ.6 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">*                 Test PSNRM2</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                  <span class="keyword">CALL </span>psnrm2( n, pusclr, mem( ipx ), ix, jx, descx,</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;     $                         incx )</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;               <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( k.EQ.7 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">*                 Test PSASUM</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                  <span class="keyword">CALL </span>psasum( n, pusclr, mem( ipx ), ix, jx, descx,</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;     $                         incx )</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;               <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( k.EQ.8 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                  <span class="keyword">CALL </span>psamax( n, psclr, pisclr, mem( ipx ), ix, jx,</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;     $                         descx, incx )</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">*              Check if the operation has been performed.</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;               <span class="keywordflow">IF</span>( info.NE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                  kskip( k ) = kskip( k ) + 1</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                  <span class="keywordflow">IF</span>( iam.EQ.0 )</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;     $               <span class="keyword">WRITE</span>( nout, fmt = 9978 ) info</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                  <span class="keywordflow">GO TO</span> 30</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">*              Check the computations</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;               <span class="keyword">CALL </span><a class="code" href="../../d4/d6d/psblas1tst_8f.html#a57554860850376f1ecad2714c22dc91b">psblas1tstchk</a>( ictxt, nout, k, n, psclr, pusclr,</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;     $                             pisclr, mem( ipmatx ), mem( ipx ),</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;     $                             ix, jx, descx, incx, mem( ipmaty ),</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;     $                             mem( ipy ), iy, jy, descy, incy,</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;     $                             info )</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;               <span class="keywordflow">IF</span>( mod( info, 2 ).EQ.1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                  ierr( 1 ) = 1</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;               <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( mod( info / 2, 2 ).EQ.1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                  ierr( 2 ) = 1</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;               <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( info.NE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                  ierr( 1 ) = 1</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                  ierr( 2 ) = 1</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">*              Check padding</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;               <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a21215553eb9b46033953f7e246405806">pb_schekpad</a>( ictxt, snames( k ), mpx, nqx,</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;     $                           mem( ipx-iprex ), descx( lld_ ),</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;     $                           iprex, ipostx, padval )</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;               <span class="keywordflow">IF</span>( ycheck( k ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a21215553eb9b46033953f7e246405806">pb_schekpad</a>( ictxt, snames( k ), mpy, nqy,</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;     $                              mem( ipy-iprey ), descy( lld_ ),</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;     $                              iprey, iposty, padval )</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">*              Check input-only scalar arguments</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;               info = 1</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;               <span class="keyword">CALL </span><a class="code" href="../../d4/d6d/psblas1tst_8f.html#a0e7ba7d1b520a00e8806b2744bda0b66">pschkarg1</a>( ictxt, nout, snames( k ), n, alpha, ix,</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;     $                         jx, descx, incx, iy, jy, descy, incy,</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;     $                         info )</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">*              Check input-only array arguments</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;               <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a8168722944c9e4e0138bbea6a8d5091c">pschkvout</a>( n, mem( ipmatx ), mem( ipx ), ix, jx,</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;     $                         descx, incx, ierr( 3 ) )</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;               <span class="keywordflow">IF</span>( ierr( 3 ).NE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                  <span class="keywordflow">IF</span>( iam.EQ.0 )</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;     $               <span class="keyword">WRITE</span>( nout, fmt = 9986 ) <span class="stringliteral">&#39;PARALLEL_X&#39;</span>, snames( k )</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;               <span class="keywordflow">IF</span>( ycheck( k ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a8168722944c9e4e0138bbea6a8d5091c">pschkvout</a>( n, mem( ipmaty ), mem( ipy ), iy, jy,</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;     $                            descy, incy, ierr( 4 ) )</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                  <span class="keywordflow">IF</span>( ierr( 4 ).NE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                     <span class="keywordflow">IF</span>( iam.EQ.0 )</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;     $                  <span class="keyword">WRITE</span>( nout, fmt = 9986 ) <span class="stringliteral">&#39;PARALLEL_Y&#39;</span>,</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;     $                                       snames( k )</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">*              Only node 0 prints computational test result</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;               <span class="keywordflow">IF</span>( info.NE.0 .OR. ierr( 1 ).NE.0 .OR.</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;     $             ierr( 2 ).NE.0 .OR. ierr( 3 ).NE.0 .OR.</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;     $             ierr( 4 ).NE. 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                  <span class="keywordflow">IF</span>( iam.EQ.0 )</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;     $               <span class="keyword">WRITE</span>( nout, fmt = 9988 ) snames( k )</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                  kfail( k ) = kfail( k ) + 1</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                  errflg = .true.</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;               <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                  <span class="keywordflow">IF</span>( iam.EQ.0 )</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;     $               <span class="keyword">WRITE</span>( nout, fmt = 9987 ) snames( k )</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                  kpass( k ) = kpass( k ) + 1</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">*              Dump matrix if IVERB &gt;= 1 and error.</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;               <span class="keywordflow">IF</span>( iverb.GE.1 .AND. errflg ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                  <span class="keywordflow">IF</span>( ierr( 3 ).NE.0 .OR. iverb.GE.3 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                     <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a4a5cf80922ff74c2571d743096f5c8dd">psmprnt</a>( ictxt, nout, mx, nx, mem( ipmatx ),</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;     $                             ldx, 0, 0, <span class="stringliteral">&#39;SERIAL_X&#39;</span> )</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                     <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#af309b458118977fe95237d297515daba">pb_pslaprnt</a>( mx, nx, mem( ipx ), 1, 1, descx,</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;     $                                 0, 0, <span class="stringliteral">&#39;PARALLEL_X&#39;</span>, nout,</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;     $                                 mem( ipmatx ) )</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( ierr( 1 ).NE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                     <span class="keywordflow">IF</span>( n.GT.0 )</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;     $                  <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#af5576b27c92043bc8282f79f64b7c53b">psvprnt</a>( ictxt, nout, n,</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;     $                                mem( ipmatx+ix-1+(jx-1)*ldx ),</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;     $                                incx, 0, 0, <span class="stringliteral">&#39;SERIAL_X&#39;</span> )</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                     <span class="keywordflow">IF</span>( incx.EQ.descx( m_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#af309b458118977fe95237d297515daba">pb_pslaprnt</a>( 1, n, mem( ipx ), ix, jx,</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;     $                                    descx, 0, 0, <span class="stringliteral">&#39;PARALLEL_X&#39;</span>,</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;     $                                    nout, mem( ipmatx ) )</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#af309b458118977fe95237d297515daba">pb_pslaprnt</a>( n, 1, mem( ipx ), ix, jx,</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;     $                                    descx, 0, 0, <span class="stringliteral">&#39;PARALLEL_X&#39;</span>,</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;     $                                    nout, mem( ipmatx ) )</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="keywordflow">                     END IF</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                  <span class="keywordflow">IF</span>( ycheck( k ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                     <span class="keywordflow">IF</span>( ierr( 4 ).NE.0 .OR. iverb.GE.3 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a4a5cf80922ff74c2571d743096f5c8dd">psmprnt</a>( ictxt, nout, my, ny,</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;     $                                mem( ipmaty ), ldy, 0, 0,</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;     $                                <span class="stringliteral">&#39;SERIAL_Y&#39;</span> )</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#af309b458118977fe95237d297515daba">pb_pslaprnt</a>( my, ny, mem( ipy ), 1, 1,</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;     $                                    descy, 0, 0, <span class="stringliteral">&#39;PARALLEL_Y&#39;</span>,</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;     $                                    nout, mem( ipmatx ) )</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                     <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( ierr( 2 ).NE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                        <span class="keywordflow">IF</span>( n.GT.0 )</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;     $                     <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#af5576b27c92043bc8282f79f64b7c53b">psvprnt</a>( ictxt, nout, n,</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;     $                                   mem( ipmaty+iy-1+(jy-1)*ldy ),</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;     $                                   incy, 0, 0, <span class="stringliteral">&#39;SERIAL_Y&#39;</span> )</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                        <span class="keywordflow">IF</span>( incy.EQ.descy( m_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                           <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#af309b458118977fe95237d297515daba">pb_pslaprnt</a>( 1, n, mem( ipy ), iy, jy,</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;     $                                       descy, 0, 0, <span class="stringliteral">&#39;PARALLEL_Y&#39;</span>,</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;     $                                       nout, mem( ipmatx ) )</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                           <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#af309b458118977fe95237d297515daba">pb_pslaprnt</a>( n, 1, mem( ipy ), iy, jy,</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;     $                                       descy, 0, 0, <span class="stringliteral">&#39;PARALLEL_Y&#39;</span>,</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;     $                                       nout, mem( ipmatx ) )</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="keywordflow">                        END IF</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="keywordflow">                     END IF</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">*              Leave if error and &quot;Stop On Failure&quot;</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;               <span class="keywordflow">IF</span>( sof.AND.errflg )</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;     $            <span class="keywordflow">GO TO</span> 70</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;   30       <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;   40       <span class="keywordflow">IF</span>( iam.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;               <span class="keyword">WRITE</span>( nout, fmt = * )</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;               <span class="keyword">WRITE</span>( nout, fmt = 9985 ) j</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;   50   <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        <span class="keyword">CALL </span>blacs_gridexit( ictxt )</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;   60 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment">*     Come here, if error and &quot;Stop On Failure&quot;</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;   70 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment">*     Before printing out final stats, add TSKIP to all skips</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      <span class="keywordflow">DO</span> 80 i = 1, nsubs</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;         <span class="keywordflow">IF</span>( ltest( i ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            kskip( i ) = kskip( i ) + tskip</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            ktests( i ) = kskip( i ) + kfail( i ) + kpass( i )</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;   80 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">*     Print results</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <span class="keywordflow">IF</span>( iam.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = * )</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = 9981 )</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = * )</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = 9983 )</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = 9982 )</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;         <span class="keywordflow">DO</span> 90 i = 1, nsubs</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            <span class="keyword">WRITE</span>( nout, fmt = 9984 ) <span class="stringliteral">&#39;|&#39;</span>, snames( i ), ktests( i ),</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;     $                                kpass( i ), kfail( i ), kskip( i )</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;   90    <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = * )</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = 9980 )</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = * )</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      <span class="keyword">CALL </span>blacs_exit( 0 )</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; 9999 <span class="keyword">FORMAT</span>( <span class="stringliteral">&#39;ILLEGAL &#39;</span>, a, <span class="stringliteral">&#39;: &#39;</span>, a, <span class="stringliteral">&#39; = &#39;</span>, i10,</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;     $        <span class="stringliteral">&#39; should be at least 1&#39;</span> )</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160; 9998 <span class="keyword">FORMAT</span>( <span class="stringliteral">&#39;ILLEGAL GRID: NPROW*NPCOL = &#39;</span>, i4,</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;     $        <span class="stringliteral">&#39;. It can be at most&#39;</span>, i4 )</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; 9997 <span class="keyword">FORMAT</span>( <span class="stringliteral">&#39;Bad &#39;</span>, a, <span class="stringliteral">&#39; parameters: going on to next test case.&#39;</span> )</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; 9996 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;Test number &#39;</span>, i4 , <span class="stringliteral">&#39; started on a &#39;</span>, i6, <span class="stringliteral">&#39; x &#39;</span>,</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;     $        i6, <span class="stringliteral">&#39; process grid.&#39;</span> )</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; 9995 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;---------------------------------------------------&#39;</span>,</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;     $        <span class="stringliteral">&#39;--------------------------&#39;</span> )</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; 9994 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;     N     IX     JX     MX     NX  IMBX  INBX&#39;</span>,</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;     $        <span class="stringliteral">&#39;   MBX   NBX RSRCX CSRCX   INCX&#39;</span> )</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; 9993 <span class="keyword">FORMAT</span>( 2x,i6,1x,i6,1x,i6,1x,i6,1x,i6,1x,i5,1x,i5,1x,i5,1x,i5,1x,</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;     $        i5,1x,i5,1x,i6 )</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; 9992 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;     N     IY     JY     MY     NY  IMBY  INBY&#39;</span>,</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;     $        <span class="stringliteral">&#39;   MBY   NBY RSRCY CSRCY   INCY&#39;</span> )</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; 9991 <span class="keyword">FORMAT</span>( <span class="stringliteral">&#39;Not enough memory for this test: going on to&#39;</span>,</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;     $        <span class="stringliteral">&#39; next test case.&#39;</span> )</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; 9990 <span class="keyword">FORMAT</span>( <span class="stringliteral">&#39;Not enough memory. Need: &#39;</span>, i12 )</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160; 9989 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;   Tested Subroutine: &#39;</span>, a )</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160; 9988 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;   ***** Computational check: &#39;</span>, a, <span class="stringliteral">&#39;       &#39;</span>,</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;     $        <span class="stringliteral">&#39; FAILED &#39;</span>,<span class="stringliteral">&#39; *****&#39;</span> )</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160; 9987 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;   ***** Computational check: &#39;</span>, a, <span class="stringliteral">&#39;       &#39;</span>,</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;     $        <span class="stringliteral">&#39; PASSED &#39;</span>,<span class="stringliteral">&#39; *****&#39;</span> )</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; 9986 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;   ***** ERROR ***** Matrix operand &#39;</span>, a,</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;     $        <span class="stringliteral">&#39; modified by &#39;</span>, a, <span class="stringliteral">&#39; *****&#39;</span> )</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; 9985 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;Test number &#39;</span>, i4, <span class="stringliteral">&#39; completed.&#39;</span> )</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; 9984 <span class="keyword">FORMAT</span>( 2x,a1,2x,a7,8x,i4,6x,i4,5x,i4,4x,i4 )</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; 9983 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;   SUBROUTINE  TOTAL TESTS  PASSED   FAILED  &#39;</span>,</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;     $        <span class="stringliteral">&#39;SKIPPED&#39;</span> )</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; 9982 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;   ----------  -----------  ------   ------  &#39;</span>,</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;     $        <span class="stringliteral">&#39;-------&#39;</span> )</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160; 9981 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;Testing Summary&#39;</span>)</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; 9980 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;End of Tests.&#39;</span> )</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160; 9979 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;Tests started.&#39;</span> )</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; 9978 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;   ***** Operation not supported, error code: &#39;</span>,</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;     $        i5, <span class="stringliteral">&#39; *****&#39;</span> )</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      stop</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment">*     End of PSBLA1TST</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      <span class="keyword">SUBROUTINE </span><a class="code" href="../../d4/d6d/psblas1tst_8f.html#ad2436bcddc0ca469999b3187b2c8304b">psbla1tstinfo</a>( SUMMRY, NOUT, NMAT, NVAL, MXVAL,</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;     $                          NXVAL, IMBXVAL, MBXVAL, INBXVAL,</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;     $                          NBXVAL, RSCXVAL, CSCXVAL, IXVAL,</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;     $                          JXVAL, INCXVAL, MYVAL, NYVAL, IMBYVAL,</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;     $                          MBYVAL, INBYVAL, NBYVAL, RSCYVAL,</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;     $                          CSCYVAL, IYVAL, JYVAL, INCYVAL,</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;     $                          LDVAL, NGRIDS, PVAL, LDPVAL, QVAL,</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;     $                          LDQVAL, LTEST, SOF, TEE, IAM, IGAP,</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;     $                          IVERB, NPROCS, ALPHA, WORK )</div>
<div class="line"><a name="l00777"></a><span class="lineno"><a class="line" href="../../d4/d6d/psblas1tst_8f.html#ad2436bcddc0ca469999b3187b2c8304b">  777</a></span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment">*  -- PBLAS test routine (version 2.0) --</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">*     University of Tennessee, Knoxville, Oak Ridge National Laboratory,</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment">*     and University of California, Berkeley.</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment">*     April 1, 1998</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment">*     .. Scalar Arguments ..</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      <span class="keywordtype">LOGICAL</span>            SOF, TEE</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      <span class="keywordtype">INTEGER</span>            IAM, IGAP, IVERB, LDPVAL, LDQVAL, LDVAL,</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;     $                   NGRIDS, NMAT, NOUT, NPROCS</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      <span class="keywordtype">REAL</span>               ALPHA</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment">*     .. Array Arguments ..</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      <span class="keywordtype">CHARACTER*( * )</span>    SUMMRY</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      <span class="keywordtype">LOGICAL</span>            LTEST( * )</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      <span class="keywordtype">INTEGER</span>            CSCXVAL( LDVAL ), CSCYVAL( LDVAL ),</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;     $                   imbxval( ldval ), imbyval( ldval ),</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;     $                   inbxval( ldval ), inbyval( ldval ),</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;     $                   incxval( ldval ), incyval( ldval ),</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;     $                   ixval( ldval ), iyval( ldval ), jxval( ldval ),</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;     $                   jyval( ldval ), mbxval( ldval ),</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;     $                   mbyval( ldval ), mxval( ldval ),</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;     $                   myval( ldval ), nbxval( ldval ),</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;     $                   nbyval( ldval ), nval( ldval ), nxval( ldval ),</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;     $                   nyval( ldval ), pval( ldpval ), qval( ldqval ),</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;     $                   rscxval( ldval ), rscyval( ldval ), work( * )</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment">*  Purpose</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment">*  =======</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="comment">*  PSBLA1TSTINFO  get the needed startup information for testing various</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment">*  Level 1 PBLAS routines, and transmits it to all processes.</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment">*  Notes</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment">*  =====</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment">*  For packing the information we assumed that the length in bytes of an</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">*  integer is equal to the length in bytes of a real single precision.</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">*  Arguments</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">*  =========</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment">*  SUMMRY  (global output) CHARACTER*(*)</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment">*          On  exit,  SUMMRY  is  the  name of output (summary) file (if</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment">*          any). SUMMRY is only defined for process 0.</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">*  NOUT    (global output) INTEGER</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment">*          On exit, NOUT  specifies the unit number for the output file.</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment">*          When NOUT is 6, output to screen,  when  NOUT is 0, output to</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment">*          stderr. NOUT is only defined for process 0.</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment">*  NMAT    (global output) INTEGER</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment">*          On exit,  NMAT  specifies the number of different test cases.</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment">*  NVAL    (global output) INTEGER array</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment">*          On entry, NVAL is an array of dimension LDVAL.  On exit, this</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment">*          array contains the values of N to run the code with.</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment">*  MXVAL   (global output) INTEGER array</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment">*          On entry, MXVAL is an array of dimension LDVAL. On exit, this</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment">*          array  contains  the values  of  DESCX( M_ )  to run the code</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment">*          with.</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment">*  NXVAL   (global output) INTEGER array</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment">*          On entry, NXVAL is an array of dimension LDVAL. On exit, this</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="comment">*          array  contains  the values  of  DESCX( N_ )  to run the code</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment">*          with.</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment">*  IMBXVAL (global output) INTEGER array</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment">*          On entry,  IMBXVAL  is an array of  dimension LDVAL. On exit,</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment">*          this  array  contains  the values of DESCX( IMB_ ) to run the</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment">*          code with.</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment">*  MBXVAL  (global output) INTEGER array</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment">*          On entry,  MBXVAL  is an array of  dimension  LDVAL. On exit,</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment">*          this  array  contains  the values of DESCX( MB_ ) to  run the</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment">*          code with.</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment">*  INBXVAL (global output) INTEGER array</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="comment">*          On entry,  INBXVAL  is an array of  dimension LDVAL. On exit,</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment">*          this  array  contains  the values of DESCX( INB_ ) to run the</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment">*          code with.</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment">*  NBXVAL  (global output) INTEGER array</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="comment">*          On entry,  NBXVAL  is an array of  dimension  LDVAL. On exit,</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">*          this  array  contains  the values of DESCX( NB_ ) to  run the</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment">*          code with.</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment">*  RSCXVAL (global output) INTEGER array</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="comment">*          On entry, RSCXVAL  is an array of  dimension  LDVAL. On exit,</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="comment">*          this  array  contains the values of DESCX( RSRC_ ) to run the</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment">*          code with.</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment">*  CSCXVAL (global output) INTEGER array</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment">*          On entry, CSCXVAL  is an array of  dimension  LDVAL. On exit,</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment">*          this  array  contains the values of DESCX( CSRC_ ) to run the</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment">*          code with.</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="comment">*  IXVAL   (global output) INTEGER array</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="comment">*          On entry, IXVAL is an array of dimension LDVAL. On exit, this</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment">*          array  contains the values of IX to run the code with.</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment">*  JXVAL   (global output) INTEGER array</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">*          On entry, JXVAL is an array of dimension LDVAL. On exit, this</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">*          array  contains the values of JX to run the code with.</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment">*  INCXVAL (global output) INTEGER array</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment">*          On entry,  INCXVAL  is  an array of dimension LDVAL. On exit,</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment">*          this array  contains the values of INCX to run the code with.</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">*  MYVAL   (global output) INTEGER array</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment">*          On entry, MYVAL is an array of dimension LDVAL. On exit, this</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment">*          array  contains  the values  of  DESCY( M_ )  to run the code</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="comment">*          with.</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment">*  NYVAL   (global output) INTEGER array</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment">*          On entry, NYVAL is an array of dimension LDVAL. On exit, this</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment">*          array  contains  the values  of  DESCY( N_ )  to run the code</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment">*          with.</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="comment">*  IMBYVAL (global output) INTEGER array</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment">*          On entry,  IMBYVAL  is an array of  dimension LDVAL. On exit,</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment">*          this  array  contains  the values of DESCY( IMB_ ) to run the</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment">*          code with.</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="comment">*  MBYVAL  (global output) INTEGER array</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment">*          On entry,  MBYVAL  is an array of  dimension  LDVAL. On exit,</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="comment">*          this  array  contains  the values of DESCY( MB_ ) to  run the</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="comment">*          code with.</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment">*  INBYVAL (global output) INTEGER array</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="comment">*          On entry,  INBYVAL  is an array of  dimension LDVAL. On exit,</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment">*          this  array  contains  the values of DESCY( INB_ ) to run the</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="comment">*          code with.</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="comment">*  NBYVAL  (global output) INTEGER array</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment">*          On entry,  NBYVAL  is an array of  dimension  LDVAL. On exit,</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment">*          this  array  contains  the values of DESCY( NB_ ) to  run the</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">*          code with.</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">*  RSCYVAL (global output) INTEGER array</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment">*          On entry, RSCYVAL  is an array of  dimension  LDVAL. On exit,</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="comment">*          this  array  contains the values of DESCY( RSRC_ ) to run the</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="comment">*          code with.</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="comment">*  CSCYVAL (global output) INTEGER array</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="comment">*          On entry, CSCYVAL  is an array of  dimension  LDVAL. On exit,</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="comment">*          this  array  contains the values of DESCY( CSRC_ ) to run the</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment">*          code with.</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment">*  IYVAL   (global output) INTEGER array</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment">*          On entry, IYVAL is an array of dimension LDVAL. On exit, this</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment">*          array  contains the values of IY to run the code with.</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment">*  JYVAL   (global output) INTEGER array</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="comment">*          On entry, JYVAL is an array of dimension LDVAL. On exit, this</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment">*          array  contains the values of JY to run the code with.</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="comment">*  INCYVAL (global output) INTEGER array</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="comment">*          On entry,  INCYVAL  is  an array of dimension LDVAL. On exit,</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="comment">*          this array  contains the values of INCY to run the code with.</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment">*  LDVAL   (global input) INTEGER</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">*          On entry, LDVAL specifies the maximum number of different va-</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">*          lues that can be used for  DESCX(:),  IX, JX, INCX, DESCY(:),</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">*          IY,  JY  and  INCY.  This  is also the maximum number of test</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">*          cases.</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">*  NGRIDS  (global output) INTEGER</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">*          On exit, NGRIDS specifies the number of different values that</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">*          can be used for P and Q.</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">*  PVAL    (global output) INTEGER array</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment">*          On entry, PVAL is an array of dimension LDPVAL. On exit, this</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="comment">*          array contains the values of P to run the code with.</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="comment">*  LDPVAL  (global input) INTEGER</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="comment">*          On entry,  LDPVAL  specifies  the maximum number of different</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment">*          values that can be used for P.</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">*  QVAL    (global output) INTEGER array</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">*          On entry, QVAL is an array of dimension LDQVAL. On exit, this</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment">*          array contains the values of Q to run the code with.</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment">*  LDQVAL  (global input) INTEGER</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment">*          On entry,  LDQVAL  specifies  the maximum number of different</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="comment">*          values that can be used for Q.</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="comment">*  LTEST   (global output) LOGICAL array</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="comment">*          On entry,  LTEST  is an array of dimension at least eight. On</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment">*          exit, if LTEST( i ) is .TRUE., the i-th Level 1 PBLAS routine</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment">*          will be tested.  See  the  input file for the ordering of the</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment">*          routines.</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="comment">*  SOF     (global output) LOGICAL</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment">*          On exit, if SOF is .TRUE., the tester will  stop on the first</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="comment">*          detected failure. Otherwise, it won&#39;t.</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment">*  TEE     (global output) LOGICAL</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment">*          On exit, if TEE is .TRUE., the tester will  perform the error</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment">*          exit tests. These tests won&#39;t be performed otherwise.</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment">*  IAM     (local input) INTEGER</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment">*          On entry,  IAM  specifies the number of the process executing</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">*          this routine.</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment">*  IGAP    (global output) INTEGER</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment">*          On exit, IGAP  specifies the user-specified gap used for pad-</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment">*          ding. IGAP must be at least zero.</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment">*  IVERB   (global output) INTEGER</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment">*          On exit,  IVERB  specifies  the output verbosity level: 0 for</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment">*          pass/fail, 1, 2 or 3 for matrix dump on errors.</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment">*  NPROCS  (global input) INTEGER</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment">*          On entry, NPROCS specifies the total number of processes.</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="comment">*  ALPHA   (global output) REAL</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="comment">*          On exit, ALPHA specifies the value of alpha to be used in all</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment">*          the test cases.</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment">*  WORK    (local workspace) INTEGER array</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment">*          On   entry,   WORK   is   an  array  of  dimension  at  least</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">*          MAX( 2, 2*NGRIDS+23*NMAT+NSUBS+4 )  with  NSUBS  equal  to 8.</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">*          This array is used to pack all output arrays in order to send</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment">*          the information in one message.</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">*  -- Written on April 1, 1998 by</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">*     Antoine Petitet, University  of  Tennessee, Knoxville 37996, USA.</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment">*  =====================================================================</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment">*     .. Parameters ..</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;      <span class="keywordtype">INTEGER</span>            NIN, NSUBS</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      <span class="keywordtype">PARAMETER</span>          ( NIN = 11, nsubs = 8 )</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment">*     .. Local Scalars ..</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      <span class="keywordtype">LOGICAL</span>            LTESTT</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      <span class="keywordtype">INTEGER</span>            I, ICTXT, J</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      <span class="keywordtype">REAL</span>               EPS</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment">*     .. Local Arrays ..</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      <span class="keywordtype">CHARACTER*7</span>        SNAMET</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      <span class="keywordtype">CHARACTER*79</span>       USRINFO</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment">*     .. External Subroutines ..</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;      <span class="keywordtype">EXTERNAL</span>           blacs_abort, blacs_get, blacs_gridexit,</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;     $                   blacs_gridinit, blacs_setup, <a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>, igebr2d,</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;     $                   igebs2d, sgebr2d, sgebs2d</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">*     .. External Functions ..</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="keywordtype">      REAL</span>               PSLAMCH</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;      <span class="keywordtype">EXTERNAL</span>           PSLAMCH</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment">*     .. Intrinsic Functions ..</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;      <span class="keywordtype">INTRINSIC</span>          <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>, <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment">*     .. Common Blocks ..</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      <span class="keywordtype">CHARACTER*7</span>        SNAMES( NSUBS )</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      <span class="keyword">COMMON</span>             /snamec/snames</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment">*     .. Executable Statements ..</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment">*     Process 0 reads the input data, broadcasts to other processes and</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment">*     writes needed information to NOUT</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;      <span class="keywordflow">IF</span>( iam.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment">*        Open file and skip data file header</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;         <span class="keyword">OPEN</span>( nin, file=<span class="stringliteral">&#39;PSBLAS1TST.dat&#39;</span>, status=<span class="stringliteral">&#39;OLD&#39;</span> )</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) summry</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;         summry = <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="comment">*        Read in user-supplied info about machine type, compiler, etc.</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;         <span class="keyword">READ</span>( nin, fmt = 9999 ) usrinfo</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment">*        Read name and unit number for summary output file</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) summry</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) nout</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;         <span class="keywordflow">IF</span>( nout.NE.0 .AND. nout.NE.6 )</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;     $      <span class="keyword">OPEN</span>( nout, file = summry, status = <span class="stringliteral">&#39;UNKNOWN&#39;</span> )</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="comment">*        Read and check the parameter values for the tests.</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="comment">*        Read the flag that indicates if Stop on Failure</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) sof</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="comment">*        Read the flag that indicates if Test Error Exits</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) tee</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="comment">*        Read the verbosity level</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) iverb</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;         <span class="keywordflow">IF</span>( iverb.LT.0 .OR. iverb.GT.3 )</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;     $      iverb = 0</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="comment">*        Read the leading dimension gap</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) igap</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;         <span class="keywordflow">IF</span>( igap.LT.0 )</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;     $      igap = 0</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="comment">*        Get number of grids</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) ngrids</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;         <span class="keywordflow">IF</span>( ngrids.LT.1 .OR. ngrids.GT.ldpval ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            <span class="keyword">WRITE</span>( nout, fmt = 9998 ) <span class="stringliteral">&#39;Grids&#39;</span>, ldpval</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;            <span class="keywordflow">GO TO</span> 100</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( ngrids.GT.ldqval ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;            <span class="keyword">WRITE</span>( nout, fmt = 9998 ) <span class="stringliteral">&#39;Grids&#39;</span>, ldqval</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;            <span class="keywordflow">GO TO</span> 100</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">*        Get values of P and Q</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) ( pval( i ), i = 1, ngrids )</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) ( qval( i ), i = 1, ngrids )</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment">*        Read ALPHA</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) alpha</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="comment">*        Read number of tests.</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) nmat</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;         <span class="keywordflow">IF</span>( nmat.LT.1 .OR. nmat.GT.ldval ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;            <span class="keyword">WRITE</span>( nout, fmt = 9998 ) <span class="stringliteral">&#39;Tests&#39;</span>, ldval</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;            <span class="keywordflow">GO TO</span> 100</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="comment">*        Read in input data into arrays.</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) ( nval( i ),     i = 1, nmat )</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) ( mxval( i ),    i = 1, nmat )</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) ( nxval( i ),    i = 1, nmat )</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) ( imbxval( i ),  i = 1, nmat )</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) ( inbxval( i ),  i = 1, nmat )</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) ( mbxval( i ),   i = 1, nmat )</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) ( nbxval( i ),   i = 1, nmat )</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) ( rscxval( i ),  i = 1, nmat )</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) ( cscxval( i ),  i = 1, nmat )</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) ( ixval( i ),    i = 1, nmat )</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) ( jxval( i ),    i = 1, nmat )</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) ( incxval( i ),  i = 1, nmat )</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) ( myval( i ),    i = 1, nmat )</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) ( nyval( i ),    i = 1, nmat )</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) ( imbyval( i ),  i = 1, nmat )</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) ( inbyval( i ),  i = 1, nmat )</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) ( mbyval( i ),   i = 1, nmat )</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) ( nbyval( i ),   i = 1, nmat )</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) ( rscyval( i ),  i = 1, nmat )</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) ( cscyval( i ),  i = 1, nmat )</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) ( iyval( i ),    i = 1, nmat )</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) ( jyval( i ),    i = 1, nmat )</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;         <span class="keyword">READ</span>( nin, fmt = * ) ( incyval( i ),  i = 1, nmat )</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="comment">*        Read names of subroutines and flags which indicate</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="comment">*        whether they are to be tested.</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;         <span class="keywordflow">DO</span> 10 i = 1, nsubs</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;            ltest( i ) = .false.</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;   10    <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;   20    <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;         <span class="keyword">READ</span>( nin, fmt = 9996, <span class="keyword">END </span>= 50 ) SNAMET, ltestt</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;         <span class="keywordflow">DO</span> 30 i = 1, nsubs</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;            <span class="keywordflow">IF</span>( snamet.EQ.snames( i ) )</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;     $         <span class="keywordflow">GO TO</span> 40</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;   30    <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = 9995 )snamet</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;         <span class="keywordflow">GO TO</span> 100</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;   40    <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;         ltest( i ) = ltestt</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;         <span class="keywordflow">GO TO</span> 20</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;   50    <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="comment">*        Close input file</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;         <span class="keyword">CLOSE</span> ( nin )</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="comment">*        For pvm only: if virtual machine not set up, allocate it and</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="comment">*        spawn the correct number of processes.</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;         <span class="keywordflow">IF</span>( nprocs.LT.1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;            nprocs = 0</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;            <span class="keywordflow">DO</span> 60 i = 1, ngrids</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;               nprocs = <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( nprocs, pval( i )*qval( i ) )</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;   60       <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;            <span class="keyword">CALL </span>blacs_setup( iam, nprocs )</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="comment">*        Temporarily define blacs grid to include all processes so</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="comment">*        information can be broadcast to all processes</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;         <span class="keyword">CALL </span>blacs_get( -1, 0, ictxt )</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;         <span class="keyword">CALL </span>blacs_gridinit( ictxt, <span class="stringliteral">&#39;Row-major&#39;</span>, 1, nprocs )</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="comment">*        Compute machine epsilon</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;         eps = <a class="code" href="../../d0/de4/pcblastst_8f.html#a3df12c2b4e5880f14763677d8d8136cb">pslamch</a>( ictxt, <span class="stringliteral">&#39;eps&#39;</span> )</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="comment">*        Pack information arrays and broadcast</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;         <span class="keyword">CALL </span>sgebs2d( ictxt, <span class="stringliteral">&#39;All&#39;</span>, <span class="stringliteral">&#39; &#39;</span>, 1, 1, alpha, 1 )</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;         work( 1 ) = ngrids</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;         work( 2 ) = nmat</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;         <span class="keyword">CALL </span>igebs2d( ictxt, <span class="stringliteral">&#39;All&#39;</span>, <span class="stringliteral">&#39; &#39;</span>, 2, 1, work, 2 )</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;         i = 1</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;         <span class="keywordflow">IF</span>( sof ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;            work( i ) = 1</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;         <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;            work( i ) = 0</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;         i = i + 1</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;         <span class="keywordflow">IF</span>( tee ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;            work( i ) = 1</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;         <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;            work( i ) = 0</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;         i = i + 1</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;         work( i ) = iverb</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;         i = i + 1</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;         work( i ) = igap</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;         i = i + 1</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( ngrids, pval,     1, work( i ), 1 )</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;         i = i + ngrids</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( ngrids, qval,     1, work( i ), 1 )</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;         i = i + ngrids</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   nval,     1, work( i ), 1 )</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   mxval,    1, work( i ), 1 )</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   nxval,    1, work( i ), 1 )</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   imbxval,  1, work( i ), 1 )</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   inbxval,  1, work( i ), 1 )</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   mbxval,   1, work( i ), 1 )</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   nbxval,   1, work( i ), 1 )</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   rscxval,  1, work( i ), 1 )</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   cscxval,  1, work( i ), 1 )</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   ixval,    1, work( i ), 1 )</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   jxval,    1, work( i ), 1 )</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   incxval,  1, work( i ), 1 )</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   myval,    1, work( i ), 1 )</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   nyval,    1, work( i ), 1 )</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   imbyval,  1, work( i ), 1 )</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   inbyval,  1, work( i ), 1 )</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   mbyval,   1, work( i ), 1 )</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   nbyval,   1, work( i ), 1 )</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   rscyval,  1, work( i ), 1 )</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   cscyval,  1, work( i ), 1 )</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   iyval,    1, work( i ), 1 )</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   jyval,    1, work( i ), 1 )</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   incyval,  1, work( i ), 1 )</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;         <span class="keywordflow">DO</span> 70 j = 1, nsubs</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;            <span class="keywordflow">IF</span>( ltest( j ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;               work( i ) = 1</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;               work( i ) = 0</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;            i = i + 1</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;   70    <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;         i = i - 1</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;         <span class="keyword">CALL </span>igebs2d( ictxt, <span class="stringliteral">&#39;All&#39;</span>, <span class="stringliteral">&#39; &#39;</span>, i, 1, work, i )</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="comment">*        regurgitate input</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = 9999 ) <span class="stringliteral">&#39;Level 1 PBLAS testing program.&#39;</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = 9999 ) usrinfo</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = * )</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = 9999 )</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;     $               <span class="stringliteral">&#39;Tests of the real single precision &#39;</span>//</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;     $               <span class="stringliteral">&#39;Level 1 PBLAS&#39;</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = * )</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = 9999 )</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;     $               <span class="stringliteral">&#39;The following parameter values will be used:&#39;</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = * )</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = 9993 ) nmat</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = 9992 ) ngrids</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = 9990 )</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;     $               <span class="stringliteral">&#39;P&#39;</span>, ( pval(i), i = 1, <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>(ngrids, 5) )</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;         <span class="keywordflow">IF</span>( ngrids.GT.5 )</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;     $      <span class="keyword">WRITE</span>( nout, fmt = 9991 ) ( pval(i), i = 6,</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;     $                                  <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( 10, ngrids ) )</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;         <span class="keywordflow">IF</span>( ngrids.GT.10 )</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;     $      <span class="keyword">WRITE</span>( nout, fmt = 9991 ) ( pval(i), i = 11,</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;     $                                  <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( 15, ngrids ) )</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;         <span class="keywordflow">IF</span>( ngrids.GT.15 )</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;     $      <span class="keyword">WRITE</span>( nout, fmt = 9991 ) ( pval(i), i = 16, ngrids )</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = 9990 )</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;     $               <span class="stringliteral">&#39;Q&#39;</span>, ( qval(i), i = 1, <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>(ngrids, 5) )</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;         <span class="keywordflow">IF</span>( ngrids.GT.5 )</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;     $      <span class="keyword">WRITE</span>( nout, fmt = 9991 ) ( qval(i), i = 6,</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;     $                                  <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( 10, ngrids ) )</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;         <span class="keywordflow">IF</span>( ngrids.GT.10 )</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;     $      <span class="keyword">WRITE</span>( nout, fmt = 9991 ) ( qval(i), i = 11,</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;     $                                  <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( 15, ngrids ) )</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;         <span class="keywordflow">IF</span>( ngrids.GT.15 )</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;     $      <span class="keyword">WRITE</span>( nout, fmt = 9991 ) ( qval(i), i = 16, ngrids )</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = 9988 ) sof</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = 9987 ) tee</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = 9983 ) igap</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = 9986 ) iverb</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = 9982 ) alpha</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;         <span class="keywordflow">IF</span>( ltest( 1 ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;            <span class="keyword">WRITE</span>( nout, fmt = 9985 ) snames( 1 ), <span class="stringliteral">&#39; ... Yes&#39;</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;         <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;            <span class="keyword">WRITE</span>( nout, fmt = 9985 ) snames( 1 ), <span class="stringliteral">&#39; ... No &#39;</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;         <span class="keywordflow">DO</span> 80 i = 2, nsubs</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;            <span class="keywordflow">IF</span>( ltest( i ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;               <span class="keyword">WRITE</span>( nout, fmt = 9984 ) snames( i ), <span class="stringliteral">&#39; ... Yes&#39;</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;               <span class="keyword">WRITE</span>( nout, fmt = 9984 ) snames( i ), <span class="stringliteral">&#39; ... No &#39;</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;   80    <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = 9994 ) eps</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;         <span class="keyword">WRITE</span>( nout, fmt = * )</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="comment">*        If in pvm, must participate setting up virtual machine</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;         <span class="keywordflow">IF</span>( nprocs.LT.1 )</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;     $      <span class="keyword">CALL </span>blacs_setup( iam, nprocs )</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;<span class="comment">*        Temporarily define blacs grid to include all processes so</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;<span class="comment">*        information can be broadcast to all processes</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;         <span class="keyword">CALL </span>blacs_get( -1, 0, ictxt )</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;         <span class="keyword">CALL </span>blacs_gridinit( ictxt, <span class="stringliteral">&#39;Row-major&#39;</span>, 1, nprocs )</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;<span class="comment">*        Compute machine epsilon</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;         eps = <a class="code" href="../../d0/de4/pcblastst_8f.html#a3df12c2b4e5880f14763677d8d8136cb">pslamch</a>( ictxt, <span class="stringliteral">&#39;eps&#39;</span> )</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;         <span class="keyword">CALL </span>sgebr2d( ictxt, <span class="stringliteral">&#39;All&#39;</span>, <span class="stringliteral">&#39; &#39;</span>, 1, 1, alpha, 1, 0, 0 )</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;         <span class="keyword">CALL </span>igebr2d( ictxt, <span class="stringliteral">&#39;All&#39;</span>, <span class="stringliteral">&#39; &#39;</span>, 2, 1, work, 2, 0, 0 )</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;         ngrids = work( 1 )</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;         nmat   = work( 2 )</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;         i = 2*ngrids + 23*nmat + nsubs + 4</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;         <span class="keyword">CALL </span>igebr2d( ictxt, <span class="stringliteral">&#39;All&#39;</span>, <span class="stringliteral">&#39; &#39;</span>, i, 1, work, i, 0, 0 )</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;         i = 1</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;         <span class="keywordflow">IF</span>( work( i ).EQ.1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;            sof = .true.</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;         <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;            sof = .false.</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;         i = i + 1</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;         <span class="keywordflow">IF</span>( work( i ).EQ.1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;            tee = .true.</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;         <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;            tee = .false.</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;         i = i + 1</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;         iverb = work( i )</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;         i = i + 1</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;         igap = work( i )</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;         i = i + 1</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( ngrids, work( i ), 1, pval,     1 )</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;         i = i + ngrids</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( ngrids, work( i ), 1, qval,     1 )</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;         i = i + ngrids</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   work( i ), 1, nval,     1 )</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   work( i ), 1, mxval,    1 )</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   work( i ), 1, nxval,    1 )</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   work( i ), 1, imbxval,  1 )</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   work( i ), 1, inbxval,  1 )</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   work( i ), 1, mbxval,   1 )</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   work( i ), 1, nbxval,   1 )</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   work( i ), 1, rscxval,  1 )</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   work( i ), 1, cscxval,  1 )</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   work( i ), 1, ixval,    1 )</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   work( i ), 1, jxval,    1 )</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   work( i ), 1, incxval,  1 )</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   work( i ), 1, myval,    1 )</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   work( i ), 1, nyval,    1 )</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   work( i ), 1, imbyval,  1 )</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   work( i ), 1, inbyval,  1 )</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   work( i ), 1, mbyval,   1 )</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   work( i ), 1, nbyval,   1 )</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   work( i ), 1, rscyval,  1 )</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   work( i ), 1, cscyval,  1 )</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   work( i ), 1, iyval,    1 )</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   work( i ), 1, jyval,    1 )</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a>( nmat,   work( i ), 1, incyval,  1 )</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;         i = i + nmat</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;         <span class="keywordflow">DO</span> 90 j = 1, nsubs</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;            <span class="keywordflow">IF</span>( work( i ).EQ.1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;               ltest( j ) = .true.</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;               ltest( j ) = .false.</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;            i = i + 1</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;   90    <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;      <span class="keyword">CALL </span>blacs_gridexit( ictxt )</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;  100 <span class="keyword">WRITE</span>( nout, fmt = 9997 )</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;      <span class="keyword">CLOSE</span>( nin )</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;      <span class="keywordflow">IF</span>( nout.NE.6 .AND. nout.NE.0 )</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;     $   <span class="keyword">CLOSE</span>( nout )</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;      <span class="keyword">CALL </span>blacs_abort( ictxt, 1 )</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;      stop</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160; 9999 <span class="keyword">FORMAT</span>( a )</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160; 9998 <span class="keyword">FORMAT</span>( <span class="stringliteral">&#39; Number of values of &#39;</span>,5a, <span class="stringliteral">&#39; is less than 1 or greater &#39;</span>,</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;     $        <span class="stringliteral">&#39;than &#39;</span>, i2 )</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160; 9997 <span class="keyword">FORMAT</span>( <span class="stringliteral">&#39; Illegal input in file &#39;</span>,40a,<span class="stringliteral">&#39;.  Aborting run.&#39;</span> )</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160; 9996 <span class="keyword">FORMAT</span>( a7, l2 )</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160; 9995 <span class="keyword">FORMAT</span>( <span class="stringliteral">&#39;  Subprogram name &#39;</span>, a7, <span class="stringliteral">&#39; not recognized&#39;</span>,</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;     $        /<span class="stringliteral">&#39; ******* TESTS ABANDONED *******&#39;</span> )</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160; 9994 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;Relative machine precision (eps) is taken to be &#39;</span>,</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;     $        e18.6 )</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160; 9993 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;Number of Tests           : &#39;</span>, i6 )</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160; 9992 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;Number of process grids   : &#39;</span>, i6 )</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160; 9991 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;                          : &#39;</span>, 5i6 )</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160; 9990 <span class="keyword">FORMAT</span>( 2x, a1, <span class="stringliteral">&#39;                         : &#39;</span>, 5i6 )</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160; 9988 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;Stop on failure flag      : &#39;</span>, l6 )</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160; 9987 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;Test for error exits flag : &#39;</span>, l6 )</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160; 9986 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;Verbosity level           : &#39;</span>, i6 )</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160; 9985 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;Routines to be tested     :      &#39;</span>, a, a8 )</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160; 9984 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;                                 &#39;</span>, a, a8 )</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160; 9983 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;Leading dimension gap     : &#39;</span>, i6 )</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160; 9982 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;Alpha                     : &#39;</span>, g16.6 )</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="comment">*     End of PSBLA1TSTINFO</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;      <span class="keyword">SUBROUTINE </span><a class="code" href="../../d4/d6d/psblas1tst_8f.html#aef7dc3dabf5d74e083bda14c3e76cf84">psblas1tstchke</a>( LTEST, INOUT, NPROCS )</div>
<div class="line"><a name="l01469"></a><span class="lineno"><a class="line" href="../../d4/d6d/psblas1tst_8f.html#aef7dc3dabf5d74e083bda14c3e76cf84"> 1469</a></span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;<span class="comment">*  -- PBLAS test routine (version 2.0) --</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;<span class="comment">*     University of Tennessee, Knoxville, Oak Ridge National Laboratory,</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;<span class="comment">*     and University of California, Berkeley.</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;<span class="comment">*     April 1, 1998</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;<span class="comment">*     .. Scalar Arguments ..</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;      <span class="keywordtype">INTEGER</span>            INOUT, NPROCS</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;<span class="comment">*     .. Array Arguments ..</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;      <span class="keywordtype">LOGICAL</span>            LTEST( * )</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;<span class="comment">*  Purpose</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;<span class="comment">*  =======</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;<span class="comment">*  PSBLAS1TSTCHKE tests the error exits of the Level 1 PBLAS.</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;<span class="comment">*  Notes</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;<span class="comment">*  =====</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;<span class="comment">*  A description  vector  is associated with each 2D block-cyclicly dis-</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="comment">*  tributed matrix.  This  vector  stores  the  information  required to</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="comment">*  establish the  mapping  between a  matrix entry and its corresponding</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="comment">*  process and memory location.</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="comment">*  In  the  following  comments,   the character _  should  be  read  as</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<span class="comment">*  &quot;of  the  distributed  matrix&quot;.  Let  A  be a generic term for any 2D</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;<span class="comment">*  block cyclicly distributed matrix.  Its description vector is DESCA:</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;<span class="comment">*  NOTATION         STORED IN       EXPLANATION</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;<span class="comment">*  ---------------- --------------- ------------------------------------</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;<span class="comment">*  DTYPE_A (global) DESCA( DTYPE_ ) The descriptor type.</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;<span class="comment">*  CTXT_A  (global) DESCA( CTXT_  ) The BLACS context handle, indicating</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;<span class="comment">*                                   the NPROW x NPCOL BLACS process grid</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;<span class="comment">*                                   A  is distributed over.  The context</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;<span class="comment">*                                   itself  is  global,  but  the handle</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;<span class="comment">*                                   (the integer value) may vary.</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;<span class="comment">*  M_A     (global) DESCA( M_     ) The  number of rows in the distribu-</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="comment">*                                   ted matrix A, M_A &gt;= 0.</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="comment">*  N_A     (global) DESCA( N_     ) The number of columns in the distri-</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="comment">*                                   buted matrix A, N_A &gt;= 0.</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="comment">*  IMB_A   (global) DESCA( IMB_   ) The number of rows of the upper left</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="comment">*                                   block of the matrix A, IMB_A &gt; 0.</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="comment">*  INB_A   (global) DESCA( INB_   ) The  number  of columns of the upper</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="comment">*                                   left   block   of   the   matrix  A,</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="comment">*                                   INB_A &gt; 0.</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="comment">*  MB_A    (global) DESCA( MB_    ) The blocking factor used to  distri-</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="comment">*                                   bute the last  M_A-IMB_A rows of  A,</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="comment">*                                   MB_A &gt; 0.</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="comment">*  NB_A    (global) DESCA( NB_    ) The blocking factor used to  distri-</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="comment">*                                   bute the last  N_A-INB_A  columns of</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="comment">*                                   A, NB_A &gt; 0.</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="comment">*  RSRC_A  (global) DESCA( RSRC_  ) The process row over which the first</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="comment">*                                   row of the matrix  A is distributed,</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="comment">*                                   NPROW &gt; RSRC_A &gt;= 0.</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="comment">*  CSRC_A  (global) DESCA( CSRC_  ) The  process  column  over which the</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;<span class="comment">*                                   first  column of  A  is distributed.</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="comment">*                                   NPCOL &gt; CSRC_A &gt;= 0.</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;<span class="comment">*  LLD_A   (local)  DESCA( LLD_   ) The  leading  dimension of the local</span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;<span class="comment">*                                   array  storing  the  local blocks of</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="comment">*                                   the distributed matrix A,</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;<span class="comment">*                                   IF( Lc( 1, N_A ) &gt; 0 )</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;<span class="comment">*                                      LLD_A &gt;= MAX( 1, Lr( 1, M_A ) )</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;<span class="comment">*                                   ELSE</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<span class="comment">*                                      LLD_A &gt;= 1.</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="comment">*  Let K be the number of  rows of a matrix A starting at the global in-</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="comment">*  dex IA,i.e, A( IA:IA+K-1, : ). Lr( IA, K ) denotes the number of rows</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;<span class="comment">*  that the process of row coordinate MYROW ( 0 &lt;= MYROW &lt; NPROW ) would</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;<span class="comment">*  receive if these K rows were distributed over NPROW processes.  If  K</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;<span class="comment">*  is the number of columns of a matrix  A  starting at the global index</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;<span class="comment">*  JA, i.e, A( :, JA:JA+K-1, : ), Lc( JA, K ) denotes the number  of co-</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;<span class="comment">*  lumns that the process MYCOL ( 0 &lt;= MYCOL &lt; NPCOL ) would  receive if</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="comment">*  these K columns were distributed over NPCOL processes.</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;<span class="comment">*  The values of Lr() and Lc() may be determined via a call to the func-</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<span class="comment">*  tion PB_NUMROC:</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="comment">*  Lr( IA, K ) = PB_NUMROC( K, IA, IMB_A, MB_A, MYROW, RSRC_A, NPROW )</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="comment">*  Lc( JA, K ) = PB_NUMROC( K, JA, INB_A, NB_A, MYCOL, CSRC_A, NPCOL )</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="comment">*  Arguments</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;<span class="comment">*  =========</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;<span class="comment">*  LTEST   (global input) LOGICAL array</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;<span class="comment">*          On entry, LTEST is an array of dimension at least 8 (NSUBS).</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="comment">*             If LTEST( 1 ) is .TRUE., PSSWAP will be tested;</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;<span class="comment">*             If LTEST( 2 ) is .TRUE., PSSCAL will be tested;</span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<span class="comment">*             If LTEST( 3 ) is .TRUE., PSCOPY will be tested;</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;<span class="comment">*             If LTEST( 4 ) is .TRUE., PSAXPY will be tested;</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="comment">*             If LTEST( 5 ) is .TRUE., PSDOT  will be tested;</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="comment">*             If LTEST( 6 ) is .TRUE., PSNRM2 will be tested;</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="comment">*             If LTEST( 7 ) is .TRUE., PSASUM will be tested;</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="comment">*             If LTEST( 8 ) is .TRUE., PSAMAX will be tested.</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;<span class="comment">*  INOUT   (global input) INTEGER</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;<span class="comment">*          On entry,  INOUT  specifies  the unit number for output file.</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;<span class="comment">*          When INOUT is 6, output to screen,  when INOUT = 0, output to</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="comment">*          stderr. INOUT is only defined in process 0.</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="comment">*  NPROCS  (global input) INTEGER</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="comment">*          On entry, NPROCS specifies the total number of processes cal-</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="comment">*          ling this routine.</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;<span class="comment">*  Calling sequence encodings</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<span class="comment">*  ==========================</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;<span class="comment">*  code Formal argument list                                Examples</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="comment">*  11   (n,      v1,v2)                                     _SWAP, _COPY</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;<span class="comment">*  12   (n,s1,   v1   )                                     _SCAL, _SCAL</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;<span class="comment">*  13   (n,s1,   v1,v2)                                     _AXPY, _DOT_</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;<span class="comment">*  14   (n,s1,i1,v1   )                                     _AMAX</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="comment">*  15   (n,u1,   v1   )                                     _ASUM, _NRM2</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="comment">*  21   (     trans,     m,n,s1,m1,v1,s2,v2)                _GEMV</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;<span class="comment">*  22   (uplo,             n,s1,m1,v1,s2,v2)                _SYMV, _HEMV</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="comment">*  23   (uplo,trans,diag,  n,   m1,v1      )                _TRMV, _TRSV</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;<span class="comment">*  24   (                m,n,s1,v1,v2,m1)                   _GER_</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="comment">*  25   (uplo,             n,s1,v1,   m1)                   _SYR</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;<span class="comment">*  26   (uplo,             n,u1,v1,   m1)                   _HER</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;<span class="comment">*  27   (uplo,             n,s1,v1,v2,m1)                   _SYR2, _HER2</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;<span class="comment">*  31   (          transa,transb,     m,n,k,s1,m1,m2,s2,m3) _GEMM</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;<span class="comment">*  32   (side,uplo,                   m,n,  s1,m1,m2,s2,m3) _SYMM, _HEMM</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;<span class="comment">*  33   (     uplo,trans,               n,k,s1,m1,   s2,m3) _SYRK</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;<span class="comment">*  34   (     uplo,trans,               n,k,u1,m1,   u2,m3) _HERK</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;<span class="comment">*  35   (     uplo,trans,               n,k,s1,m1,m2,s2,m3) _SYR2K</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<span class="comment">*  36   (     uplo,trans,               n,k,s1,m1,m2,u2,m3) _HER2K</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="comment">*  37   (                             m,n,  s1,m1,   s2,m3) _TRAN_</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;<span class="comment">*  38   (side,uplo,transa,       diag,m,n,  s1,m1,m2      ) _TRMM, _TRSM</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;<span class="comment">*  39   (          trans,             m,n,  s1,m1,   s2,m3) _GEADD</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="comment">*  40   (     uplo,trans,             m,n,  s1,m1,   s2,m3) _TRADD</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;<span class="comment">*  -- Written on April 1, 1998 by</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;<span class="comment">*     Antoine Petitet, University  of  Tennessee, Knoxville 37996, USA.</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;<span class="comment">*  =====================================================================</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;<span class="comment">*     .. Parameters ..</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;      <span class="keywordtype">INTEGER</span>            NSUBS</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;      <span class="keywordtype">PARAMETER</span>          ( NSUBS = 8 )</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;<span class="comment">*     .. Local Scalars ..</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;      logical            abrtsav</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;      <span class="keywordtype">INTEGER</span>            I, ICTXT, MYCOL, MYROW, NPCOL, NPROW</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;<span class="comment">*     .. Local Arrays ..</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;      <span class="keywordtype">INTEGER</span>            SCODE( NSUBS )</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;<span class="comment">*     .. External Subroutines ..</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;      <span class="keywordtype">EXTERNAL</span>           blacs_get, blacs_gridexit, blacs_gridinfo,</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;     $                   blacs_gridinit, psamax, psasum, psaxpy, pscopy,</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;     $                   <a class="code" href="../../da/d4c/psblastst_8f.html#a883a03af9ae393fc8e72d1184a4085c0">psdimee</a>, psdot, psnrm2, psscal, psswap,</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;     $                   <a class="code" href="../../da/d4c/psblastst_8f.html#a9f7b11aef3500003b19b2c0045fa294d">psvecee</a></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;<span class="comment">*     .. Common Blocks ..</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;      <span class="keywordtype">LOGICAL</span>            ABRTFLG</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;      <span class="keywordtype">INTEGER</span>            NOUT</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;      <span class="keywordtype">CHARACTER*7</span>        SNAMES( NSUBS )</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;      COMMON             /SNAMEC/SNAMES</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;      COMMON             /PBERRORC/NOUT, ABRTFLG</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;<span class="comment">*     .. Data Statements ..</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;      DATA               SCODE/11, 12, 11, 13, 13, 15, 15, 14/</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;<span class="comment">*     .. Executable Statements ..</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;<span class="comment">*     Temporarily define blacs grid to include all processes so</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;<span class="comment">*     information can be broadcast to all processes.</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;      <span class="keyword">CALL </span>blacs_get( -1, 0, ictxt )</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;      <span class="keyword">CALL </span>blacs_gridinit( ictxt, <span class="stringliteral">&#39;Row-major&#39;</span>, 1, nprocs )</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;      <span class="keyword">CALL </span>blacs_gridinfo( ictxt, nprow, npcol, myrow, mycol )</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;<span class="comment">*     Set ABRTFLG to FALSE so that the PBLAS error handler won&#39;t abort</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;<span class="comment">*     on errors during these tests and set the output device unit for</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;<span class="comment">*     it.</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;      abrtsav = abrtflg</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;      abrtflg = .false.</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;      nout    = inout</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;<span class="comment">*     Test PSSWAP</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;      i = 1</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;      <span class="keywordflow">IF</span>( ltest( i ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a883a03af9ae393fc8e72d1184a4085c0">psdimee</a>( ictxt, nout, psswap, scode( i ), snames( i ) )</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a9f7b11aef3500003b19b2c0045fa294d">psvecee</a>( ictxt, nout, psswap, scode( i ), snames( i ) )</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;<span class="comment">*     Test PSSCAL</span></div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;      i = i + 1</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;      <span class="keywordflow">IF</span>( ltest( i ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a883a03af9ae393fc8e72d1184a4085c0">psdimee</a>( ictxt, nout, psscal, scode( i ), snames( i ) )</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a9f7b11aef3500003b19b2c0045fa294d">psvecee</a>( ictxt, nout, psscal, scode( i ), snames( i ) )</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;<span class="comment">*     Test PSCOPY</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;      i = i + 1</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;      <span class="keywordflow">IF</span>( ltest( i ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a883a03af9ae393fc8e72d1184a4085c0">psdimee</a>( ictxt, nout, pscopy, scode( i ), snames( i ) )</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a9f7b11aef3500003b19b2c0045fa294d">psvecee</a>( ictxt, nout, pscopy, scode( i ), snames( i ) )</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;<span class="comment">*     Test PSAXPY</span></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;      i = i + 1</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;      <span class="keywordflow">IF</span>( ltest( i ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a883a03af9ae393fc8e72d1184a4085c0">psdimee</a>( ictxt, nout, psaxpy, scode( i ), snames( i ) )</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a9f7b11aef3500003b19b2c0045fa294d">psvecee</a>( ictxt, nout, psaxpy, scode( i ), snames( i ) )</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;<span class="comment">*     Test PSDOT</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;      i = i + 1</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;      <span class="keywordflow">IF</span>( ltest( i ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a883a03af9ae393fc8e72d1184a4085c0">psdimee</a>( ictxt, nout, psdot, scode( i ), snames( i ) )</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a9f7b11aef3500003b19b2c0045fa294d">psvecee</a>( ictxt, nout, psdot, scode( i ), snames( i ) )</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;<span class="comment">*     Test PSNRM2</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;      i = i + 1</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;      <span class="keywordflow">IF</span>( ltest( i ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a883a03af9ae393fc8e72d1184a4085c0">psdimee</a>( ictxt, nout, psnrm2, scode( i ), snames( i ) )</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a9f7b11aef3500003b19b2c0045fa294d">psvecee</a>( ictxt, nout, psnrm2, scode( i ), snames( i ) )</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;<span class="comment">*     Test PSASUM</span></div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;      i = i + 1</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;      <span class="keywordflow">IF</span>( ltest( i ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a883a03af9ae393fc8e72d1184a4085c0">psdimee</a>( ictxt, nout, psasum, scode( i ), snames( i ) )</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a9f7b11aef3500003b19b2c0045fa294d">psvecee</a>( ictxt, nout, psasum, scode( i ), snames( i ) )</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;<span class="comment">*     Test PSAMAX</span></div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;      i = i + 1</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;      <span class="keywordflow">IF</span>( ltest( i ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a883a03af9ae393fc8e72d1184a4085c0">psdimee</a>( ictxt, nout, psamax, scode( i ), snames( i ) )</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a9f7b11aef3500003b19b2c0045fa294d">psvecee</a>( ictxt, nout, psamax, scode( i ), snames( i ) )</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;      <span class="keywordflow">IF</span>( myrow.EQ.0 .AND. mycol.EQ.0 )</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;     $   <span class="keyword">WRITE</span>( nout, fmt = 9999 )</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;      <span class="keyword">CALL </span>blacs_gridexit( ictxt )</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;<span class="comment">*     Reset ABRTFLG to the value it had before calling this routine</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;      abrtflg = abrtsav</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160; 9999 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;Error-exit tests completed.&#39;</span> )</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;<span class="comment">*     End of PSBLAS1TSTCHKE</span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;      <span class="keyword">SUBROUTINE </span><a class="code" href="../../d4/d6d/psblas1tst_8f.html#a0e7ba7d1b520a00e8806b2744bda0b66">pschkarg1</a>( ICTXT, NOUT, SNAME, N, ALPHA, IX, JX,</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;     $                      DESCX, INCX, IY, JY, DESCY, INCY, INFO )</div>
<div class="line"><a name="l01734"></a><span class="lineno"><a class="line" href="../../d4/d6d/psblas1tst_8f.html#a0e7ba7d1b520a00e8806b2744bda0b66"> 1734</a></span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;<span class="comment">*  -- PBLAS test routine (version 2.0) --</span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;<span class="comment">*     University of Tennessee, Knoxville, Oak Ridge National Laboratory,</span></div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;<span class="comment">*     and University of California, Berkeley.</span></div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;<span class="comment">*     April 1, 1998</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;<span class="comment">*     .. Scalar Arguments ..</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;      <span class="keywordtype">INTEGER</span>            ICTXT, INCX, INCY, INFO, IX, IY, JX, JY, N,</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;     $                   NOUT</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;      <span class="keywordtype">REAL</span>               ALPHA</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;<span class="comment">*     .. Array Arguments ..</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;      <span class="keywordtype">CHARACTER*(*)</span>      SNAME</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;      <span class="keywordtype">INTEGER</span>            DESCX( * ), DESCY( * )</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="comment">*  Purpose</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;<span class="comment">*  =======</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;<span class="comment">*  PSCHKARG1 checks the input-only arguments of the Level 1 PBLAS.  When</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;<span class="comment">*  INFO = 0, this routine makes a copy of its arguments (which are INPUT</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;<span class="comment">*  only arguments to PBLAS routines). Otherwise, it verifies the  values</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;<span class="comment">*  of these arguments against the saved copies.</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;<span class="comment">*  Notes</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;<span class="comment">*  =====</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;<span class="comment">*  A description  vector  is associated with each 2D block-cyclicly dis-</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;<span class="comment">*  tributed matrix.  This  vector  stores  the  information  required to</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;<span class="comment">*  establish the  mapping  between a  matrix entry and its corresponding</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;<span class="comment">*  process and memory location.</span></div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;<span class="comment">*  In  the  following  comments,   the character _  should  be  read  as</span></div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;<span class="comment">*  &quot;of  the  distributed  matrix&quot;.  Let  A  be a generic term for any 2D</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;<span class="comment">*  block cyclicly distributed matrix.  Its description vector is DESCA:</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;<span class="comment">*  NOTATION         STORED IN       EXPLANATION</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;<span class="comment">*  ---------------- --------------- ------------------------------------</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;<span class="comment">*  DTYPE_A (global) DESCA( DTYPE_ ) The descriptor type.</span></div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;<span class="comment">*  CTXT_A  (global) DESCA( CTXT_  ) The BLACS context handle, indicating</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;<span class="comment">*                                   the NPROW x NPCOL BLACS process grid</span></div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;<span class="comment">*                                   A  is distributed over.  The context</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;<span class="comment">*                                   itself  is  global,  but  the handle</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;<span class="comment">*                                   (the integer value) may vary.</span></div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;<span class="comment">*  M_A     (global) DESCA( M_     ) The  number of rows in the distribu-</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;<span class="comment">*                                   ted matrix A, M_A &gt;= 0.</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;<span class="comment">*  N_A     (global) DESCA( N_     ) The number of columns in the distri-</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;<span class="comment">*                                   buted matrix A, N_A &gt;= 0.</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;<span class="comment">*  IMB_A   (global) DESCA( IMB_   ) The number of rows of the upper left</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;<span class="comment">*                                   block of the matrix A, IMB_A &gt; 0.</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;<span class="comment">*  INB_A   (global) DESCA( INB_   ) The  number  of columns of the upper</span></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;<span class="comment">*                                   left   block   of   the   matrix  A,</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;<span class="comment">*                                   INB_A &gt; 0.</span></div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;<span class="comment">*  MB_A    (global) DESCA( MB_    ) The blocking factor used to  distri-</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;<span class="comment">*                                   bute the last  M_A-IMB_A rows of  A,</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;<span class="comment">*                                   MB_A &gt; 0.</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;<span class="comment">*  NB_A    (global) DESCA( NB_    ) The blocking factor used to  distri-</span></div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;<span class="comment">*                                   bute the last  N_A-INB_A  columns of</span></div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;<span class="comment">*                                   A, NB_A &gt; 0.</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;<span class="comment">*  RSRC_A  (global) DESCA( RSRC_  ) The process row over which the first</span></div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;<span class="comment">*                                   row of the matrix  A is distributed,</span></div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;<span class="comment">*                                   NPROW &gt; RSRC_A &gt;= 0.</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;<span class="comment">*  CSRC_A  (global) DESCA( CSRC_  ) The  process  column  over which the</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;<span class="comment">*                                   first  column of  A  is distributed.</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;<span class="comment">*                                   NPCOL &gt; CSRC_A &gt;= 0.</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;<span class="comment">*  LLD_A   (local)  DESCA( LLD_   ) The  leading  dimension of the local</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;<span class="comment">*                                   array  storing  the  local blocks of</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;<span class="comment">*                                   the distributed matrix A,</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;<span class="comment">*                                   IF( Lc( 1, N_A ) &gt; 0 )</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;<span class="comment">*                                      LLD_A &gt;= MAX( 1, Lr( 1, M_A ) )</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;<span class="comment">*                                   ELSE</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;<span class="comment">*                                      LLD_A &gt;= 1.</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;<span class="comment">*  Let K be the number of  rows of a matrix A starting at the global in-</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;<span class="comment">*  dex IA,i.e, A( IA:IA+K-1, : ). Lr( IA, K ) denotes the number of rows</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;<span class="comment">*  that the process of row coordinate MYROW ( 0 &lt;= MYROW &lt; NPROW ) would</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;<span class="comment">*  receive if these K rows were distributed over NPROW processes.  If  K</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;<span class="comment">*  is the number of columns of a matrix  A  starting at the global index</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;<span class="comment">*  JA, i.e, A( :, JA:JA+K-1, : ), Lc( JA, K ) denotes the number  of co-</span></div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;<span class="comment">*  lumns that the process MYCOL ( 0 &lt;= MYCOL &lt; NPCOL ) would  receive if</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;<span class="comment">*  these K columns were distributed over NPCOL processes.</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;<span class="comment">*  The values of Lr() and Lc() may be determined via a call to the func-</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;<span class="comment">*  tion PB_NUMROC:</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;<span class="comment">*  Lr( IA, K ) = PB_NUMROC( K, IA, IMB_A, MB_A, MYROW, RSRC_A, NPROW )</span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;<span class="comment">*  Lc( JA, K ) = PB_NUMROC( K, JA, INB_A, NB_A, MYCOL, CSRC_A, NPCOL )</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;<span class="comment">*  Arguments</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;<span class="comment">*  =========</span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;<span class="comment">*  ICTXT   (local input) INTEGER</span></div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;<span class="comment">*          On entry,  ICTXT  specifies the BLACS context handle, indica-</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;<span class="comment">*          ting the global  context of the operation. The context itself</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;<span class="comment">*          is global, but the value of ICTXT is local.</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;<span class="comment">*  NOUT    (global input) INTEGER</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;<span class="comment">*          On entry, NOUT specifies the unit number for the output file.</span></div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;<span class="comment">*          When NOUT is 6, output to screen,  when  NOUT is 0, output to</span></div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;<span class="comment">*          stderr. NOUT is only defined for process 0.</span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;<span class="comment">*  SNAME   (global input) CHARACTER*(*)</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;<span class="comment">*          On entry, SNAME specifies the subroutine  name  calling  this</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;<span class="comment">*          subprogram.</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;<span class="comment">*  N       (global input) INTEGER</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;<span class="comment">*          On entry, N specifies the length of the subvector operands.</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;<span class="comment">*  ALPHA   (global input) REAL</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;<span class="comment">*          On entry, ALPHA specifies the scalar alpha.</span></div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;<span class="comment">*  IX      (global input) INTEGER</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;<span class="comment">*          On entry, IX  specifies X&#39;s global row index, which points to</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;<span class="comment">*          the beginning of the submatrix sub( X ).</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;<span class="comment">*  JX      (global input) INTEGER</span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;<span class="comment">*          On entry, JX  specifies X&#39;s global column index, which points</span></div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;<span class="comment">*          to the beginning of the submatrix sub( X ).</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;<span class="comment">*  DESCX   (global and local input) INTEGER array</span></div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;<span class="comment">*          On entry, DESCX  is an integer array of dimension DLEN_. This</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;<span class="comment">*          is the array descriptor for the matrix X.</span></div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;<span class="comment">*  INCX    (global input) INTEGER</span></div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;<span class="comment">*          On entry,  INCX   specifies  the  global  increment  for  the</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;<span class="comment">*          elements of  X.  Only two values of  INCX   are  supported in</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;<span class="comment">*          this version, namely 1 and M_X. INCX  must not be zero.</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;<span class="comment">*  IY      (global input) INTEGER</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;<span class="comment">*          On entry, IY  specifies Y&#39;s global row index, which points to</span></div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;<span class="comment">*          the beginning of the submatrix sub( Y ).</span></div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;<span class="comment">*  JY      (global input) INTEGER</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;<span class="comment">*          On entry, JY  specifies Y&#39;s global column index, which points</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;<span class="comment">*          to the beginning of the submatrix sub( Y ).</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;<span class="comment">*  DESCY   (global and local input) INTEGER array</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;<span class="comment">*          On entry, DESCY  is an integer array of dimension DLEN_. This</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;<span class="comment">*          is the array descriptor for the matrix Y.</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;<span class="comment">*  INCY    (global input) INTEGER</span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;<span class="comment">*          On entry,  INCY   specifies  the  global  increment  for  the</span></div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;<span class="comment">*          elements of  Y.  Only two values of  INCY   are  supported in</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;<span class="comment">*          this version, namely 1 and M_Y. INCY  must not be zero.</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;<span class="comment">*  INFO    (global input/global output) INTEGER</span></div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;<span class="comment">*          When INFO = 0 on entry, the values of the arguments which are</span></div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;<span class="comment">*          INPUT only arguments to a PBLAS routine are copied into  sta-</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;<span class="comment">*          tic variables and INFO is unchanged on exit.  Otherwise,  the</span></div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;<span class="comment">*          values  of  the  arguments are compared against the saved co-</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;<span class="comment">*          pies. In case no error has been found INFO is zero on return,</span></div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;<span class="comment">*          otherwise it is non zero.</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;<span class="comment">*  -- Written on April 1, 1998 by</span></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;<span class="comment">*     Antoine Petitet, University  of  Tennessee, Knoxville 37996, USA.</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;<span class="comment">*  =====================================================================</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;<span class="comment">*     .. Parameters ..</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;      <span class="keywordtype">INTEGER</span>            BLOCK_CYCLIC_2D_INB, CSRC_, CTXT_, DLEN_,</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;     $                   DTYPE_, IMB_, INB_, LLD_, MB_, M_, NB_, N_,</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;     $                   RSRC_</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;      <span class="keywordtype">PARAMETER</span>          ( BLOCK_CYCLIC_2D_INB = 2, dlen_ = 11,</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;     $                   dtype_ = 1, ctxt_ = 2, m_ = 3, n_ = 4,</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;     $                   imb_ = 5, inb_ = 6, mb_ = 7, nb_ = 8,</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;     $                   rsrc_ = 9, csrc_ = 10, lld_ = 11 )</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;<span class="comment">*     .. Local Scalars ..</span></div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;      <span class="keywordtype">INTEGER</span>            I, INCXREF, INCYREF, IXREF, IYREF, JXREF,</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;     $                   JYREF, MYCOL, MYROW, NPCOL, NPROW, NREF</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;      <span class="keywordtype">REAL</span>               ALPHAREF</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;<span class="comment">*     .. Local Arrays ..</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;      <span class="keywordtype">CHARACTER*15</span>       ARGNAME</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;      <span class="keywordtype">INTEGER</span>            DESCXREF( DLEN_ ), DESCYREF( DLEN_ )</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;<span class="comment">*     .. External Subroutines ..</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;      <span class="keywordtype">EXTERNAL</span>           blacs_gridinfo, igsum2d</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;<span class="comment">*     .. Save Statements ..</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;      <span class="keywordtype">SAVE</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;<span class="comment">*     .. Executable Statements ..</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;<span class="comment">*     Get grid parameters</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;      <span class="keyword">CALL </span>blacs_gridinfo( ictxt, nprow, npcol, myrow, mycol )</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;<span class="comment">*     Check if first call. If yes, then save.</span></div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;      <span class="keywordflow">IF</span>( info.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;         nref = n</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;         ixref = ix</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;         jxref = jx</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;         <span class="keywordflow">DO</span> 10 i = 1, dlen_</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;            descxref( i ) = descx( i )</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;   10    <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;         incxref = incx</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;         iyref = iy</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;         jyref = jy</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;         <span class="keywordflow">DO</span> 20 i = 1, dlen_</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;            descyref( i ) = descy( i )</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;   20    <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;         incyref = incy</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;         alpharef = alpha</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;<span class="comment">*        Test saved args. Return with first mismatch.</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;         argname = <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;         <span class="keywordflow">IF</span>( n.NE.nref ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;N&#39;</span></div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( ix.NE.ixref ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;IX&#39;</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( jx.NE.jxref ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;JX&#39;</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( descx( dtype_ ).NE.descxref( dtype_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;DESCX( DTYPE_ )&#39;</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( descx( m_ ).NE.descxref( m_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;DESCX( M_ )&#39;</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( descx( n_ ).NE.descxref( n_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;DESCX( N_ )&#39;</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( descx( imb_ ).NE.descxref( imb_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;DESCX( IMB_ )&#39;</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( descx( inb_ ).NE.descxref( inb_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;DESCX( INB_ )&#39;</span></div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( descx( mb_ ).NE.descxref( mb_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;DESCX( MB_ )&#39;</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( descx( nb_ ).NE.descxref( nb_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;DESCX( NB_ )&#39;</span></div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( descx( rsrc_ ).NE.descxref( rsrc_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;DESCX( RSRC_ )&#39;</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( descx( csrc_ ).NE.descxref( csrc_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;DESCX( CSRC_ )&#39;</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( descx( ctxt_ ).NE.descxref( ctxt_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;DESCX( CTXT_ )&#39;</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( descx( lld_ ).NE.descxref( lld_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;DESCX( LLD_ )&#39;</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( incx.NE.incxref ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;INCX&#39;</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( iy.NE.iyref ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;IY&#39;</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( jy.NE.jyref ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;JY&#39;</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( descy( dtype_ ).NE.descyref( dtype_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;DESCY( DTYPE_ )&#39;</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( descy( m_ ).NE.descyref( m_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;DESCY( M_ )&#39;</span></div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( descy( n_ ).NE.descyref( n_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;DESCY( N_ )&#39;</span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( descy( imb_ ).NE.descyref( imb_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;DESCY( IMB_ )&#39;</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( descy( inb_ ).NE.descyref( inb_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;DESCY( INB_ )&#39;</span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( descy( mb_ ).NE.descyref( mb_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;DESCY( MB_ )&#39;</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( descy( nb_ ).NE.descyref( nb_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;DESCY( NB_ )&#39;</span></div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( descy( rsrc_ ).NE.descyref( rsrc_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;DESCY( RSRC_ )&#39;</span></div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( descy( csrc_ ).NE.descyref( csrc_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;DESCY( CSRC_ )&#39;</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( descy( ctxt_ ).NE.descyref( ctxt_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;DESCY( CTXT_ )&#39;</span></div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( descy( lld_ ).NE.descyref( lld_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;DESCY( LLD_ )&#39;</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( incy.NE.incyref ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;INCY&#39;</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;         <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( alpha.NE.alpharef ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;            <span class="keyword">WRITE</span>( argname, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;ALPHA&#39;</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;         <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;            info = 0</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;         <span class="keyword">CALL </span>igsum2d( ictxt, <span class="stringliteral">&#39;All&#39;</span>, <span class="stringliteral">&#39; &#39;</span>, 1, 1, info, 1, -1, 0 )</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;         <span class="keywordflow">IF</span>( myrow.EQ.0 .AND. mycol.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;            <span class="keywordflow">IF</span>( info.GT.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;               <span class="keyword">WRITE</span>( nout, fmt = 9999 ) argname, sname</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;               <span class="keyword">WRITE</span>( nout, fmt = 9998 ) sname</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160; 9999 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;   ***** Input-only parameter check: &#39;</span>, a,</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;     $        <span class="stringliteral">&#39; FAILED  changed &#39;</span>, a, <span class="stringliteral">&#39; *****&#39;</span> )</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160; 9998 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;   ***** Input-only parameter check: &#39;</span>, a,</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;     $        <span class="stringliteral">&#39; PASSED  *****&#39;</span> )</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;<span class="comment">*     End of PSCHKARG1</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;      <span class="keyword">LOGICAL </span><span class="keyword">FUNCTION </span><a class="code" href="../../d0/d71/pcblas1tst_8f.html#a125a7571ec3d5cbe5ed3ed583af0a368">pisinscope</a>( ICTXT, N, IX, JX, DESCX, INCX )</div>
<div class="line"><a name="l02034"></a><span class="lineno"><a class="line" href="../../d4/d6d/psblas1tst_8f.html#a125a7571ec3d5cbe5ed3ed583af0a368"> 2034</a></span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;<span class="comment">*  -- PBLAS test routine (version 2.0) --</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;<span class="comment">*     University of Tennessee, Knoxville, Oak Ridge National Laboratory,</span></div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;<span class="comment">*     and University of California, Berkeley.</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;<span class="comment">*     April 1, 1998</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;<span class="comment">*     .. Scalar Arguments ..</span></div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;      <span class="keywordtype">INTEGER</span>            ictxt, incx, ix, jx, n</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;<span class="comment">*     .. Array Arguments ..</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;      <span class="keywordtype">INTEGER</span>            descx( * )</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;<span class="comment">*  Purpose</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;<span class="comment">*  =======</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;<span class="comment">*  PISINSCOPE returns  .TRUE.  if the calling process is in the scope of</span></div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;<span class="comment">*  sub( X ) = X( IX+(JX-1)*DESCX(M_)+(i-1)*INCX ) and  .FALSE.  if it is</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;<span class="comment">*  not.  This  routine is used to determine which processes should check</span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;<span class="comment">*  the answer returned by some Level 1 PBLAS routines.</span></div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;<span class="comment">*  Notes</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;<span class="comment">*  =====</span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;<span class="comment">*  A description  vector  is associated with each 2D block-cyclicly dis-</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;<span class="comment">*  tributed matrix.  This  vector  stores  the  information  required to</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;<span class="comment">*  establish the  mapping  between a  matrix entry and its corresponding</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;<span class="comment">*  process and memory location.</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;<span class="comment">*  In  the  following  comments,   the character _  should  be  read  as</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;<span class="comment">*  &quot;of  the  distributed  matrix&quot;.  Let  A  be a generic term for any 2D</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;<span class="comment">*  block cyclicly distributed matrix.  Its description vector is DESCA:</span></div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;<span class="comment">*  NOTATION         STORED IN       EXPLANATION</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;<span class="comment">*  ---------------- --------------- ------------------------------------</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;<span class="comment">*  DTYPE_A (global) DESCA( DTYPE_ ) The descriptor type.</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;<span class="comment">*  CTXT_A  (global) DESCA( CTXT_  ) The BLACS context handle, indicating</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;<span class="comment">*                                   the NPROW x NPCOL BLACS process grid</span></div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;<span class="comment">*                                   A  is distributed over.  The context</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;<span class="comment">*                                   itself  is  global,  but  the handle</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;<span class="comment">*                                   (the integer value) may vary.</span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;<span class="comment">*  M_A     (global) DESCA( M_     ) The  number of rows in the distribu-</span></div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;<span class="comment">*                                   ted matrix A, M_A &gt;= 0.</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;<span class="comment">*  N_A     (global) DESCA( N_     ) The number of columns in the distri-</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;<span class="comment">*                                   buted matrix A, N_A &gt;= 0.</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;<span class="comment">*  IMB_A   (global) DESCA( IMB_   ) The number of rows of the upper left</span></div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;<span class="comment">*                                   block of the matrix A, IMB_A &gt; 0.</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;<span class="comment">*  INB_A   (global) DESCA( INB_   ) The  number  of columns of the upper</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;<span class="comment">*                                   left   block   of   the   matrix  A,</span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;<span class="comment">*                                   INB_A &gt; 0.</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;<span class="comment">*  MB_A    (global) DESCA( MB_    ) The blocking factor used to  distri-</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;<span class="comment">*                                   bute the last  M_A-IMB_A rows of  A,</span></div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;<span class="comment">*                                   MB_A &gt; 0.</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;<span class="comment">*  NB_A    (global) DESCA( NB_    ) The blocking factor used to  distri-</span></div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;<span class="comment">*                                   bute the last  N_A-INB_A  columns of</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;<span class="comment">*                                   A, NB_A &gt; 0.</span></div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;<span class="comment">*  RSRC_A  (global) DESCA( RSRC_  ) The process row over which the first</span></div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;<span class="comment">*                                   row of the matrix  A is distributed,</span></div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;<span class="comment">*                                   NPROW &gt; RSRC_A &gt;= 0.</span></div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;<span class="comment">*  CSRC_A  (global) DESCA( CSRC_  ) The  process  column  over which the</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;<span class="comment">*                                   first  column of  A  is distributed.</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;<span class="comment">*                                   NPCOL &gt; CSRC_A &gt;= 0.</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;<span class="comment">*  LLD_A   (local)  DESCA( LLD_   ) The  leading  dimension of the local</span></div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;<span class="comment">*                                   array  storing  the  local blocks of</span></div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;<span class="comment">*                                   the distributed matrix A,</span></div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;<span class="comment">*                                   IF( Lc( 1, N_A ) &gt; 0 )</span></div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;<span class="comment">*                                      LLD_A &gt;= MAX( 1, Lr( 1, M_A ) )</span></div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;<span class="comment">*                                   ELSE</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;<span class="comment">*                                      LLD_A &gt;= 1.</span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;<span class="comment">*  Let K be the number of  rows of a matrix A starting at the global in-</span></div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;<span class="comment">*  dex IA,i.e, A( IA:IA+K-1, : ). Lr( IA, K ) denotes the number of rows</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;<span class="comment">*  that the process of row coordinate MYROW ( 0 &lt;= MYROW &lt; NPROW ) would</span></div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;<span class="comment">*  receive if these K rows were distributed over NPROW processes.  If  K</span></div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;<span class="comment">*  is the number of columns of a matrix  A  starting at the global index</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="comment">*  JA, i.e, A( :, JA:JA+K-1, : ), Lc( JA, K ) denotes the number  of co-</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;<span class="comment">*  lumns that the process MYCOL ( 0 &lt;= MYCOL &lt; NPCOL ) would  receive if</span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;<span class="comment">*  these K columns were distributed over NPCOL processes.</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;<span class="comment">*  The values of Lr() and Lc() may be determined via a call to the func-</span></div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;<span class="comment">*  tion PB_NUMROC:</span></div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;<span class="comment">*  Lr( IA, K ) = PB_NUMROC( K, IA, IMB_A, MB_A, MYROW, RSRC_A, NPROW )</span></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;<span class="comment">*  Lc( JA, K ) = PB_NUMROC( K, JA, INB_A, NB_A, MYCOL, CSRC_A, NPCOL )</span></div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;<span class="comment">*  Arguments</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;<span class="comment">*  =========</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;<span class="comment">*  ICTXT   (local input) INTEGER</span></div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;<span class="comment">*          On entry,  ICTXT  specifies the BLACS context handle, indica-</span></div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;<span class="comment">*          ting the global  context of the operation. The context itself</span></div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;<span class="comment">*          is global, but the value of ICTXT is local.</span></div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;<span class="comment">*  N       (global input) INTEGER</span></div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;<span class="comment">*          The length of the subvector sub( X ).</span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;<span class="comment">*  IX      (global input) INTEGER</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;<span class="comment">*          On entry, IX  specifies X&#39;s global row index, which points to</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;<span class="comment">*          the beginning of the submatrix sub( X ).</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;<span class="comment">*  JX      (global input) INTEGER</span></div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;<span class="comment">*          On entry, JX  specifies X&#39;s global column index, which points</span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;<span class="comment">*          to the beginning of the submatrix sub( X ).</span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;<span class="comment">*  DESCX   (global and local input) INTEGER array</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;<span class="comment">*          On entry, DESCX  is an integer array of dimension DLEN_. This</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;<span class="comment">*          is the array descriptor for the matrix X.</span></div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;<span class="comment">*  INCX    (global input) INTEGER</span></div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;<span class="comment">*          On entry,  INCX   specifies  the  global  increment  for  the</span></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;<span class="comment">*          elements of  X.  Only two values of  INCX   are  supported in</span></div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;<span class="comment">*          this version, namely 1 and M_X. INCX  must not be zero.</span></div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;<span class="comment">*  -- Written on April 1, 1998 by</span></div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;<span class="comment">*     Antoine Petitet, University  of  Tennessee, Knoxville 37996, USA.</span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;<span class="comment">*  =====================================================================</span></div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;<span class="comment">*     .. Parameters ..</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;      <span class="keywordtype">INTEGER</span>            block_cyclic_2d_inb, csrc_, ctxt_, dlen_,</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;     $                   dtype_, imb_, inb_, lld_, mb_, m_, nb_, n_,</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;     $                   rsrc_</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;      <span class="keywordtype">PARAMETER</span>          ( block_cyclic_2d_inb = 2, dlen_ = 11,</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;     $                   dtype_ = 1, ctxt_ = 2, m_ = 3, n_ = 4,</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;     $                   imb_ = 5, inb_ = 6, mb_ = 7, nb_ = 8,</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;     $                   rsrc_ = 9, csrc_ = 10, lld_ = 11 )</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;<span class="comment">*     .. Local Scalars ..</span></div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;      <span class="keywordtype">LOGICAL</span>            colrep, rowrep</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;      <span class="keywordtype">INTEGER</span>            iix, ixcol, ixrow, jjx, mycol, myrow, npcol,</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;     $                   nprow</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;<span class="comment">*     .. External Subroutines ..</span></div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;      <span class="keywordtype">EXTERNAL</span>           blacs_gridinfo, <a class="code" href="../../d1/d4b/pblastst_8f.html#a4d223a80a5e1bca7b339a84ffc2ea180">pb_infog2l</a></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;<span class="comment">*     .. Executable Statements ..</span></div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;      <span class="keyword">CALL </span>blacs_gridinfo( ictxt, nprow, npcol, myrow, mycol )</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;      <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a4d223a80a5e1bca7b339a84ffc2ea180">pb_infog2l</a>( ix, jx, descx, nprow, npcol, myrow, mycol,</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;     $                 iix, jjx, ixrow, ixcol )</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;      rowrep = ( ixrow.EQ.-1 )</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;      colrep = ( ixcol.EQ.-1 )</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;      <span class="keywordflow">IF</span>( descx( m_ ).EQ.1 .AND. n.EQ.1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;<span class="comment">*        This is the special case, find process owner of IX, JX, and</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;<span class="comment">*        only this process is the scope.</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;         <a class="code" href="../../d0/d71/pcblas1tst_8f.html#a125a7571ec3d5cbe5ed3ed583af0a368">pisinscope</a> = ( ( ixrow.EQ.myrow .OR. rowrep ) .AND.</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;     $                   ( ixcol.EQ.mycol .OR. colrep ) )</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;         <span class="keywordflow">IF</span>( incx.EQ.descx( m_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;<span class="comment">*           row vector</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;            <a class="code" href="../../d0/d71/pcblas1tst_8f.html#a125a7571ec3d5cbe5ed3ed583af0a368">pisinscope</a> = ( myrow.EQ.ixrow .OR. rowrep )</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;         <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="comment">*           column vector</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;            <a class="code" href="../../d0/d71/pcblas1tst_8f.html#a125a7571ec3d5cbe5ed3ed583af0a368">pisinscope</a> = ( mycol.EQ.ixcol .OR. colrep )</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;<span class="comment">*     End of PISINSCOPE</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;      <span class="keyword">SUBROUTINE </span><a class="code" href="../../d4/d6d/psblas1tst_8f.html#a57554860850376f1ecad2714c22dc91b">psblas1tstchk</a>( ICTXT, NOUT, NROUT, N, PSCLR, PUSCLR,</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;     $                          PISCLR, X, PX, IX, JX, DESCX, INCX, Y,</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;     $                          PY, IY, JY, DESCY, INCY, INFO )</div>
<div class="line"><a name="l02211"></a><span class="lineno"><a class="line" href="../../d4/d6d/psblas1tst_8f.html#a57554860850376f1ecad2714c22dc91b"> 2211</a></span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;<span class="comment">*  -- PBLAS test routine (version 2.0) --</span></div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;<span class="comment">*     University of Tennessee, Knoxville, Oak Ridge National Laboratory,</span></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;<span class="comment">*     and University of California, Berkeley.</span></div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;<span class="comment">*     April 1, 1998</span></div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;<span class="comment">*     .. Scalar Arguments ..</span></div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;      <span class="keywordtype">INTEGER</span>            ICTXT, INCX, INCY, INFO, IX, IY, JX, JY, N,</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;     $                   nout, nrout, pisclr</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;<span class="keywordtype">      REAL</span>               PSCLR, PUSCLR</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;<span class="comment">*     .. Array Arguments ..</span></div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;      <span class="keywordtype">INTEGER</span>            DESCX( * ), DESCY( * )</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;      <span class="keywordtype">REAL</span>               PX( * ), PY( * ), X( * ), Y( * )</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;<span class="comment">*  Purpose</span></div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;<span class="comment">*  =======</span></div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;<span class="comment">*  PSBLAS1TSTCHK performs the computational tests of the Level 1 PBLAS.</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;<span class="comment">*  Notes</span></div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;<span class="comment">*  =====</span></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;<span class="comment">*  A description  vector  is associated with each 2D block-cyclicly dis-</span></div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;<span class="comment">*  tributed matrix.  This  vector  stores  the  information  required to</span></div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;<span class="comment">*  establish the  mapping  between a  matrix entry and its corresponding</span></div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;<span class="comment">*  process and memory location.</span></div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;<span class="comment">*  In  the  following  comments,   the character _  should  be  read  as</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;<span class="comment">*  &quot;of  the  distributed  matrix&quot;.  Let  A  be a generic term for any 2D</span></div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;<span class="comment">*  block cyclicly distributed matrix.  Its description vector is DESCA:</span></div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;<span class="comment">*  NOTATION         STORED IN       EXPLANATION</span></div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;<span class="comment">*  ---------------- --------------- ------------------------------------</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;<span class="comment">*  DTYPE_A (global) DESCA( DTYPE_ ) The descriptor type.</span></div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;<span class="comment">*  CTXT_A  (global) DESCA( CTXT_  ) The BLACS context handle, indicating</span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;<span class="comment">*                                   the NPROW x NPCOL BLACS process grid</span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;<span class="comment">*                                   A  is distributed over.  The context</span></div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;<span class="comment">*                                   itself  is  global,  but  the handle</span></div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;<span class="comment">*                                   (the integer value) may vary.</span></div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;<span class="comment">*  M_A     (global) DESCA( M_     ) The  number of rows in the distribu-</span></div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;<span class="comment">*                                   ted matrix A, M_A &gt;= 0.</span></div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;<span class="comment">*  N_A     (global) DESCA( N_     ) The number of columns in the distri-</span></div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;<span class="comment">*                                   buted matrix A, N_A &gt;= 0.</span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;<span class="comment">*  IMB_A   (global) DESCA( IMB_   ) The number of rows of the upper left</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;<span class="comment">*                                   block of the matrix A, IMB_A &gt; 0.</span></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;<span class="comment">*  INB_A   (global) DESCA( INB_   ) The  number  of columns of the upper</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;<span class="comment">*                                   left   block   of   the   matrix  A,</span></div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;<span class="comment">*                                   INB_A &gt; 0.</span></div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;<span class="comment">*  MB_A    (global) DESCA( MB_    ) The blocking factor used to  distri-</span></div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;<span class="comment">*                                   bute the last  M_A-IMB_A rows of  A,</span></div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;<span class="comment">*                                   MB_A &gt; 0.</span></div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;<span class="comment">*  NB_A    (global) DESCA( NB_    ) The blocking factor used to  distri-</span></div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;<span class="comment">*                                   bute the last  N_A-INB_A  columns of</span></div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;<span class="comment">*                                   A, NB_A &gt; 0.</span></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;<span class="comment">*  RSRC_A  (global) DESCA( RSRC_  ) The process row over which the first</span></div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;<span class="comment">*                                   row of the matrix  A is distributed,</span></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;<span class="comment">*                                   NPROW &gt; RSRC_A &gt;= 0.</span></div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;<span class="comment">*  CSRC_A  (global) DESCA( CSRC_  ) The  process  column  over which the</span></div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;<span class="comment">*                                   first  column of  A  is distributed.</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;<span class="comment">*                                   NPCOL &gt; CSRC_A &gt;= 0.</span></div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;<span class="comment">*  LLD_A   (local)  DESCA( LLD_   ) The  leading  dimension of the local</span></div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;<span class="comment">*                                   array  storing  the  local blocks of</span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;<span class="comment">*                                   the distributed matrix A,</span></div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;<span class="comment">*                                   IF( Lc( 1, N_A ) &gt; 0 )</span></div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;<span class="comment">*                                      LLD_A &gt;= MAX( 1, Lr( 1, M_A ) )</span></div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;<span class="comment">*                                   ELSE</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;<span class="comment">*                                      LLD_A &gt;= 1.</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;<span class="comment">*  Let K be the number of  rows of a matrix A starting at the global in-</span></div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;<span class="comment">*  dex IA,i.e, A( IA:IA+K-1, : ). Lr( IA, K ) denotes the number of rows</span></div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;<span class="comment">*  that the process of row coordinate MYROW ( 0 &lt;= MYROW &lt; NPROW ) would</span></div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;<span class="comment">*  receive if these K rows were distributed over NPROW processes.  If  K</span></div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;<span class="comment">*  is the number of columns of a matrix  A  starting at the global index</span></div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;<span class="comment">*  JA, i.e, A( :, JA:JA+K-1, : ), Lc( JA, K ) denotes the number  of co-</span></div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;<span class="comment">*  lumns that the process MYCOL ( 0 &lt;= MYCOL &lt; NPCOL ) would  receive if</span></div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;<span class="comment">*  these K columns were distributed over NPCOL processes.</span></div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;<span class="comment">*  The values of Lr() and Lc() may be determined via a call to the func-</span></div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;<span class="comment">*  tion PB_NUMROC:</span></div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;<span class="comment">*  Lr( IA, K ) = PB_NUMROC( K, IA, IMB_A, MB_A, MYROW, RSRC_A, NPROW )</span></div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;<span class="comment">*  Lc( JA, K ) = PB_NUMROC( K, JA, INB_A, NB_A, MYCOL, CSRC_A, NPCOL )</span></div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;<span class="comment">*  Arguments</span></div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;<span class="comment">*  =========</span></div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;<span class="comment">*  ICTXT   (local input) INTEGER</span></div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;<span class="comment">*          On entry,  ICTXT  specifies the BLACS context handle, indica-</span></div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;<span class="comment">*          ting the global  context of the operation. The context itself</span></div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;<span class="comment">*          is global, but the value of ICTXT is local.</span></div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;<span class="comment">*  NOUT    (global input) INTEGER</span></div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;<span class="comment">*          On entry, NOUT specifies the unit number for the output file.</span></div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;<span class="comment">*          When NOUT is 6, output to screen,  when  NOUT is 0, output to</span></div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;<span class="comment">*          stderr. NOUT is only defined for process 0.</span></div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;<span class="comment">*  NROUT   (global input) INTEGER</span></div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;<span class="comment">*          On entry,  NROUT  specifies  which  routine will be tested as</span></div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;<span class="comment">*          follows:</span></div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;<span class="comment">*             If NROUT = 1,      PSSWAP will be tested;</span></div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;<span class="comment">*             else if NROUT = 2, PSSCAL will be tested;</span></div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;<span class="comment">*             else if NROUT = 3, PSCOPY will be tested;</span></div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;<span class="comment">*             else if NROUT = 4, PSAXPY will be tested;</span></div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;<span class="comment">*             else if NROUT = 5, PSDOT  will be tested;</span></div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;<span class="comment">*             else if NROUT = 6, PSNRM2 will be tested;</span></div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;<span class="comment">*             else if NROUT = 7, PSASUM will be tested;</span></div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;<span class="comment">*             else if NROUT = 8, PSAMAX will be tested.</span></div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;<span class="comment">*  N       (global input) INTEGER</span></div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;<span class="comment">*          On entry, N specifies the length of the subvector operands.</span></div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;<span class="comment">*  PSCLR   (global input) REAL</span></div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;<span class="comment">*          On entry, depending on the value of  NROUT,  PSCLR  specifies</span></div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;<span class="comment">*          the scalar ALPHA, or the output scalar returned by the PBLAS,</span></div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;<span class="comment">*          i.e., the dot product, the 2-norm,  the  absolute sum  or the</span></div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;<span class="comment">*          value of AMAX.</span></div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;<span class="comment">*  PUSCLR  (global input) REAL</span></div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;<span class="comment">*          On entry, PUSCLR specifies the real part of the  scalar ALPHA</span></div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;<span class="comment">*          used  by  the  real  scaling, the 2-norm, or the absolute sum</span></div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;<span class="comment">*          routines.  PUSCLR  is  not  used in the real versions of this</span></div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;<span class="comment">*          routine.</span></div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;<span class="comment">*  PISCLR  (global input) REAL</span></div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;<span class="comment">*          On entry, PISCLR  specifies the value of the global index re-</span></div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;<span class="comment">*          turned by PSAMAX, otherwise PISCLR is not used.</span></div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;<span class="comment">*  X       (local input/local output) REAL array</span></div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;<span class="comment">*          On entry, X is an array of  dimension  (DESCX( M_ ),*).  This</span></div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;<span class="comment">*          array contains a local copy of the initial entire matrix PX.</span></div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;<span class="comment">*  PX      (local input) REAL array</span></div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;<span class="comment">*          On entry, PX is an array of dimension (DESCX( LLD_ ),*). This</span></div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;<span class="comment">*          array contains the local entries of the matrix PX.</span></div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;<span class="comment">*  IX      (global input) INTEGER</span></div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;<span class="comment">*          On entry, IX  specifies X&#39;s global row index, which points to</span></div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;<span class="comment">*          the beginning of the submatrix sub( X ).</span></div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;<span class="comment">*  JX      (global input) INTEGER</span></div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;<span class="comment">*          On entry, JX  specifies X&#39;s global column index, which points</span></div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;<span class="comment">*          to the beginning of the submatrix sub( X ).</span></div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;<span class="comment">*  DESCX   (global and local input) INTEGER array</span></div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;<span class="comment">*          On entry, DESCX  is an integer array of dimension DLEN_. This</span></div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;<span class="comment">*          is the array descriptor for the matrix X.</span></div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;<span class="comment">*  INCX    (global input) INTEGER</span></div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;<span class="comment">*          On entry,  INCX   specifies  the  global  increment  for  the</span></div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;<span class="comment">*          elements of  X.  Only two values of  INCX   are  supported in</span></div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;<span class="comment">*          this version, namely 1 and M_X. INCX  must not be zero.</span></div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;<span class="comment">*  Y       (local input/local output) REAL array</span></div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;<span class="comment">*          On entry, Y is an array of  dimension  (DESCY( M_ ),*).  This</span></div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;<span class="comment">*          array contains a local copy of the initial entire matrix PY.</span></div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;<span class="comment">*  PY      (local input) REAL array</span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;<span class="comment">*          On entry, PY is an array of dimension (DESCY( LLD_ ),*). This</span></div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;<span class="comment">*          array contains the local entries of the matrix PY.</span></div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;<span class="comment">*  IY      (global input) INTEGER</span></div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;<span class="comment">*          On entry, IY  specifies Y&#39;s global row index, which points to</span></div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;<span class="comment">*          the beginning of the submatrix sub( Y ).</span></div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;<span class="comment">*  JY      (global input) INTEGER</span></div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;<span class="comment">*          On entry, JY  specifies Y&#39;s global column index, which points</span></div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;<span class="comment">*          to the beginning of the submatrix sub( Y ).</span></div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;<span class="comment">*  DESCY   (global and local input) INTEGER array</span></div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;<span class="comment">*          On entry, DESCY  is an integer array of dimension DLEN_. This</span></div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;<span class="comment">*          is the array descriptor for the matrix Y.</span></div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;<span class="comment">*  INCY    (global input) INTEGER</span></div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;<span class="comment">*          On entry,  INCY   specifies  the  global  increment  for  the</span></div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;<span class="comment">*          elements of  Y.  Only two values of  INCY   are  supported in</span></div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;<span class="comment">*          this version, namely 1 and M_Y. INCY  must not be zero.</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;<span class="comment">*  INFO    (global output) INTEGER</span></div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;<span class="comment">*          On exit, if INFO = 0,  no  error  has  been  found, otherwise</span></div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;<span class="comment">*          if( MOD( INFO,   2 ) = 1 ) then an error on X has been found,</span></div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;<span class="comment">*          if( MOD( INFO/2, 2 ) = 1 ) then an error on Y has been found.</span></div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;<span class="comment">*  -- Written on April 1, 1998 by</span></div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;<span class="comment">*     Antoine Petitet, University  of  Tennessee, Knoxville 37996, USA.</span></div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;<span class="comment">*  =====================================================================</span></div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;<span class="comment">*     .. Parameters ..</span></div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;<span class="keywordtype">      REAL</span>               ZERO</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;      <span class="keywordtype">PARAMETER</span>          ( ZERO = 0.0e+0 )</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;      <span class="keywordtype">INTEGER</span>            BLOCK_CYCLIC_2D_INB, CSRC_, CTXT_, DLEN_,</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;     $                   DTYPE_, IMB_, INB_, LLD_, MB_, M_, NB_, N_,</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;     $                   RSRC_</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;      <span class="keywordtype">PARAMETER</span>          ( BLOCK_CYCLIC_2D_INB = 2, dlen_ = 11,</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;     $                   dtype_ = 1, ctxt_ = 2, m_ = 3, n_ = 4,</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;     $                   imb_ = 5, inb_ = 6, mb_ = 7, nb_ = 8,</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;     $                   rsrc_ = 9, csrc_ = 10, lld_ = 11 )</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;<span class="comment">*     .. Local Scalars ..</span></div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;      <span class="keywordtype">LOGICAL</span>            COLREP, INXSCOPE, INYSCOPE, ROWREP</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;      <span class="keywordtype">INTEGER</span>            I, IB, ICURCOL, ICURROW, IDUMM, IIX, IIY, IN,</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;     $                   ioffx, ioffy, isclr, ixcol, ixrow, iycol,</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;     $                   iyrow, j, jb, jjx, jjy, jn, kk, ldx, ldy,</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;     $                   mycol, myrow, npcol, nprow</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;<span class="keywordtype">      REAL</span>               ERR, ERRMAX, PREC, SCLR, USCLR</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;<span class="comment">*     .. Local Arrays ..</span></div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;      <span class="keywordtype">INTEGER</span>            IERR( 6 )</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;      <span class="keywordtype">CHARACTER*5</span>        ARGIN1, ARGIN2, ARGOUT1, ARGOUT2</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;<span class="comment">*     .. External Subroutines ..</span></div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;      <span class="keywordtype">EXTERNAL</span>           blacs_gridinfo, igamx2d, <a class="code" href="../../d1/d4b/pblastst_8f.html#a4d223a80a5e1bca7b339a84ffc2ea180">pb_infog2l</a>, <a class="code" href="../../da/d4c/psblastst_8f.html#a45fc017f5fe6448f77435b98c2e5f143">pschkvin</a>,</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;     $                   <a class="code" href="../../d4/d6d/psblas1tst_8f.html#a05ea0a49ea1b8ef216f72744df4dc831">pserrasum</a>, <a class="code" href="../../d4/d6d/psblas1tst_8f.html#ae977aef5034cf8fe8d1f3c2e679fb155">pserraxpy</a>, <a class="code" href="../../d4/d6d/psblas1tst_8f.html#a0efa3ea81581669b25401750faba05a9">pserrdot</a>, <a class="code" href="../../d4/d6d/psblas1tst_8f.html#a9bf28f72e7eaa627830597562b0800b1">pserrnrm2</a>,</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;     $                   <a class="code" href="../../d4/d6d/psblas1tst_8f.html#a975367b70f76f9100f40e60fbc8ddd6b">pserrscal</a>, scopy, sswap</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;<span class="comment">*     .. External Functions ..</span></div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;      <span class="keywordtype">LOGICAL</span>            PISINSCOPE</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;      <span class="keywordtype">INTEGER</span>            ISAMAX</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;<span class="keywordtype">      REAL</span>               PSLAMCH</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;      <span class="keywordtype">EXTERNAL</span>           isamax, pisinscope, pslamch</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;<span class="comment">*     .. Intrinsic Functions ..</span></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;      <span class="keywordtype">INTRINSIC</span>          <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a></div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;<span class="comment">*     .. Executable Statements ..</span></div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;      info    = 0</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;<span class="comment">*     Quick return if possible</span></div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;      <span class="keywordflow">IF</span>( n.LE.0 )</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;     $   <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;      <span class="keyword">CALL </span>blacs_gridinfo( ictxt, nprow, npcol, myrow, mycol )</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;      argin1  = <span class="stringliteral">&#39;     &#39;</span></div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;      argin2  = <span class="stringliteral">&#39;     &#39;</span></div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;      argout1 = <span class="stringliteral">&#39;     &#39;</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;      argout2 = <span class="stringliteral">&#39;     &#39;</span></div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;      <span class="keywordflow">DO</span> 10 i = 1, 6</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;         ierr( i ) = 0</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;   10 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;      prec = pslamch( ictxt, <span class="stringliteral">&#39;precision&#39;</span> )</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;      <span class="keywordflow">IF</span>( nrout.EQ.1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;<span class="comment">*        Test PSSWAP</span></div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;         ioffx = ix + ( jx - 1 ) * descx( m_ )</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;         ioffy = iy + ( jy - 1 ) * descy( m_ )</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;         <span class="keyword">CALL </span>sswap( n, x( ioffx ), incx, y( ioffy ), incy )</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a45fc017f5fe6448f77435b98c2e5f143">pschkvin</a>( errmax, n, x, px, ix, jx, descx, incx,</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;     $                    ierr( 1 ) )</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a45fc017f5fe6448f77435b98c2e5f143">pschkvin</a>( errmax, n, y, py, iy, jy, descy, incy,</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;     $                    ierr( 2 ) )</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( nrout.EQ.2 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;<span class="comment">*        Test PSSCAL</span></div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;         ldx   = descx( lld_ )</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;         ioffx = ix + ( jx - 1 ) * descx( m_ )</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a4d223a80a5e1bca7b339a84ffc2ea180">pb_infog2l</a>( ix, jx, descx, nprow, npcol, myrow, mycol,</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;     $                    iix, jjx, ixrow, ixcol )</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;         icurrow = ixrow</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;         icurcol = ixcol</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;         rowrep = ( ixrow.EQ.-1 )</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;         colrep = ( ixcol.EQ.-1 )</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;         <span class="keywordflow">IF</span>( incx.EQ.descx( m_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;<span class="comment">*           sub( X ) is a row vector</span></div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;            jb = descx( inb_ ) - jx + 1</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;            <span class="keywordflow">IF</span>( jb.LE.0 )</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;     $         jb = ( (-jb ) / descx( nb_ ) + 1 ) * descx( nb_ ) + jb</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;            jb = <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( jb, n )</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;            jn = jx + jb - 1</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;            <span class="keywordflow">DO</span> 20 j = jx, jn</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;               <span class="keyword">CALL </span><a class="code" href="../../d4/d6d/psblas1tst_8f.html#a975367b70f76f9100f40e60fbc8ddd6b">pserrscal</a>( err, psclr, x( ioffx ), prec )</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;               <span class="keywordflow">IF</span>( ( myrow.EQ.icurrow .OR. rowrep ) .AND.</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;     $             ( mycol.EQ.icurcol .OR. colrep ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;                  <span class="keywordflow">IF</span>( abs( px( iix+(jjx-1)*ldx ) - x( ioffx ) ).GT.</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;     $                err )</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;     $             ierr( 1 ) = 1</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;                  jjx = jjx + 1</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;               ioffx = ioffx + incx</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;   20       <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;            icurcol = mod( icurcol+1, npcol )</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;            <span class="keywordflow">DO</span> 40 j = jn+1, jx+n-1, descx( nb_ )</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;               jb = <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( jx+n-j, descx( nb_ ) )</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;               <span class="keywordflow">DO</span> 30 kk = 0, jb-1</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="../../d4/d6d/psblas1tst_8f.html#a975367b70f76f9100f40e60fbc8ddd6b">pserrscal</a>( err, psclr, x( ioffx ), prec )</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;                  <span class="keywordflow">IF</span>( ( myrow.EQ.icurrow .OR. rowrep ) .AND.</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;     $                ( mycol.EQ.icurcol .OR. colrep ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;                     <span class="keywordflow">IF</span>( abs( px( iix+(jjx-1)*ldx ) - x( ioffx ) ).GT.</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;     $                   err )</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;     $                  ierr( 1 ) = 1</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;                     jjx = jjx + 1</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;                  ioffx = ioffx + incx</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;   30          <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;               icurcol = mod( icurcol+1, npcol )</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;   40       <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;         <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;<span class="comment">*           sub( X ) is a column vector</span></div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;            ib = descx( imb_ ) - ix + 1</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;            <span class="keywordflow">IF</span>( ib.LE.0 )</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;     $         ib = ( (-ib ) / descx( mb_ ) + 1 ) * descx( mb_ ) + ib</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;            ib = <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( ib, n )</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;            in = ix + ib - 1</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;            <span class="keywordflow">DO</span> 50 i = ix, in</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;               <span class="keyword">CALL </span><a class="code" href="../../d4/d6d/psblas1tst_8f.html#a975367b70f76f9100f40e60fbc8ddd6b">pserrscal</a>( err, psclr, x( ioffx ), prec )</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;               <span class="keywordflow">IF</span>( ( myrow.EQ.icurrow .OR. rowrep ) .AND.</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;     $             ( mycol.EQ.icurcol .OR. colrep ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;                  <span class="keywordflow">IF</span>( abs( px( iix+(jjx-1)*ldx ) - x( ioffx ) ).GT.</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;     $                err )</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;     $               ierr( 1 ) = 1</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;                  iix = iix + 1</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;               ioffx = ioffx + incx</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;   50       <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;            icurrow = mod( icurrow+1, nprow )</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;            <span class="keywordflow">DO</span> 70 i = in+1, ix+n-1, descx( mb_ )</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;               ib = <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( ix+n-i, descx( mb_ ) )</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;               <span class="keywordflow">DO</span> 60 kk = 0, ib-1</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="../../d4/d6d/psblas1tst_8f.html#a975367b70f76f9100f40e60fbc8ddd6b">pserrscal</a>( err, psclr, x( ioffx ), prec )</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;                  <span class="keywordflow">IF</span>( ( myrow.EQ.icurrow .OR. rowrep ) .AND.</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;     $                ( mycol.EQ.icurcol .OR. colrep ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;                     <span class="keywordflow">IF</span>( abs( px( iix+(jjx-1)*ldx ) - x( ioffx ) ).GT.</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;     $                   err )</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;     $                  ierr( 1 ) = 1</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;                     iix = iix + 1</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;                  ioffx = ioffx + incx</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;   60          <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;               icurrow = mod( icurrow+1, nprow )</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;   70       <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( nrout.EQ.3 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;<span class="comment">*        Test PSCOPY</span></div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;         ioffx = ix + ( jx - 1 ) * descx( m_ )</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;         ioffy = iy + ( jy - 1 ) * descy( m_ )</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;         <span class="keyword">CALL </span>scopy( n, x( ioffx ), incx, y( ioffy ), incy )</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a45fc017f5fe6448f77435b98c2e5f143">pschkvin</a>( errmax, n, x, px, ix, jx, descx, incx,</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;     $                  ierr( 1 ) )</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a45fc017f5fe6448f77435b98c2e5f143">pschkvin</a>( errmax, n, y, py, iy, jy, descy, incy,</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;     $                  ierr( 2 ) )</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( nrout.EQ.4 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;<span class="comment">*        Test PSAXPY</span></div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a45fc017f5fe6448f77435b98c2e5f143">pschkvin</a>( errmax, n, x, px, ix, jx, descx, incx,</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;     $                  ierr( 1 ) )</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;         ldy = descy( lld_ )</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;         ioffx = ix + ( jx - 1 ) * descx( m_ )</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;         ioffy = iy + ( jy - 1 ) * descy( m_ )</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d1/d4b/pblastst_8f.html#a4d223a80a5e1bca7b339a84ffc2ea180">pb_infog2l</a>( iy, jy, descy, nprow, npcol, myrow, mycol,</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;     $                    iiy, jjy, iyrow, iycol )</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;         icurrow = iyrow</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;         icurcol = iycol</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;         rowrep  = ( iyrow.EQ.-1 )</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;         colrep  = ( iycol.EQ.-1 )</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;         <span class="keywordflow">IF</span>( incy.EQ.descy( m_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;<span class="comment">*           sub( Y ) is a row vector</span></div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;            jb = descy( inb_ ) - jy + 1</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;            <span class="keywordflow">IF</span>( jb.LE.0 )</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;     $         jb = ( (-jb ) / descy( nb_ ) + 1 ) * descy( nb_ ) + jb</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;            jb = <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( jb, n )</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;            jn = jy + jb - 1</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;            <span class="keywordflow">DO</span> 140 j = jy, jn</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;               <span class="keyword">CALL </span><a class="code" href="../../d4/d6d/psblas1tst_8f.html#ae977aef5034cf8fe8d1f3c2e679fb155">pserraxpy</a>( err, psclr, x( ioffx ), y( ioffy ),</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;     $                         prec )</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;               <span class="keywordflow">IF</span>( ( myrow.EQ.icurrow .OR. rowrep ) .AND.</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;     $             ( mycol.EQ.icurcol .OR. colrep ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;                  <span class="keywordflow">IF</span>( abs( py( iiy+(jjy-1)*ldy ) - y( ioffy ) ).GT.</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;     $                err ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;                     ierr( 2 ) = 1</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;                  jjy = jjy + 1</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;               ioffx = ioffx + incx</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;               ioffy = ioffy + incy</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;  140       <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;            icurcol = mod( icurcol+1, npcol )</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;            <span class="keywordflow">DO</span> 160 j = jn+1, jy+n-1, descy( nb_ )</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;               jb = <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( jy+n-j, descy( nb_ ) )</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;               <span class="keywordflow">DO</span> 150 kk = 0, jb-1</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="../../d4/d6d/psblas1tst_8f.html#ae977aef5034cf8fe8d1f3c2e679fb155">pserraxpy</a>( err, psclr, x( ioffx ), y( ioffy ),</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;     $                            prec )</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;                  <span class="keywordflow">IF</span>( ( myrow.EQ.icurrow .OR. rowrep ) .AND.</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;     $                ( mycol.EQ.icurcol .OR. colrep ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;                     <span class="keywordflow">IF</span>( abs( py( iiy+(jjy-1)*ldy ) - y( ioffy ) ).GT.</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;     $                   err ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;                        ierr( 2 ) = 1</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;<span class="keywordflow">                     END IF</span></div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;                     jjy = jjy + 1</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;                  ioffx = ioffx + incx</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;                  ioffy = ioffy + incy</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;  150          <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;               icurcol = mod( icurcol+1, npcol )</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;  160       <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;         <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;<span class="comment">*           sub( Y ) is a column vector</span></div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;            ib = descy( imb_ ) - iy + 1</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;            <span class="keywordflow">IF</span>( ib.LE.0 )</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;     $         ib = ( (-ib ) / descy( mb_ ) + 1 ) * descy( mb_ ) + ib</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;            ib = <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( ib, n )</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;            in = iy + ib - 1</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;            <span class="keywordflow">DO</span> 170 i = iy, in</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;               <span class="keyword">CALL </span><a class="code" href="../../d4/d6d/psblas1tst_8f.html#ae977aef5034cf8fe8d1f3c2e679fb155">pserraxpy</a>( err, psclr, x( ioffx ), y( ioffy ),</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;     $                         prec )</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;               <span class="keywordflow">IF</span>( ( myrow.EQ.icurrow .OR. rowrep ) .AND.</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;     $             ( mycol.EQ.icurcol .OR. colrep ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;                  <span class="keywordflow">IF</span>( abs( py( iiy+(jjy-1)*ldy ) - y( ioffy ) ).GT.</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;     $                err ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;                     ierr( 2 ) = 1</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;                  iiy = iiy + 1</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;               ioffx = ioffx + incx</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;               ioffy = ioffy + incy</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;  170       <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;            icurrow = mod( icurrow+1, nprow )</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;            <span class="keywordflow">DO</span> 190 i = in+1, iy+n-1, descy( mb_ )</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;               ib = <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( iy+n-i, descy( mb_ ) )</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;               <span class="keywordflow">DO</span> 180 kk = 0, ib-1</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="../../d4/d6d/psblas1tst_8f.html#ae977aef5034cf8fe8d1f3c2e679fb155">pserraxpy</a>( err, psclr, x( ioffx ), y( ioffy ),</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;     $                            prec )</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;                  <span class="keywordflow">IF</span>( ( myrow.EQ.icurrow .OR. rowrep ) .AND.</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;     $                ( mycol.EQ.icurcol .OR. colrep ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;                     <span class="keywordflow">IF</span>( abs( py( iiy+(jjy-1)*ldy ) - y( ioffy ) ).GT.</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;     $                   err ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;                        ierr( 2 ) = 1</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;<span class="keywordflow">                     END IF</span></div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;                     iiy = iiy + 1</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;                  ioffx = ioffx + incx</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;                  ioffy = ioffy + incy</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;  180          <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;               icurrow = mod( icurrow+1, nprow )</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;  190       <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( nrout.EQ.5 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;<span class="comment">*        Test PSDOT</span></div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a45fc017f5fe6448f77435b98c2e5f143">pschkvin</a>( errmax, n, x, px, ix, jx, descx, incx,</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;     $                  ierr( 1 ) )</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a45fc017f5fe6448f77435b98c2e5f143">pschkvin</a>( errmax, n, y, py, iy, jy, descy, incy,</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;     $                  ierr( 2 ) )</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;         ioffx = ix + ( jx - 1 ) * descx( m_ )</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;         ioffy = iy + ( jy - 1 ) * descy( m_ )</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d4/d6d/psblas1tst_8f.html#a0efa3ea81581669b25401750faba05a9">pserrdot</a>( err, n, sclr, x( ioffx ), incx, y( ioffy ),</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;     $                  incy, prec )</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;         inxscope = pisinscope( ictxt, n, ix, jx, descx, incx )</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;         inyscope = pisinscope( ictxt, n, iy, jy, descy, incy )</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;         <span class="keywordflow">IF</span>( inxscope.OR.inyscope ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;            <span class="keywordflow">IF</span>( abs( psclr - sclr ).GT.err ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;               ierr( 3 ) = 1</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;               <span class="keyword">WRITE</span>( argin1, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;DOT&#39;</span></div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;               <span class="keywordflow">IF</span>( myrow.EQ.0 .AND. mycol.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;                  <span class="keyword">WRITE</span>( nout, fmt = 9998 ) argin1</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;                  <span class="keyword">WRITE</span>( nout, fmt = 9996 ) sclr, psclr</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;         <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;            sclr = zero</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;            <span class="keywordflow">IF</span>( psclr.NE.sclr ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;               ierr( 4 ) = 1</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;               <span class="keyword">WRITE</span>( argout1, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;DOT&#39;</span></div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;               <span class="keywordflow">IF</span>( myrow.EQ.0 .AND. mycol.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;                  <span class="keyword">WRITE</span>( nout, fmt = 9997 ) argout1</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;                  <span class="keyword">WRITE</span>( nout, fmt = 9996 ) sclr, psclr</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( nrout.EQ.6 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;<span class="comment">*        Test PSNRM2</span></div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a45fc017f5fe6448f77435b98c2e5f143">pschkvin</a>( errmax, n, x, px, ix, jx, descx, incx,</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;     $                  ierr( 1 ) )</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;         ioffx = ix + ( jx - 1 ) * descx( m_ )</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d4/d6d/psblas1tst_8f.html#a9bf28f72e7eaa627830597562b0800b1">pserrnrm2</a>( err, n, usclr, x( ioffx ), incx, prec )</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;         <span class="keywordflow">IF</span>( pisinscope( ictxt, n, ix, jx, descx, incx ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;            <span class="keywordflow">IF</span>( abs( pusclr - usclr ).GT.err ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;               ierr( 3 ) = 1</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;               <span class="keyword">WRITE</span>( argin1, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;NRM2&#39;</span></div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;               <span class="keywordflow">IF</span>( myrow.EQ.0 .AND. mycol.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;                  <span class="keyword">WRITE</span>( nout, fmt = 9998 ) argin1</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;                  <span class="keyword">WRITE</span>( nout, fmt = 9996 ) usclr, pusclr</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;         <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;            usclr = zero</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;            <span class="keywordflow">IF</span>( pusclr.NE.usclr ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;               ierr( 4 ) = 1</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;               <span class="keyword">WRITE</span>( argout1, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;NRM2&#39;</span></div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;               <span class="keywordflow">IF</span>( myrow.EQ.0 .AND. mycol.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;                  <span class="keyword">WRITE</span>( nout, fmt = 9997 ) argout1</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;                  <span class="keyword">WRITE</span>( nout, fmt = 9996 ) usclr, pusclr</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( nrout.EQ.7 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;<span class="comment">*        Test PSASUM</span></div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a45fc017f5fe6448f77435b98c2e5f143">pschkvin</a>( errmax, n, x, px, ix, jx, descx, incx,</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;     $                  ierr( 1 ) )</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;         ioffx = ix + ( jx - 1 ) * descx( m_ )</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d4/d6d/psblas1tst_8f.html#a05ea0a49ea1b8ef216f72744df4dc831">pserrasum</a>( err, n, usclr, x( ioffx ), incx, prec )</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;         <span class="keywordflow">IF</span>( pisinscope( ictxt, n, ix, jx, descx, incx ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;            <span class="keywordflow">IF</span>( abs( pusclr - usclr ) .GT. err ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;               ierr( 3 ) = 1</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;               <span class="keyword">WRITE</span>( argin1, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;ASUM&#39;</span></div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;               <span class="keywordflow">IF</span>( myrow.EQ.0 .AND. mycol.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;                  <span class="keyword">WRITE</span>( nout, fmt = 9998 ) argin1</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;                  <span class="keyword">WRITE</span>( nout, fmt = 9996 ) usclr, pusclr</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;         <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;            usclr = zero</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;            <span class="keywordflow">IF</span>( pusclr.NE.usclr ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;               ierr( 4 ) = 1</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;               <span class="keyword">WRITE</span>( argout1, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;ASUM&#39;</span></div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;               <span class="keywordflow">IF</span>( myrow.EQ.0 .AND. mycol.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;                  <span class="keyword">WRITE</span>( nout, fmt = 9997 ) argout1</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;                  <span class="keyword">WRITE</span>( nout, fmt = 9996 ) usclr, pusclr</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( nrout.EQ.8 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;<span class="comment">*        Test PSAMAX</span></div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../da/d4c/psblastst_8f.html#a45fc017f5fe6448f77435b98c2e5f143">pschkvin</a>( errmax, n, x, px, ix, jx, descx, incx,</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;     $                  ierr( 1 ) )</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;         ioffx = ix + ( jx - 1 ) * descx( m_ )</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;         <span class="keywordflow">IF</span>( pisinscope( ictxt, n, ix, jx, descx, incx ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;            isclr = isamax( n, x( ioffx ), incx )</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;            <span class="keywordflow">IF</span>( n.LT.1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;               sclr = zero</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( ( incx.EQ.1 ).AND.( descx( m_ ).EQ.1 ).AND.</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;     $               ( n.EQ.1 ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;               isclr = jx</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;               sclr = x( ioffx )</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( incx.EQ.descx( m_ ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;               isclr = jx + isclr - 1</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;               sclr = x( ix + ( isclr - 1 ) * descx( m_ ) )</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;               isclr = ix + isclr - 1</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;               sclr = x( isclr + ( jx - 1 ) * descx( m_ ) )</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;            <span class="keywordflow">IF</span>( psclr.NE.sclr ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;               ierr( 3 ) = 1</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;               <span class="keyword">WRITE</span>( argin1, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;AMAX&#39;</span></div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;               <span class="keywordflow">IF</span>( myrow.EQ.0 .AND. mycol.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;                  <span class="keyword">WRITE</span>( nout, fmt = 9998 ) argin1</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;                  <span class="keyword">WRITE</span>( nout, fmt = 9996 ) sclr, psclr</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;            <span class="keywordflow">IF</span>( pisclr.NE.isclr ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;               ierr( 5 ) = 1</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;               <span class="keyword">WRITE</span>( argin2, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;INDX&#39;</span></div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;               <span class="keywordflow">IF</span>( myrow.EQ.0 .AND. mycol.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;                  <span class="keyword">WRITE</span>( nout, fmt = 9998 ) argin2</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;                  <span class="keyword">WRITE</span>( nout, fmt = 9995 ) isclr, pisclr</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;         <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;            isclr = 0</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;            sclr  = zero</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;            <span class="keywordflow">IF</span>( psclr.NE.sclr ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;               ierr( 4 ) = 1</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;               <span class="keyword">WRITE</span>( argout1, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;AMAX&#39;</span></div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;               <span class="keywordflow">IF</span>( myrow.EQ.0 .AND. mycol.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;                  <span class="keyword">WRITE</span>( nout, fmt = 9997 ) argout1</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;                  <span class="keyword">WRITE</span>( nout, fmt = 9996 ) sclr, psclr</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;            <span class="keywordflow">IF</span>( pisclr.NE.isclr ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;               ierr( 6 ) = 1</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;               <span class="keyword">WRITE</span>( argout2, fmt = <span class="stringliteral">&#39;(A)&#39;</span> ) <span class="stringliteral">&#39;INDX&#39;</span></div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;               <span class="keywordflow">IF</span>( myrow.EQ.0 .AND. mycol.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;                  <span class="keyword">WRITE</span>( nout, fmt = 9997 ) argout2</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;                  <span class="keyword">WRITE</span>( nout, fmt = 9995 ) isclr, pisclr</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;<span class="comment">*     Find IERR across all processes</span></div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;      <span class="keyword">CALL </span>igamx2d( ictxt, <span class="stringliteral">&#39;All&#39;</span>, <span class="stringliteral">&#39; &#39;</span>, 6, 1, ierr, 6, idumm, idumm, -1,</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;     $              -1, 0 )</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;<span class="comment">*     Encode the errors found in INFO</span></div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;      <span class="keywordflow">IF</span>( ierr( 1 ).NE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;         info = info + 1</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;         <span class="keywordflow">IF</span>( myrow.EQ.0 .AND. mycol.EQ.0 )</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;     $      <span class="keyword">WRITE</span>( nout, fmt = 9999 ) <span class="stringliteral">&#39;X&#39;</span></div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;      <span class="keywordflow">IF</span>( ierr( 2 ).NE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;         info = info + 2</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;         <span class="keywordflow">IF</span>( myrow.EQ.0 .AND. mycol.EQ.0 )</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;     $      <span class="keyword">WRITE</span>( nout, fmt = 9999 ) <span class="stringliteral">&#39;Y&#39;</span></div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;      <span class="keywordflow">IF</span>( ierr( 3 ).NE.0 )</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;     $   info = info + 4</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;      <span class="keywordflow">IF</span>( ierr( 4 ).NE.0 )</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;     $   info = info + 8</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;      <span class="keywordflow">IF</span>( ierr( 5 ).NE.0 )</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;     $   info = info + 16</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;      <span class="keywordflow">IF</span>( ierr( 6 ).NE.0 )</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;     $   info = info + 32</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160; 9999 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;   ***** ERROR: Vector operand &#39;</span>, a,</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;     $        <span class="stringliteral">&#39; is incorrect.&#39;</span> )</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160; 9998 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;   ***** ERROR: Output scalar result &#39;</span>, a,</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;     $        <span class="stringliteral">&#39; in scope is incorrect.&#39;</span> )</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160; 9997 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;   ***** ERROR: Output scalar result &#39;</span>, a,</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;     $        <span class="stringliteral">&#39; out of scope is incorrect.&#39;</span> )</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160; 9996 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;   ***** Expected value is: &#39;</span>, e16.8, /2x,</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;     $        <span class="stringliteral">&#39;         Obtained value is: &#39;</span>, e16.8 )</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160; 9995 <span class="keyword">FORMAT</span>( 2x, <span class="stringliteral">&#39;   ***** Expected value is: &#39;</span>, i6, /2x,</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;     $        <span class="stringliteral">&#39;         Obtained value is: &#39;</span>, i6 )</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;<span class="comment">*     End of PSBLAS1TSTCHK</span></div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;      <span class="keyword">SUBROUTINE </span><a class="code" href="../../d4/d6d/psblas1tst_8f.html#a0efa3ea81581669b25401750faba05a9">pserrdot</a>( ERRBND, N, SCLR, X, INCX, Y, INCY, PREC )</div>
<div class="line"><a name="l02933"></a><span class="lineno"><a class="line" href="../../d4/d6d/psblas1tst_8f.html#a0efa3ea81581669b25401750faba05a9"> 2933</a></span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;<span class="comment">*  -- PBLAS test routine (version 2.0) --</span></div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;<span class="comment">*     University of Tennessee, Knoxville, Oak Ridge National Laboratory,</span></div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;<span class="comment">*     and University of California, Berkeley.</span></div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;<span class="comment">*     April 1, 1998</span></div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;<span class="comment">*     .. Scalar Arguments ..</span></div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;      <span class="keywordtype">INTEGER</span>            INCX, INCY, N</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;      <span class="keywordtype">REAL</span>               ERRBND, PREC, SCLR</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;<span class="comment">*     .. Array Arguments ..</span></div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;<span class="keywordtype">      REAL</span>               X( * ), Y( * )</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;<span class="comment">*  Purpose</span></div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;<span class="comment">*  =======</span></div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;<span class="comment">*  PSERRDOT  serially  computes  the  dot product X**T * Y and returns a</span></div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;<span class="comment">*  scaled relative acceptable error bound on the result.</span></div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;<span class="comment">*  Notes</span></div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;<span class="comment">*  =====</span></div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;<span class="comment">*  If dot1 = SCLR and  dot2 are two different computed results, and dot1</span></div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;<span class="comment">*  is being assumed to be correct, we require</span></div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;<span class="comment">*     abs( dot1 - dot2 ) &lt;= ERRBND = ERRFACT * abs( dot1 ),</span></div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;<span class="comment">*  where ERRFACT is computed as the maximum of the positive and negative</span></div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;<span class="comment">*  partial  sums  multiplied  by  a constant proportional to the machine</span></div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;<span class="comment">*  precision.</span></div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;<span class="comment">*  Arguments</span></div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;<span class="comment">*  =========</span></div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;<span class="comment">*  ERRBND  (global output) REAL</span></div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;<span class="comment">*          On exit, ERRBND  specifies the scaled relative acceptable er-</span></div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;<span class="comment">*          ror bound.</span></div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;<span class="comment">*  N       (global input) INTEGER</span></div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;<span class="comment">*          On entry, N specifies the length of the vector operands.</span></div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;<span class="comment">*  SCLR    (global output) REAL</span></div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;<span class="comment">*          On exit,  SCLR  specifies  the dot product of the two vectors</span></div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;<span class="comment">*          X and Y.</span></div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;<span class="comment">*  X       (global input) REAL array</span></div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;<span class="comment">*          On   entry,   X   is   an   array   of   dimension  at  least</span></div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;<span class="comment">*          ( 1 + ( n - 1 )*abs( INCX ) ).  Before  entry,  the incremen-</span></div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;<span class="comment">*          ted array X must contain the vector x.</span></div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;<span class="comment">*  INCX    (global input) INTEGER.</span></div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;<span class="comment">*          On entry, INCX specifies the increment for the elements of X.</span></div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;<span class="comment">*          INCX must not be zero.</span></div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;<span class="comment">*  Y       (global input) REAL array</span></div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;<span class="comment">*          On   entry,   Y   is   an   array   of   dimension  at  least</span></div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;<span class="comment">*          ( 1 + ( n - 1 )*abs( INCY ) ).  Before  entry,  the incremen-</span></div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;<span class="comment">*          ted array Y must contain the vector y.</span></div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;<span class="comment">*  INCY    (global input) INTEGER.</span></div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;<span class="comment">*          On entry, INCY specifies the increment for the elements of Y.</span></div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;<span class="comment">*          INCY must not be zero.</span></div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;<span class="comment">*  PREC    (global input) REAL</span></div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;<span class="comment">*          On entry, PREC specifies the machine precision.</span></div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;<span class="comment">*  -- Written on April 1, 1998 by</span></div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;<span class="comment">*     Antoine Petitet, University  of  Tennessee, Knoxville 37996, USA.</span></div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;<span class="comment">*  =====================================================================</span></div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;<span class="comment">*     .. Parameters ..</span></div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;<span class="keywordtype">      REAL</span>               ONE, TWO, ZERO</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;      <span class="keywordtype">PARAMETER</span>          ( ONE = 1.0e+0, two = 2.0e+0,</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;     $                   zero = 0.0e+0 )</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;<span class="comment">*     .. Local Scalars ..</span></div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;      <span class="keywordtype">INTEGER</span>            I, IX, IY</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;      <span class="keywordtype">REAL</span>               ADDBND, FACT, SUMNEG, SUMPOS, TMP</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;<span class="comment">*     .. Intrinsic Functions ..</span></div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;      <span class="keywordtype">INTRINSIC</span>          ABS, MAX</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;<span class="comment">*     .. Executable Statements ..</span></div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;      ix = 1</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;      iy = 1</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;      sclr = zero</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;      sumpos = zero</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;      sumneg = zero</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;      fact = two * ( one + prec )</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;      addbnd = two * two * two * prec</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;      <span class="keywordflow">DO</span> 10 i = 1, n</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;         tmp = x( ix ) * y( iy )</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;         sclr = sclr + tmp</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;         <span class="keywordflow">IF</span>( tmp.GE.zero ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;            sumpos = sumpos + tmp * fact</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;         <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;            sumneg = sumneg - tmp * fact</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;         ix = ix + incx</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;         iy = iy + incy</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;   10 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;      errbnd = addbnd * max( sumpos, sumneg )</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;<span class="comment">*     End of PSERRDOT</span></div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;      <span class="keyword">SUBROUTINE </span><a class="code" href="../../d4/d6d/psblas1tst_8f.html#a9bf28f72e7eaa627830597562b0800b1">pserrnrm2</a>( ERRBND, N, USCLR, X, INCX, PREC )</div>
<div class="line"><a name="l03047"></a><span class="lineno"><a class="line" href="../../d4/d6d/psblas1tst_8f.html#a9bf28f72e7eaa627830597562b0800b1"> 3047</a></span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;<span class="comment">*  -- PBLAS test routine (version 2.0) --</span></div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;<span class="comment">*     University of Tennessee, Knoxville, Oak Ridge National Laboratory,</span></div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;<span class="comment">*     and University of California, Berkeley.</span></div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;<span class="comment">*     April 1, 1998</span></div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;<span class="comment">*     .. Scalar Arguments ..</span></div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;      <span class="keywordtype">INTEGER</span>            INCX, N</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;      <span class="keywordtype">REAL</span>               ERRBND, PREC, USCLR</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;<span class="comment">*     .. Array Arguments ..</span></div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;<span class="keywordtype">      REAL</span>               X( * )</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;<span class="comment">*  Purpose</span></div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;<span class="comment">*  =======</span></div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;<span class="comment">*  PSERRNRM2  serially  computes  the  2-norm the vector X and returns a</span></div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;<span class="comment">*  scaled relative acceptable error bound on the result.</span></div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;<span class="comment">*  Notes</span></div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;<span class="comment">*  =====</span></div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;<span class="comment">*  If  norm1 = SCLR  and  norm2  are two different computed results, and</span></div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;<span class="comment">*  norm1 being assumed to be correct, we require</span></div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;<span class="comment">*     abs( norm1 - norm2 ) &lt;= ERRBND = ERRFACT * abs( norm1 ),</span></div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;<span class="comment">*  where ERRFACT is computed as the maximum of the positive and negative</span></div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;<span class="comment">*  partial  sums  multiplied  by  a constant proportional to the machine</span></div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;<span class="comment">*  precision.</span></div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;<span class="comment">*  Arguments</span></div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;<span class="comment">*  =========</span></div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;<span class="comment">*  ERRBND  (global output) REAL</span></div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;<span class="comment">*          On exit, ERRBND  specifies the scaled relative acceptable er-</span></div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;<span class="comment">*          ror bound.</span></div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;<span class="comment">*  N       (global input) INTEGER</span></div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;<span class="comment">*          On entry, N specifies the length of the vector operand.</span></div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;<span class="comment">*  USCLR   (global output) REAL</span></div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;<span class="comment">*          On exit, USCLR specifies the 2-norm of the vector X.</span></div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;<span class="comment">*  X       (global input) REAL array</span></div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;<span class="comment">*          On   entry,   X   is   an   array   of   dimension  at  least</span></div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;<span class="comment">*          ( 1 + ( n - 1 )*abs( INCX ) ).  Before  entry,  the incremen-</span></div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;<span class="comment">*          ted array X must contain the vector x.</span></div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;<span class="comment">*  INCX    (global input) INTEGER.</span></div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;<span class="comment">*          On entry, INCX specifies the increment for the elements of X.</span></div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;<span class="comment">*          INCX must not be zero.</span></div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;<span class="comment">*  PREC    (global input) REAL</span></div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;<span class="comment">*          On entry, PREC specifies the machine precision.</span></div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;<span class="comment">*  -- Written on April 1, 1998 by</span></div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;<span class="comment">*     Antoine Petitet, University  of  Tennessee, Knoxville 37996, USA.</span></div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;<span class="comment">*  =====================================================================</span></div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;<span class="comment">*     .. Parameters ..</span></div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;<span class="keywordtype">      REAL</span>               ONE, TWO, ZERO</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;      <span class="keywordtype">PARAMETER</span>          ( ONE = 1.0e+0, two = 2.0e+0,</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;     $                   zero = 0.0e+0 )</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;<span class="comment">*     .. Local Scalars ..</span></div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;      <span class="keywordtype">INTEGER</span>            IX</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;      <span class="keywordtype">REAL</span>               ABSXI, ADDBND, FACT, SCALE, SSQ, SUMSCA, SUMSSQ</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;<span class="comment">*     .. Intrinsic Functions ..</span></div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;      <span class="keywordtype">INTRINSIC</span>          ABS</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;<span class="comment">*     .. Executable Statements ..</span></div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;      usclr = zero</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;      sumssq = one</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;      sumsca = zero</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;      addbnd = two * two * two * prec</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;      fact = one + two * ( ( one + prec )**3 - one )</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;      scale = zero</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;      ssq = one</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;      <span class="keywordflow">DO</span> 10 ix = 1, 1 + ( n - 1 )*incx, incx</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;         <span class="keywordflow">IF</span>( x( ix ).NE.zero ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;            absxi = abs( x( ix ) )</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;            <span class="keywordflow">IF</span>( scale.LT.absxi )<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;               sumssq = one + ( ssq*( scale/absxi )**2 ) * fact</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;               errbnd = addbnd * sumssq</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;               sumssq = sumssq + errbnd</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;               ssq    = one + ssq*( scale/absxi )**2</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;               sumsca = absxi</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;               scale  = absxi</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;               sumssq = ssq + ( ( absxi/scale )**2 ) * fact</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;               errbnd = addbnd * sumssq</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;               sumssq = sumssq + errbnd</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;               ssq    = ssq + ( absxi/scale )**2</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;   10 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;      usclr = scale * sqrt( ssq )</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;<span class="comment">*     Error on square root</span></div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;      errbnd = sqrt( sumssq ) * ( one + two * ( 1.00001e+0 * prec ) )</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;      errbnd = ( sumsca * errbnd ) - usclr</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;<span class="comment">*     End of PSERRNRM2</span></div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;      <span class="keyword">SUBROUTINE </span><a class="code" href="../../d4/d6d/psblas1tst_8f.html#a05ea0a49ea1b8ef216f72744df4dc831">pserrasum</a>( ERRBND, N, USCLR, X, INCX, PREC )</div>
<div class="line"><a name="l03164"></a><span class="lineno"><a class="line" href="../../d4/d6d/psblas1tst_8f.html#a05ea0a49ea1b8ef216f72744df4dc831"> 3164</a></span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;<span class="comment">*  -- PBLAS test routine (version 2.0) --</span></div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;<span class="comment">*     University of Tennessee, Knoxville, Oak Ridge National Laboratory,</span></div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;<span class="comment">*     and University of California, Berkeley.</span></div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;<span class="comment">*     April 1, 1998</span></div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;<span class="comment">*     .. Scalar Arguments ..</span></div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;      <span class="keywordtype">INTEGER</span>            INCX, N</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;      <span class="keywordtype">REAL</span>               ERRBND, PREC, USCLR</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;<span class="comment">*     .. Array Arguments ..</span></div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;<span class="keywordtype">      REAL</span>               X( * )</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;<span class="comment">*  Purpose</span></div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;<span class="comment">*  =======</span></div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;<span class="comment">*  PSERRASUM  serially computes the sum of absolute values of the vector</span></div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;<span class="comment">*  X and returns a scaled relative acceptable error bound on the result.</span></div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;<span class="comment">*  Arguments</span></div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;<span class="comment">*  =========</span></div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;<span class="comment">*  ERRBND  (global output) REAL</span></div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;<span class="comment">*          On exit, ERRBND  specifies a scaled relative acceptable error</span></div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;<span class="comment">*          bound. In this case the error bound is just the absolute  sum</span></div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;<span class="comment">*          multiplied  by  a constant proportional to the machine preci-</span></div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;<span class="comment">*          sion.</span></div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;<span class="comment">*  N       (global input) INTEGER</span></div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;<span class="comment">*          On entry, N specifies the length of the vector operand.</span></div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;<span class="comment">*  USCLR   (global output) REAL</span></div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;<span class="comment">*          On exit, USCLR  specifies  the  sum of absolute values of the</span></div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;<span class="comment">*          vector X.</span></div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;<span class="comment">*  X       (global input) REAL array</span></div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;<span class="comment">*          On   entry,   X   is   an   array   of   dimension  at  least</span></div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;<span class="comment">*          ( 1 + ( n - 1 )*abs( INCX ) ).  Before  entry,  the incremen-</span></div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;<span class="comment">*          ted array X must contain the vector x.</span></div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;<span class="comment">*  INCX    (global input) INTEGER.</span></div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;<span class="comment">*          On entry, INCX specifies the increment for the elements of X.</span></div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;<span class="comment">*          INCX must not be zero.</span></div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;<span class="comment">*  PREC    (global input) REAL</span></div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;<span class="comment">*          On entry, PREC specifies the machine precision.</span></div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;<span class="comment">*  -- Written on April 1, 1998 by</span></div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;<span class="comment">*     Antoine Petitet, University  of  Tennessee, Knoxville 37996, USA.</span></div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;<span class="comment">*  =====================================================================</span></div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;<span class="comment">*     .. Parameters ..</span></div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;<span class="keywordtype">      REAL</span>               TWO, ZERO</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;      <span class="keywordtype">PARAMETER</span>          ( TWO = 2.0e+0, zero = 0.0e+0 )</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;<span class="comment">*     .. Local Scalars ..</span></div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;      <span class="keywordtype">INTEGER</span>            IX</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;      <span class="keywordtype">REAL</span>               ADDBND</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;<span class="comment">*     .. Intrinsic Functions ..</span></div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;      <span class="keywordtype">INTRINSIC</span>          ABS</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;<span class="comment">*     .. Executable Statements ..</span></div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;      ix = 1</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;      usclr = zero</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;      addbnd = two * two * two * prec</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;      <span class="keywordflow">DO</span> 10 ix = 1, 1 + ( n - 1 )*incx, incx</div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;         usclr = usclr + abs( x( ix ) )</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;   10 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;      errbnd = addbnd * usclr</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;<span class="comment">*     End of PSERRASUM</span></div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;      <span class="keyword">SUBROUTINE </span><a class="code" href="../../d4/d6d/psblas1tst_8f.html#a975367b70f76f9100f40e60fbc8ddd6b">pserrscal</a>( ERRBND, PSCLR, X, PREC )</div>
<div class="line"><a name="l03246"></a><span class="lineno"><a class="line" href="../../d4/d6d/psblas1tst_8f.html#a975367b70f76f9100f40e60fbc8ddd6b"> 3246</a></span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;<span class="comment">*  -- PBLAS test routine (version 2.0) --</span></div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;<span class="comment">*     University of Tennessee, Knoxville, Oak Ridge National Laboratory,</span></div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;<span class="comment">*     and University of California, Berkeley.</span></div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;<span class="comment">*     April 1, 1998</span></div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;<span class="comment">*     .. Scalar Arguments ..</span></div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;<span class="keywordtype">      REAL</span>               ERRBND, PREC, PSCLR, X</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;<span class="comment">*  Purpose</span></div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;<span class="comment">*  =======</span></div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;<span class="comment">*  PSERRSCAL serially computes the product PSCLR * X and returns a sca-</span></div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;<span class="comment">*  led relative acceptable error bound on the result.</span></div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;<span class="comment">*  Notes</span></div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;<span class="comment">*  =====</span></div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;<span class="comment">*  If s1 = PSCLR*X and  s2 are two different computed results, and s1 is</span></div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;<span class="comment">*  being assumed to be correct, we require</span></div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;<span class="comment">*        abs( s1 - s2 ) &lt;= ERRBND = ERRFACT * abs( s1 ),</span></div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;<span class="comment">*  where ERRFACT is computed as two times the machine precision.</span></div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;<span class="comment">*  Arguments</span></div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;<span class="comment">*  =========</span></div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;<span class="comment">*  ERRBND  (global output) REAL</span></div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;<span class="comment">*          On exit, ERRBND  specifies the scaled relative acceptable er-</span></div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;<span class="comment">*          ror bound.</span></div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;<span class="comment">*  PSCLR   (global input) REAL</span></div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;<span class="comment">*          On entry, PSCLR specifies the scale factor.</span></div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;<span class="comment">*  X       (global input/global output) REAL</span></div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;<span class="comment">*          On entry, X  specifies the scalar to be scaled. On exit, X is</span></div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;<span class="comment">*          the scaled entry.</span></div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;<span class="comment">*  PREC    (global input) REAL</span></div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;<span class="comment">*          On entry, PREC specifies the machine precision.</span></div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;<span class="comment">*  -- Written on April 1, 1998 by</span></div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;<span class="comment">*     Antoine Petitet, University  of  Tennessee, Knoxville 37996, USA.</span></div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;<span class="comment">*  =====================================================================</span></div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;<span class="comment">*     .. Parameters ..</span></div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;<span class="keywordtype">      REAL</span>               TWO</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;      <span class="keywordtype">PARAMETER</span>          ( TWO = 2.0e+0 )</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;<span class="comment">*     .. Intrinsic Functions ..</span></div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;      <span class="keywordtype">INTRINSIC</span>          abs</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;<span class="comment">*     .. Executable Statements ..</span></div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;      x = psclr * x</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;      errbnd = ( two * prec ) * abs( x )</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;<span class="comment">*     End of PSERRSCAL</span></div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;      <span class="keyword">SUBROUTINE </span><a class="code" href="../../d4/d6d/psblas1tst_8f.html#ae977aef5034cf8fe8d1f3c2e679fb155">pserraxpy</a>( ERRBND, PSCLR, X, Y, PREC )</div>
<div class="line"><a name="l03313"></a><span class="lineno"><a class="line" href="../../d4/d6d/psblas1tst_8f.html#ae977aef5034cf8fe8d1f3c2e679fb155"> 3313</a></span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;<span class="comment">*  -- PBLAS test routine (version 2.0) --</span></div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;<span class="comment">*     University of Tennessee, Knoxville, Oak Ridge National Laboratory,</span></div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;<span class="comment">*     and University of California, Berkeley.</span></div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;<span class="comment">*     April 1, 1998</span></div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;<span class="comment">*     .. Scalar Arguments ..</span></div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;<span class="keywordtype">      REAL</span>               ERRBND, PREC, PSCLR, X, Y</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;<span class="comment">*  Purpose</span></div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;<span class="comment">*  =======</span></div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;<span class="comment">*  PSERRAXPY  serially computes Y := Y + PSCLR * X and returns a scaled</span></div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;<span class="comment">*  relative acceptable error bound on the result.</span></div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;<span class="comment">*  Arguments</span></div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;<span class="comment">*  =========</span></div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;<span class="comment">*  ERRBND  (global output) REAL</span></div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;<span class="comment">*          On exit, ERRBND  specifies the scaled relative acceptable er-</span></div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;<span class="comment">*          ror bound.</span></div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;<span class="comment">*  PSCLR   (global input) REAL</span></div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;<span class="comment">*          On entry, PSCLR specifies the scale factor.</span></div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;<span class="comment">*  X       (global input) REAL</span></div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;<span class="comment">*          On entry, X  specifies the scalar to be scaled.</span></div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;<span class="comment">*  Y       (global input/global output) REAL</span></div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;<span class="comment">*          On entry, Y specifies the scalar to be added. On exit, Y con-</span></div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;<span class="comment">*          tains the resulting scalar.</span></div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;<span class="comment">*  PREC    (global input) REAL</span></div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;<span class="comment">*          On entry, PREC specifies the machine precision.</span></div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;<span class="comment">*  -- Written on April 1, 1998 by</span></div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;<span class="comment">*     Antoine Petitet, University  of  Tennessee, Knoxville 37996, USA.</span></div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;<span class="comment">*  =====================================================================</span></div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;<span class="comment">*     .. Parameters ..</span></div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;<span class="keywordtype">      REAL</span>               ONE, TWO, ZERO</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;      <span class="keywordtype">PARAMETER</span>          ( ONE = 1.0e+0, two = 2.0e+0,</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;     $                   zero = 0.0e+0 )</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;<span class="comment">*     .. Local Scalars ..</span></div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;<span class="keywordtype">      REAL</span>               ADDBND, FACT, SUMPOS, SUMNEG, TMP</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;<span class="comment">*     .. Intrinsic Functions ..</span></div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;      <span class="keywordtype">INTRINSIC</span>          MAX</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;<span class="comment">*     .. Executable Statements ..</span></div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;      sumpos = zero</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;      sumneg = zero</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;      fact = one + two * prec</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;      addbnd = two * two * two * prec</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;      tmp = psclr * x</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;      <span class="keywordflow">IF</span>( tmp.GE.zero ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;         sumpos = sumpos + tmp * fact</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;         sumneg = sumneg - tmp * fact</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;      tmp = y</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;      <span class="keywordflow">IF</span>( tmp.GE.zero ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;         sumpos = sumpos + tmp</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;         sumneg = sumneg - tmp</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;      y = y + ( psclr * x )</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;      errbnd = addbnd * max( sumpos, sumneg )</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;<span class="comment">*     End of PSERRAXPY</span></div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;      <span class="keyword">END</span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="apcblastst_8f_html_a3df12c2b4e5880f14763677d8d8136cb"><div class="ttname"><a href="../../d0/de4/pcblastst_8f.html#a3df12c2b4e5880f14763677d8d8136cb">pslamch</a></div><div class="ttdeci">real function pslamch(ICTXT, CMACH)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/de4/pcblastst_8f_source.html#l07455">pcblastst.f:7455</a></div></div>
<div class="ttc" id="apsblastst_8f_html_a4a5cf80922ff74c2571d743096f5c8dd"><div class="ttname"><a href="../../da/d4c/psblastst_8f.html#a4a5cf80922ff74c2571d743096f5c8dd">psmprnt</a></div><div class="ttdeci">subroutine psmprnt(ICTXT, NOUT, M, N, A, LDA, IRPRNT, ICPRNT, CMATNM)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4c/psblastst_8f_source.html#l03949">psblastst.f:3949</a></div></div>
<div class="ttc" id="apcblas1tst_8f_html_a125a7571ec3d5cbe5ed3ed583af0a368"><div class="ttname"><a href="../../d0/d71/pcblas1tst_8f.html#a125a7571ec3d5cbe5ed3ed583af0a368">pisinscope</a></div><div class="ttdeci">logical function pisinscope(ICTXT, N, IX, JX, DESCX, INCX)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d71/pcblas1tst_8f_source.html#l02078">pcblas1tst.f:2078</a></div></div>
<div class="ttc" id="apcgemr_8c_html_a24e753bacac6be5f30e18f8a2bdefda4"><div class="ttname"><a href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a></div><div class="ttdeci">#define max(A, B)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dad/pcgemr_8c_source.html#l00180">pcgemr.c:180</a></div></div>
<div class="ttc" id="apsblas1tst_8f_html_ab8d905d8ee4ce77e78b9fcabba828092"><div class="ttname"><a href="../../d4/d6d/psblas1tst_8f.html#ab8d905d8ee4ce77e78b9fcabba828092">psbla1tst</a></div><div class="ttdeci">program psbla1tst</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6d/psblas1tst_8f_source.html#l00011">psblas1tst.f:11</a></div></div>
<div class="ttc" id="apblastst_8f_html_a670947594ecdfbf17d5bb2f70e9b8ec0"><div class="ttname"><a href="../../d1/d4b/pblastst_8f.html#a670947594ecdfbf17d5bb2f70e9b8ec0">pb_descset2</a></div><div class="ttdeci">subroutine pb_descset2(DESC, M, N, IMB, INB, MB, NB, RSRC, CSRC, CTXT, LLD)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4b/pblastst_8f_source.html#l03172">pblastst.f:3172</a></div></div>
<div class="ttc" id="apsblastst_8f_html_a53140a30d5b1435b4faad1c7e72eb54a"><div class="ttname"><a href="../../da/d4c/psblastst_8f.html#a53140a30d5b1435b4faad1c7e72eb54a">pb_sfillpad</a></div><div class="ttdeci">subroutine pb_sfillpad(ICTXT, M, N, A, LDA, IPRE, IPOST, CHKVAL)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4c/psblastst_8f_source.html#l09081">psblastst.f:9081</a></div></div>
<div class="ttc" id="apsblastst_8f_html_a8168722944c9e4e0138bbea6a8d5091c"><div class="ttname"><a href="../../da/d4c/psblastst_8f.html#a8168722944c9e4e0138bbea6a8d5091c">pschkvout</a></div><div class="ttdeci">subroutine pschkvout(N, X, PX, IX, JX, DESCX, INCX, INFO)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4c/psblastst_8f_source.html#l02870">psblastst.f:2870</a></div></div>
<div class="ttc" id="apsblas1tst_8f_html_a0efa3ea81581669b25401750faba05a9"><div class="ttname"><a href="../../d4/d6d/psblas1tst_8f.html#a0efa3ea81581669b25401750faba05a9">pserrdot</a></div><div class="ttdeci">subroutine pserrdot(ERRBND, N, SCLR, X, INCX, Y, INCY, PREC)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6d/psblas1tst_8f_source.html#l02933">psblas1tst.f:2933</a></div></div>
<div class="ttc" id="apsblas1tst_8f_html_a0e7ba7d1b520a00e8806b2744bda0b66"><div class="ttname"><a href="../../d4/d6d/psblas1tst_8f.html#a0e7ba7d1b520a00e8806b2744bda0b66">pschkarg1</a></div><div class="ttdeci">subroutine pschkarg1(ICTXT, NOUT, SNAME, N, ALPHA, IX, JX, DESCX, INCX, IY, JY, DESCY, INCY, INFO)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6d/psblas1tst_8f_source.html#l01734">psblas1tst.f:1734</a></div></div>
<div class="ttc" id="apsblastst_8f_html_a883a03af9ae393fc8e72d1184a4085c0"><div class="ttname"><a href="../../da/d4c/psblastst_8f.html#a883a03af9ae393fc8e72d1184a4085c0">psdimee</a></div><div class="ttdeci">subroutine psdimee(ICTXT, NOUT, SUBPTR, SCODE, SNAME)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4c/psblastst_8f_source.html#l00455">psblastst.f:455</a></div></div>
<div class="ttc" id="apsblastst_8f_html_a7e786c7f84eeeff7336fd70cdf729c96"><div class="ttname"><a href="../../da/d4c/psblastst_8f.html#a7e786c7f84eeeff7336fd70cdf729c96">pslagen</a></div><div class="ttdeci">subroutine pslagen(INPLACE, AFORM, DIAG, OFFA, M, N, IA, JA, DESCA, IASEED, A, LDA)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4c/psblastst_8f_source.html#l07846">psblastst.f:7846</a></div></div>
<div class="ttc" id="apsblas1tst_8f_html_ad2436bcddc0ca469999b3187b2c8304b"><div class="ttname"><a href="../../d4/d6d/psblas1tst_8f.html#ad2436bcddc0ca469999b3187b2c8304b">psbla1tstinfo</a></div><div class="ttdeci">subroutine psbla1tstinfo(SUMMRY, NOUT, NMAT, NVAL, MXVAL, NXVAL, IMBXVAL, MBXVAL, INBXVAL, NBXVAL, RSCXVAL, CSCXVAL, IXVAL, JXVAL, INCXVAL, MYVAL, NYVAL, IMBYVAL, MBYVAL, INBYVAL, NBYVAL, RSCYVAL, CSCYVAL, IYVAL, JYVAL, INCYVAL, LDVAL, NGRIDS, PVAL, LDPVAL, QVAL, LDQVAL, LTEST, SOF, TEE, IAM, IGAP, IVERB, NPROCS, ALPHA, WORK)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6d/psblas1tst_8f_source.html#l00777">psblas1tst.f:777</a></div></div>
<div class="ttc" id="apsblas1tst_8f_html_a975367b70f76f9100f40e60fbc8ddd6b"><div class="ttname"><a href="../../d4/d6d/psblas1tst_8f.html#a975367b70f76f9100f40e60fbc8ddd6b">pserrscal</a></div><div class="ttdeci">subroutine pserrscal(ERRBND, PSCLR, X, PREC)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6d/psblas1tst_8f_source.html#l03246">psblas1tst.f:3246</a></div></div>
<div class="ttc" id="apsblastst_8f_html_a45fc017f5fe6448f77435b98c2e5f143"><div class="ttname"><a href="../../da/d4c/psblastst_8f.html#a45fc017f5fe6448f77435b98c2e5f143">pschkvin</a></div><div class="ttdeci">subroutine pschkvin(ERRMAX, N, X, PX, IX, JX, DESCX, INCX, INFO)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4c/psblastst_8f_source.html#l02576">psblastst.f:2576</a></div></div>
<div class="ttc" id="apblastst_8f_html_a4d223a80a5e1bca7b339a84ffc2ea180"><div class="ttname"><a href="../../d1/d4b/pblastst_8f.html#a4d223a80a5e1bca7b339a84ffc2ea180">pb_infog2l</a></div><div class="ttdeci">subroutine pb_infog2l(I, J, DESC, NPROW, NPCOL, MYROW, MYCOL, II, JJ, PROW, PCOL)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4b/pblastst_8f_source.html#l01673">pblastst.f:1673</a></div></div>
<div class="ttc" id="apsblastst_8f_html_a9f7b11aef3500003b19b2c0045fa294d"><div class="ttname"><a href="../../da/d4c/psblastst_8f.html#a9f7b11aef3500003b19b2c0045fa294d">psvecee</a></div><div class="ttdeci">subroutine psvecee(ICTXT, NOUT, SUBPTR, SCODE, SNAME)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4c/psblastst_8f_source.html#l00936">psblastst.f:936</a></div></div>
<div class="ttc" id="apsblastst_8f_html_a21215553eb9b46033953f7e246405806"><div class="ttname"><a href="../../da/d4c/psblastst_8f.html#a21215553eb9b46033953f7e246405806">pb_schekpad</a></div><div class="ttdeci">subroutine pb_schekpad(ICTXT, MESS, M, N, A, LDA, IPRE, IPOST, CHKVAL)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4c/psblastst_8f_source.html#l09194">psblastst.f:9194</a></div></div>
<div class="ttc" id="apsblas1tst_8f_html_a05ea0a49ea1b8ef216f72744df4dc831"><div class="ttname"><a href="../../d4/d6d/psblas1tst_8f.html#a05ea0a49ea1b8ef216f72744df4dc831">pserrasum</a></div><div class="ttdeci">subroutine pserrasum(ERRBND, N, USCLR, X, INCX, PREC)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6d/psblas1tst_8f_source.html#l03164">psblas1tst.f:3164</a></div></div>
<div class="ttc" id="apsblastst_8f_html_af5576b27c92043bc8282f79f64b7c53b"><div class="ttname"><a href="../../da/d4c/psblastst_8f.html#af5576b27c92043bc8282f79f64b7c53b">psvprnt</a></div><div class="ttdeci">subroutine psvprnt(ICTXT, NOUT, N, X, INCX, IRPRNT, ICPRNT, CVECNM)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4c/psblastst_8f_source.html#l04056">psblastst.f:4056</a></div></div>
<div class="ttc" id="apsblas1tst_8f_html_aef7dc3dabf5d74e083bda14c3e76cf84"><div class="ttname"><a href="../../d4/d6d/psblas1tst_8f.html#aef7dc3dabf5d74e083bda14c3e76cf84">psblas1tstchke</a></div><div class="ttdeci">subroutine psblas1tstchke(LTEST, INOUT, NPROCS)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6d/psblas1tst_8f_source.html#l01469">psblas1tst.f:1469</a></div></div>
<div class="ttc" id="apsblas1tst_8f_html_a57554860850376f1ecad2714c22dc91b"><div class="ttname"><a href="../../d4/d6d/psblas1tst_8f.html#a57554860850376f1ecad2714c22dc91b">psblas1tstchk</a></div><div class="ttdeci">subroutine psblas1tstchk(ICTXT, NOUT, NROUT, N, PSCLR, PUSCLR, PISCLR, X, PX, IX, JX, DESCX, INCX, Y, PY, IY, JY, DESCY, INCY, INFO)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6d/psblas1tst_8f_source.html#l02211">psblas1tst.f:2211</a></div></div>
<div class="ttc" id="apblastst_8f_html_a977a7a5ad5efccf234a1ac5b23dd18cd"><div class="ttname"><a href="../../d1/d4b/pblastst_8f.html#a977a7a5ad5efccf234a1ac5b23dd18cd">icopy</a></div><div class="ttdeci">subroutine icopy(N, SX, INCX, SY, INCY)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4b/pblastst_8f_source.html#l01525">pblastst.f:1525</a></div></div>
<div class="ttc" id="apsblas1tst_8f_html_ae977aef5034cf8fe8d1f3c2e679fb155"><div class="ttname"><a href="../../d4/d6d/psblas1tst_8f.html#ae977aef5034cf8fe8d1f3c2e679fb155">pserraxpy</a></div><div class="ttdeci">subroutine pserraxpy(ERRBND, PSCLR, X, Y, PREC)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6d/psblas1tst_8f_source.html#l03313">psblas1tst.f:3313</a></div></div>
<div class="ttc" id="apsblas1tst_8f_html_a9bf28f72e7eaa627830597562b0800b1"><div class="ttname"><a href="../../d4/d6d/psblas1tst_8f.html#a9bf28f72e7eaa627830597562b0800b1">pserrnrm2</a></div><div class="ttdeci">subroutine pserrnrm2(ERRBND, N, USCLR, X, INCX, PREC)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6d/psblas1tst_8f_source.html#l03047">psblas1tst.f:3047</a></div></div>
<div class="ttc" id="apsblastst_8f_html_af309b458118977fe95237d297515daba"><div class="ttname"><a href="../../da/d4c/psblastst_8f.html#af309b458118977fe95237d297515daba">pb_pslaprnt</a></div><div class="ttdeci">subroutine pb_pslaprnt(M, N, A, IA, JA, DESCA, IRPRNT, ICPRNT, CMATNM, NOUT, WORK)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4c/psblastst_8f_source.html#l08636">psblastst.f:8636</a></div></div>
<div class="ttc" id="apblastst_8f_html_ac822f48a34940852a1b5ccf19c7dff69"><div class="ttname"><a href="../../d1/d4b/pblastst_8f.html#ac822f48a34940852a1b5ccf19c7dff69">pvdescchk</a></div><div class="ttdeci">subroutine pvdescchk(ICTXT, NOUT, MATRIX, DESCX, DTX, MX, NX, IMBX, INBX, MBX, NBX, RSRCX, CSRCX, INCX, MPX, NQX, IPREX, IMIDX, IPOSTX, IGAP, GAPMUL, INFO)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4b/pblastst_8f_source.html#l00388">pblastst.f:388</a></div></div>
<div class="ttc" id="apblastst_8f_html_a821ce4870ec238e28c06a75f188ec19c"><div class="ttname"><a href="../../d1/d4b/pblastst_8f.html#a821ce4870ec238e28c06a75f188ec19c">pvdimchk</a></div><div class="ttdeci">subroutine pvdimchk(ICTXT, NOUT, N, MATRIX, IX, JX, DESCX, INCX, INFO)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4b/pblastst_8f_source.html#l00003">pblastst.f:3</a></div></div>
<div class="ttc" id="apcgemr_8c_html_a2d017cd3beb218080a7988e2deed2a11"><div class="ttname"><a href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a></div><div class="ttdeci">#define min(A, B)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dad/pcgemr_8c_source.html#l00181">pcgemr.c:181</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_a9e8a9c8fe85d7e824d5b19337467893.html">PBLAS</a></li><li class="navelem"><a class="el" href="../../dir_ff4d11c728a23672ff6edf63ed6b7d8a.html">TESTING</a></li><li class="navelem"><a class="el" href="../../d4/d6d/psblas1tst_8f.html">psblas1tst.f</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
  </ul>
</div>
</body>
</html>
