<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ScaLAPACK 2.1: SRC/slarrv2.f Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../ScaLAPACK logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ScaLAPACK 2.1
   &#160;<span id="projectnumber">2.1</span>
   </div>
   <div id="projectbrief">ScaLAPACK: Scalable Linear Algebra PACKage</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d4/d69/slarrv2_8f_source.html','../../');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">slarrv2.f</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d4/d69/slarrv2_8f.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;      <span class="keyword">SUBROUTINE </span><a class="code" href="../../d4/d69/slarrv2_8f.html#a9f3582f5994be29f7e4b0061e35008dd">slarrv2</a>( N, VL, VU, D, L, PIVMIN,</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;     $                   ISPLIT, M, DOL, DOU, NEEDIL, NEEDIU,</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;     $                   MINRGP, RTOL1, RTOL2, W, WERR, WGAP,</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;     $                   IBLOCK, INDEXW, GERS, SDIAM, </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;     $                   Z, LDZ, ISUPPZ,</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;     $                   WORK, IWORK, VSTART, FINISH, </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;     $                   MAXCLS, NDEPTH, PARITY, ZOFFSET, INFO )</div>
<div class="line"><a name="l00008"></a><span class="lineno"><a class="line" href="../../d4/d69/slarrv2_8f.html#a9f3582f5994be29f7e4b0061e35008dd">    8</a></span>&#160; </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">*  -- ScaLAPACK auxiliary routine (version 2.0) --</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">*     Univ. of Tennessee, Univ. of California Berkeley, Univ. of Colorado Denver</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">*     July 4, 2010</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">*     .. Scalar Arguments ..</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;      <span class="keywordtype">INTEGER</span>            DOL, DOU, INFO, LDZ, M, N, MAXCLS,</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;     $                   NDEPTH, NEEDIL, NEEDIU, PARITY, ZOFFSET</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;      <span class="keywordtype">REAL</span>               MINRGP, PIVMIN, RTOL1, RTOL2, VL, VU</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;      <span class="keywordtype">LOGICAL</span> VSTART, FINISH </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">*     .. Array Arguments ..</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;      <span class="keywordtype">INTEGER</span>            IBLOCK( * ), INDEXW( * ), ISPLIT( * ),</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;     $                   ISUPPZ( * ), IWORK( * )</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="keywordtype">      REAL</span>               D( * ), GERS( * ), L( * ), SDIAM( * ), </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;     $                   w( * ), werr( * ),</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;     $                   wgap( * ), work( * )</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keywordtype">      REAL</span>              Z( LDZ, * )</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">*  Purpose</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">*  =======</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">*  SLARRV2 computes the eigenvectors of the tridiagonal matrix</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">*  T = L D L^T given L, D and APPROXIMATIONS to the eigenvalues of L D L^T.</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">*  The input eigenvalues should have been computed by SLARRE2A</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">*  or by precious calls to SLARRV2.</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">*  The major difference between the parallel and the sequential construction</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">*  of the representation tree is that in the parallel case, not all eigenvalues</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">*  of a given cluster might be computed locally. Other processors might &quot;own&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">*  and refine part of an eigenvalue cluster. This is crucial for scalability. </span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">*  Thus there might be communication necessary before the current level of the </span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">*  representation tree can be parsed. </span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">*  Please note:</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">*  1. The calling sequence has two additional INTEGER parameters, </span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">*     DOL and DOU, that should satisfy M&gt;=DOU&gt;=DOL&gt;=1. </span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">*     These parameters are only relevant for the case JOBZ = &#39;V&#39;.</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">*     SLARRV2  ONLY computes the eigenVECTORS </span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">*     corresponding to eigenvalues DOL through DOU in W. (That is,</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">*     instead of computing the eigenvectors belonging to W(1) </span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">*     through W(M), only the eigenvectors belonging to eigenvalues</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">*     W(DOL) through W(DOU) are computed. In this case, only the</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">*     eigenvalues DOL:DOU are guaranteed to be accurately refined</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">*     to all figures by Rayleigh-Quotient iteration.</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">*  2. The additional arguments VSTART, FINISH, NDEPTH, PARITY, ZOFFSET </span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">*     are included as a thread-safe implementation equivalent to SAVE variables.</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">*     These variables store details about the local representation tree which is</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">*     computed layerwise. For scalability reasons, eigenvalues belonging to the </span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">*     locally relevant representation tree might be computed on other processors.</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">*     These need to be communicated before the inspection of the RRRs can proceed</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">*     on any given layer.           </span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">*     Note that only when the variable FINISH is true, the computation has ended</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">*     All eigenpairs between DOL and DOU have been computed. M is set = DOU - DOL + 1.</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">*  3. SLARRV2 needs more workspace in Z than the sequential SLARRV. </span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">*     It is used to store the conformal embedding of the local representation tree.  </span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">* </span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">*  Arguments</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">*  =========</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">*  N       (input) INTEGER</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">*          The order of the matrix.  N &gt;= 0.</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">*  VL      (input) REAL            </span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">*  VU      (input) REAL            </span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">*          Lower and upper bounds of the interval that contains the desired</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">*          eigenvalues. VL &lt; VU. Needed to compute gaps on the left or right</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">*          end of the extremal eigenvalues in the desired RANGE.</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">*          VU is currently not used but kept as parameter in case needed.</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">*  D       (input/output) REAL             array, dimension (N)</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">*          On entry, the N diagonal elements of the diagonal matrix D.</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">*          On exit, D is overwritten.</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">*  L       (input/output) REAL             array, dimension (N)</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">*          On entry, the (N-1) subdiagonal elements of the unit</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">*          bidiagonal matrix L are in elements 1 to N-1 of L </span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">*          (if the matrix is not splitted.) At the end of each block</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">*          is stored the corresponding shift as given by SLARRE.</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">*          On exit, L is overwritten.</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">*  PIVMIN  (in) DOUBLE PRECISION</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">*          The minimum pivot allowed in the sturm sequence.</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">*  ISPLIT  (input) INTEGER array, dimension (N)</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">*          The splitting points, at which T breaks up into blocks.</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">*          The first block consists of rows/columns 1 to</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">*          ISPLIT( 1 ), the second of rows/columns ISPLIT( 1 )+1</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">*          through ISPLIT( 2 ), etc.</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">*  M       (input) INTEGER</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">*          The total number of input eigenvalues.  0 &lt;= M &lt;= N.</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">*  DOL     (input) INTEGER</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">*  DOU     (input) INTEGER</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">*          If the user wants to compute only selected eigenvectors from all</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">*          the eigenvalues supplied, he can specify an index range DOL:DOU.</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">*          Or else the setting DOL=1, DOU=M should be applied. </span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">*          Note that DOL and DOU refer to the order in which the eigenvalues </span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">*          are stored in W. </span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">*          If the user wants to compute only selected eigenpairs, then</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">*          the columns DOL-1 to DOU+1 of the eigenvector space Z contain the</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">*          computed eigenvectors. All other columns of Z are set to zero.</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">*          If DOL &gt; 1, then Z(:,DOL-1-ZOFFSET) is used.</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">*          If DOU &lt; M, then Z(:,DOU+1-ZOFFSET) is used.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">*  NEEDIL  (input/output) INTEGER</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">*  NEEDIU  (input/output) INTEGER</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">*          Describe which are the left and right outermost eigenvalues </span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">*          that still need to be included in the computation. These indices</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">*          indicate whether eigenvalues from other processors are needed to</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">*          correctly compute the conformally embedded representation tree.</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">*          When DOL&lt;=NEEDIL&lt;=NEEDIU&lt;=DOU, all required eigenvalues are local</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">*          to the processor and no communication is required to compute its</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">*          part of the representation tree.</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">*  MINRGP  (input) REAL            </span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">*          The minimum relativ gap threshold to decide whether an eigenvalue</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">*          or a cluster boundary is reached.</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">*  RTOL1   (input) REAL            </span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">*  RTOL2   (input) REAL            </span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">*           Parameters for bisection.</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">*           An interval [LEFT,RIGHT] has converged if</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">*           RIGHT-LEFT.LT.MAX( RTOL1*GAP, RTOL2*MAX(|LEFT|,|RIGHT|) )</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">*  W       (input/output) REAL             array, dimension (N)</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">*          The first M elements of W contain the APPROXIMATE eigenvalues for</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">*          which eigenvectors are to be computed. The eigenvalues</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">*          should be grouped by split-off block and ordered from</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">*          smallest to largest within the block. (The output array</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">*          W from SSTEGR2A is expected here.) Furthermore, they are with</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">*          respect to the shift of the corresponding root representation</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">*          for their block. On exit, </span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">*          W holds those UNshifted eigenvalues</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">*          for which eigenvectors have already been computed.</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">*  WERR    (input/output) REAL             array, dimension (N)</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">*          The first M elements contain the semiwidth of the uncertainty</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">*          interval of the corresponding eigenvalue in W</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">*  WGAP    (input/output) REAL             array, dimension (N)</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">*          The separation from the right neighbor eigenvalue in W.</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">*  IBLOCK  (input) INTEGER array, dimension (N)</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">*          The indices of the blocks (submatrices) associated with the</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">*          corresponding eigenvalues in W; IBLOCK(i)=1 if eigenvalue</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">*          W(i) belongs to the first block from the top, =2 if W(i)</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">*          belongs to the second block, etc.</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">*  INDEXW  (input) INTEGER array, dimension (N)</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">*          The indices of the eigenvalues within each block (submatrix);</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">*          for example, INDEXW(i)= 10 and IBLOCK(i)=2 imply that the</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">*          i-th eigenvalue W(i) is the 10-th eigenvalue in the second block.</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">*  GERS    (input) REAL             array, dimension (2*N)</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">*          The N Gerschgorin intervals (the i-th Gerschgorin interval</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">*          is (GERS(2*i-1), GERS(2*i)). The Gerschgorin intervals should</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">*          be computed from the original UNshifted matrix.</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">*          Currently NOT used but kept as parameter in case it becomes</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">*          needed in the future.</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">*  SDIAM   (input) REAL             array, dimension (N)</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">*          The spectral diameters for all unreduced blocks.</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">*  Z       (output) REAL             array, dimension (LDZ, max(1,M) )</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">*          If INFO = 0, the first M columns of Z contain the</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">*          orthonormal eigenvectors of the matrix T</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">*          corresponding to the input eigenvalues, with the i-th</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">*          column of Z holding the eigenvector associated with W(i).</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">*          In the distributed version, only a subset of columns</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">*          is accessed, see DOL,DOU and ZOFFSET.</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">*  LDZ     (input) INTEGER</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">*          The leading dimension of the array Z.  LDZ &gt;= 1, and if</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">*          JOBZ = &#39;V&#39;, LDZ &gt;= max(1,N).</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">*  ISUPPZ  (output) INTEGER array, dimension ( 2*max(1,M) )</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">*          The support of the eigenvectors in Z, i.e., the indices</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">*          indicating the nonzero elements in Z. The I-th eigenvector</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">*          is nonzero only in elements ISUPPZ( 2*I-1 ) through</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">*          ISUPPZ( 2*I ).</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">*  WORK    (workspace) REAL             array, dimension (12*N)</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">*  IWORK   (workspace) INTEGER array, dimension (7*N)</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">*  VSTART  (input/output) LOGICAL </span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">*          .TRUE. on initialization, set to .FALSE. afterwards.</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">*  FINISH  (input/output) LOGICAL </span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">*          A flag that indicates whether all eigenpairs have been computed.</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">*  MAXCLS  (input/output) INTEGER</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">*          The largest cluster worked on by this processor in the </span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">*          representation tree.</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">*  NDEPTH  (input/output) INTEGER</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">*          The current depth of the representation tree. Set to</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">*          zero on initial pass, changed when the deeper levels of</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">*          the representation tree are generated. </span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">*  PARITY  (input/output) INTEGER</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">*          An internal parameter needed for the storage of the</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">*          clusters on the current level of the representation tree.</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">*  ZOFFSET (input) INTEGER</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">*          Offset for storing the eigenpairs when Z is distributed</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">*          in 1D-cyclic fashion.</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">*  INFO    (output) INTEGER</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">*          = 0:  successful exit</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">*          &gt; 0:  A problem occured in SLARRV2.</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">*          &lt; 0:  One of the called subroutines signaled an internal problem. </span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">*                Needs inspection of the corresponding parameter IINFO</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">*                for further information.</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">*          =-1:  Problem in SLARRB2 when refining a child&#39;s eigenvalues.</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">*          =-2:  Problem in SLARRF2 when computing the RRR of a child.</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">*                When a child is inside a tight cluster, it can be difficult</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">*                to find an RRR. A partial remedy from the user&#39;s point of</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">*                view is to make the parameter MINRGP smaller and recompile.</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">*                However, as the orthogonality of the computed vectors is </span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">*                proportional to 1/MINRGP, the user should be aware that </span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">*                he might be trading in precision when he decreases MINRGP.</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">*          =-3:  Problem in SLARRB2 when refining a single eigenvalue</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">*                after the Rayleigh correction was rejected.</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">*          = 5:  The Rayleigh Quotient Iteration failed to converge to </span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">*                full accuracy in MAXITR steps.</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">*  =====================================================================</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">*     .. Parameters ..</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="keywordtype">INTEGER</span>            MAXITR, USE30, USE31, USE32A, USE32B</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="keywordtype">PARAMETER</span>          ( MAXITR = 10, use30=30, use31=31, </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;     $                     use32a=3210, use32b = 3211 )</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="keywordtype">      REAL</span>               ZERO, ONE, TWO, THREE, FOUR, HALF</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <span class="keywordtype">PARAMETER</span>          ( ZERO = 0.0e0, one = 1.0e0, </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;     $                     two = 2.0e0, three = 3.0e0,</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;     $                     four = 4.0e0, half = 0.5e0)</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">*     .. Local Arrays ..</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="keywordtype">INTEGER</span>            SPLACE( 4 )</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">*     .. Local Scalars ..</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="keywordtype">LOGICAL</span>            DELREF, ESKIP, NEEDBS, ONLYLC, STP2II, TRYMID,</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;     $                   TRYRQC, USEDBS, USEDRQ</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="keywordtype">INTEGER</span>            I, IBEGIN, IEND, II, IINCLS, IINDC1, IINDC2,</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;     $                   iindwk, iinfo, im, in, indeig, indld, indlld,</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;     $                   indwrk, isupmn, isupmx, iter, itmp1, itwist, j,</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;     $                   jblk, k, kk, miniwsize, minwsize, mywfst,</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;     $                   mywlst, nclus, negcnt, newcls, newfst, newftt,</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;     $                   newlst, newsiz, offset, oldcls, oldfst, oldien,</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;     $                   oldlst, oldncl, p, q, vrtree, wbegin, wend,</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;     $                   windex, windmn, windpl, zfrom, zindex, zto,</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;     $                   zusedl, zusedu, zusedw</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="keywordtype">      REAL</span>               AVGAP, BSTRES, BSTW, ENUFGP, EPS, FUDGE, GAP,</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;     $                   GAPTOL, LAMBDA, LEFT, LGAP, LGPVMN, LGSPDM,</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;     $                   LOG_IN, MGAP, MINGMA, MYERR, NRMINV, NXTERR,</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;     $                   ORTOL, RESID, RGAP, RIGHT, RLTL30, RQCORR,</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;     $                   RQTOL, SAVEGP, SGNDEF, SIGMA, SPDIAM, SSIGMA,</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;     $                   TAU, TMP, TOL, ZTZ</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">*     .. External Functions ..</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="keywordtype">      REAL</span>              SLAMCH</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="keywordtype">REAL</span>               SDOT, SNRM2</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="keywordtype">EXTERNAL</span>           SDOT, SLAMCH, SNRM2</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">*     .. External Subroutines ..</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="keywordtype">EXTERNAL</span>           SAXPY, SCOPY, SLAR1VA, SLARRB2,</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;     $                   <a class="code" href="../../d7/db3/slarrf2_8f.html#adb7f59f6153d9f99ea0bb3304fc6937e">slarrf2</a>, slaset, sscal</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">*     .. Intrinsic Functions ..</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <span class="keywordtype">INTRINSIC</span> abs, real, <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>, <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>, sqrt</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">*     .. Executable Statements ..</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      info = 0</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">*     The first N entries of WORK are reserved for the eigenvalues</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      indld = n+1</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      indlld= 2*n+1</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      indwrk= 3*n+1</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      minwsize = 12 * n</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">*     IWORK(IINCLS+JBLK) holds the number of clusters on the current level </span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">*     of the reptree for block JBLK  </span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      iincls = 0</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">*     IWORK(IINDC1+1:IINC2+N) are used to store the clusters of the current</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">*     layer and the one above.</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      iindc1 = n</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      iindc2 = 2*n</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      iindwk = 3*n + 1</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      miniwsize = 7 * n</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      eps = slamch( <span class="stringliteral">&#39;Precision&#39;</span> )</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      rqtol = two * eps</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      tryrqc = .true.</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">*     Decide which representation tree criterion to use</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">*     USE30 = Lapack 3.0 criterion</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">*     USE31 = LAPACK 3.1 criterion</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">*     USE32A = two criteria, determines singletons with USE31, and groups with avgap.</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">*     USE32B = two criteria, determines singletons with USE31, and groups with USE30.</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      vrtree = use32a</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      lgpvmn = log( pivmin )</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <span class="keywordflow">IF</span>(vstart) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">*      </span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">*        PREPROCESSING, DONE ONLY IN THE FIRST CALL</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;         vstart = .false.   </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;         maxcls = 1</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">*        Set delayed eigenvalue refinement</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">*        In order to enable more parallelism, refinement</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">*        must be done immediately and cannot be delayed until</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">*        the next representation tree level.</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;         delref = .false.</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;         <span class="keywordflow">DO</span> 1 i= 1,minwsize</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            work( i ) = zero </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; 1       <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;         <span class="keywordflow">DO</span> 2 i= 1,miniwsize</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            iwork( i ) = 0</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; 2       <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;         zusedl = 1</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;         <span class="keywordflow">IF</span>(dol.GT.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">*           Set lower bound for use of Z</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            zusedl = dol-1</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="keywordflow">         ENDIF</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;         zusedu = m</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;         <span class="keywordflow">IF</span>(dou.LT.m) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">*           Set lower bound for use of Z</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            zusedu = dou+1</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="keywordflow">         ENDIF</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">*        The width of the part of Z that is used</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;         zusedw = zusedu - zusedl + 1</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;         <span class="keyword">CALL </span>slaset( <span class="stringliteral">&#39;Full&#39;</span>, n, zusedw, zero, zero, </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;     $                    z(1,(zusedl-zoffset)), ldz )</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">*        Initialize NDEPTH, the current depth of the representation tree</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;         ndepth = 0</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">*        Initialize parity </span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;         parity = 1</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">*        Go through blocks, initialize data structures</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;         ibegin = 1</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;         wbegin = 1</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;         <span class="keywordflow">DO</span> 10 jblk = 1, iblock( m )</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            iend = isplit( jblk )</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            sigma = l( iend )</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            wend = wbegin - 1</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; 3          <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            <span class="keywordflow">IF</span>( wend.LT.m ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;               <span class="keywordflow">IF</span>( iblock( wend+1 ).EQ.jblk ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                  wend = wend + 1</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                  <span class="keywordflow">GO TO</span> 3</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            <span class="keywordflow">IF</span>( wend.LT.wbegin ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;               iwork( iincls + jblk ) = 0</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;               ibegin = iend + 1</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;               <span class="keywordflow">GO TO</span> 10</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            <span class="keywordflow">ELSEIF</span>( (wend.LT.dol).OR.(wbegin.GT.dou) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;               iwork( iincls + jblk ) = 0</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;               ibegin = iend + 1</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;               wbegin = wend + 1</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;               <span class="keywordflow">GO TO</span> 10</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">*           The number of eigenvalues in the current block</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            im = wend - wbegin + 1</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">*           This is for a 1x1 block</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            <span class="keywordflow">IF</span>( ibegin.EQ.iend ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;               iwork( iincls + jblk ) = 0</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;               z( ibegin, (wbegin-zoffset) ) = one</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;               isuppz( 2*wbegin-1 ) = ibegin</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;               isuppz( 2*wbegin ) = ibegin</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;               w( wbegin ) = w( wbegin ) + sigma</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;               work( wbegin ) = w( wbegin )</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;               ibegin = iend + 1</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;               wbegin = wbegin + 1</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;               <span class="keywordflow">GO TO</span> 10</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            <span class="keyword">CALL </span>scopy( im, w( wbegin ), 1, </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;     &amp;                work( wbegin ), 1 )    </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">*           We store in W the eigenvalue approximations w.r.t. the original</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">*           matrix T.</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            <span class="keywordflow">DO</span> 5 i=1,im</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;               w(wbegin+i-1) = w(wbegin+i-1)+sigma</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; 5          <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">*           Initialize cluster counter for this block</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            iwork( iincls + jblk ) = 1</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            iwork( iindc1+ibegin ) = 1</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            iwork( iindc1+ibegin+1 ) = im</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            ibegin = iend + 1</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            wbegin = wend + 1</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;10       <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="keywordflow">      ENDIF</span> </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">*     Init NEEDIL and NEEDIU</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      needil = dou</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      neediu = dol      </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">*     Here starts the main loop</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">*     Only one pass through the loop is done until no collaboration</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">*     with other processors is needed. </span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; 40   <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      parity = 1 - parity</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">*     For each block, build next level of representation tree</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">*     if there are still remaining clusters </span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      ibegin = 1</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      wbegin = 1</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <span class="keywordflow">DO</span> 170 jblk = 1, iblock( m )</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;         iend = isplit( jblk )</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;         sigma = l( iend )</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">*        Find the eigenvectors of the submatrix indexed IBEGIN</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">*        through IEND.</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;         <span class="keywordflow">IF</span>(m.EQ.n) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">*           all eigenpairs are computed</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            wend = iend</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;         <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">*           count how many wanted eigenpairs are in this block</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            wend = wbegin - 1</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; 15         <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            <span class="keywordflow">IF</span>( wend.LT.m ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;               <span class="keywordflow">IF</span>( iblock( wend+1 ).EQ.jblk ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                  wend = wend + 1</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                  <span class="keywordflow">GO TO</span> 15</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="keywordflow">         ENDIF</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;         oldncl = iwork( iincls + jblk )</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;         <span class="keywordflow">IF</span>( oldncl.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            ibegin = iend + 1</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            wbegin = wend + 1</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            <span class="keywordflow">GO TO</span> 170</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">*        OLDIEN is the last index of the previous block</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;         oldien = ibegin - 1</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">*        Calculate the size of the current block</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;         in = iend - ibegin + 1</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">*        The number of eigenvalues in the current block</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;         im = wend - wbegin + 1</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">*        Find local spectral diameter of the block</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;         spdiam = sdiam(jblk)</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;         lgspdm = log( spdiam + pivmin )</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">*        Compute ORTOL parameter, similar to SSTEIN</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;         ortol = spdiam*1.0e-3</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">*        Compute average gap</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;         avgap = spdiam/real(in-1)</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">*        Compute the minimum of average gap and ORTOL parameter </span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">*        This can used as a lower bound for acceptable separation </span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">*        between eigenvalues </span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;         enufgp = <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>(ortol,avgap)</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">*        Any 1x1 block has been treated before</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">*        loop while( OLDNCLS.GT.0 )</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">*        generate the next representation tree level for the current block</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;         <span class="keywordflow">IF</span>( oldncl.GT.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">*           This is a crude protection against infinitely deep trees</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            <span class="keywordflow">IF</span>( ndepth.GT.m ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;               info = -2</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;               <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="keywordflow">            ENDIF</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">*           breadth first processing of the current level of the representation</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">*           tree: OLDNCL = number of clusters on current level</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">*           NCLUS is the number of clusters for the next level of the reptree</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">*           reset NCLUS to count the number of child clusters </span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            nclus = 0</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            log_in = log(real(in))</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            rltl30 = <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( 1.0e-2, one / real( in ) )</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            <span class="keywordflow">IF</span>( parity.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;               oldcls = iindc1+ibegin-1</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;               newcls = iindc2+ibegin-1</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;               oldcls = iindc2+ibegin-1</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;               newcls = iindc1+ibegin-1</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">*           Process the clusters on the current level</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            <span class="keywordflow">DO</span> 150 i = 1, oldncl</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;               j = oldcls + 2*i</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">*              OLDFST, OLDLST = first, last index of current cluster.</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">*                               cluster indices start with 1 and are relative</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">*                               to WBEGIN when accessing W, WGAP, WERR, Z</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;               oldfst = iwork( j-1 )</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;               oldlst = iwork( j )</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;               <span class="keywordflow">IF</span>( ndepth.GT.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">*                 Retrieve relatively robust representation (RRR) of cluster</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">*                 that has been computed at the previous level</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">*                 The RRR is stored in Z and overwritten once the eigenvectors</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">*                 have been computed or when the cluster is refined </span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                  <span class="keywordflow">IF</span>((dol.EQ.1).AND.(dou.EQ.m)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">*                    Get representation from location of the leftmost evalue</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">*                    of the cluster</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                     j = wbegin + oldfst - 1</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                     <span class="keywordflow">IF</span>(wbegin+oldfst-1.LT.dol) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">*                       Get representation from the left end of Z array </span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                        j = dol - 1</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                     <span class="keywordflow">ELSEIF</span>(wbegin+oldfst-1.GT.dou) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">*                       Get representation from the right end of Z array </span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                        j = dou</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                        j = wbegin + oldfst - 1</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="keywordflow">                     ENDIF</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="keywordflow">                  ENDIF</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                  <span class="keyword">CALL </span>scopy( in, z( ibegin, (j-zoffset) ), </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;     $               1, d( ibegin ), 1 )</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                  <span class="keyword">CALL </span>scopy( in-1, z( ibegin, (j+1-zoffset) ), </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;     $               1, l( ibegin ),1 )</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                  sigma = z( iend, (j+1-zoffset) )</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">*                 Set the corresponding entries in Z to zero</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                  <span class="keyword">CALL </span>slaset( <span class="stringliteral">&#39;Full&#39;</span>, in, 2, zero, zero,</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;     $                         z( ibegin, (j-zoffset) ), ldz )</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">*              Compute DL and DLL of current RRR</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;               <span class="keywordflow">DO</span> 50 j = ibegin, iend-1</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                  tmp = d( j )*l( j )</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                  work( indld-1+j ) = tmp</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                  work( indlld-1+j ) = tmp*l( j )</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;   50          <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;               <span class="keywordflow">IF</span>( ndepth.GT.0 .AND. delref ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">*                 P and Q are index of the first and last eigenvalue to compute</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">*                 within the current block</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                  p = indexw( wbegin-1+oldfst )</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                  q = indexw( wbegin-1+oldlst )</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">*                 Offset for the arrays WORK, WGAP and WERR, i.e., th P-OFFSET</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">*                 thru&#39; Q-OFFSET elements of these arrays are to be used.</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">C                  OFFSET = P-OLDFST</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                  offset = indexw( wbegin ) - 1</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">*                 perform limited bisection (if necessary) to get approximate </span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">*                 eigenvalues to the precision needed.</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                  <span class="keyword">CALL </span>slarrb2( in, d( ibegin ), </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;     $                         work(indlld+ibegin-1),</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;     $                         p, q, rtol1, rtol2, offset, </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;     $                         work(wbegin),wgap(wbegin),werr(wbegin),</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;     $                         work( indwrk ), iwork( iindwk ),</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;     $                         pivmin, lgpvmn, lgspdm, in, iinfo )</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                  <span class="keywordflow">IF</span>( iinfo.NE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                     info = -1</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                     <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="keywordflow">                  ENDIF</span>       </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">*                 We also recompute the extremal gaps. W holds all eigenvalues</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">*                 of the unshifted matrix and must be used for computation</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">*                 of WGAP, the entries of WORK might stem from RRRs with </span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">*                 different shifts. The gaps from WBEGIN-1+OLDFST to</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">*                 WBEGIN-1+OLDLST are correctly computed in SLARRB2.</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">*                 However, we only allow the gaps to become greater since </span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">*                 this is what should happen when we decrease WERR</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                  <span class="keywordflow">IF</span>( oldfst.GT.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                     wgap( wbegin+oldfst-2 ) = </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;     $             <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>(wgap(wbegin+oldfst-2),</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;     $                 w(wbegin+oldfst-1)-werr(wbegin+oldfst-1) </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;     $                 - w(wbegin+oldfst-2)-werr(wbegin+oldfst-2) )</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="keywordflow">                  ENDIF</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                  <span class="keywordflow">IF</span>( wbegin + oldlst -1 .LT. wend ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                     wgap( wbegin+oldlst-1 ) = </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;     $               <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>(wgap(wbegin+oldlst-1), </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;     $                   w(wbegin+oldlst)-werr(wbegin+oldlst) </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;     $                   - w(wbegin+oldlst-1)-werr(wbegin+oldlst-1) )</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="keywordflow">                  ENDIF</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">*                 Each time the eigenvalues in WORK get refined, we store</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">*                 the newly found approximation with all shifts applied in W</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                  <span class="keywordflow">DO</span> 53 j=oldfst,oldlst</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                     w(wbegin+j-1) = work(wbegin+j-1)+sigma</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; 53               <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;               <span class="keywordflow">ELSEIF</span>( (ndepth.EQ.0) .OR. (.NOT.delref) ) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">*                 Some of the eigenvalues might have been computed on</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">*                 other processors                  </span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">*                 Recompute gaps for this cluster </span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">*                 (all eigenvalues have the same</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">*                 representation, i.e. the same shift, so this is easy)</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                  <span class="keywordflow">DO</span> 54 j = oldfst, oldlst-1</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                     myerr = werr(wbegin + j - 1) </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                     nxterr = werr(wbegin + j )</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                     wgap(wbegin+j-1) = <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>(wgap(wbegin+j-1),</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;     $                    (   work(wbegin+j) - nxterr ) </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;     $                  - ( work(wbegin+j-1) + myerr )</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;     $                                     )</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; 54               <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="keywordflow">               END IF</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">*              Process the current node.</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;               newfst = oldfst</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;               <span class="keywordflow">DO</span> 140 j = oldfst, oldlst</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                  <span class="keywordflow">IF</span>( j.EQ.oldlst ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">*                    we are at the right end of the cluster, this is also the</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">*                    boundary of the child cluster                    </span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                     newlst = j</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                  <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                     <span class="keywordflow">IF</span> (vrtree.EQ.use30) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                        <span class="keywordflow">IF</span>(wgap( wbegin + j -1).GE.</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;     $                     rltl30 * abs(work(wbegin + j -1)) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">*                          the right relgap is big enough by the Lapack 3.0 criterion</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                           newlst = j</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">*                          inside a child cluster, the relative gap is not</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">*                          big enough.</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                           <span class="keywordflow">GOTO</span> 140</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="keywordflow">            ENDIF</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                     <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (vrtree.EQ.use31) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                        <span class="keywordflow">IF</span> ( wgap( wbegin + j -1).GE.</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;     $                      minrgp* abs( work(wbegin + j -1) ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">*                          the right relgap is big enough by the Lapack 3.1 criterion</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">*                          (NEWFST,..,NEWLST) is well separated from the following </span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                           newlst = j</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">*                          inside a child cluster, the relative gap is not</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">*                          big enough.</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                           <span class="keywordflow">GOTO</span> 140</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="keywordflow">            ENDIF</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                     <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (vrtree.EQ.use32a) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                        <span class="keywordflow">IF</span>( (j.EQ.oldfst).AND.( wgap(wbegin+j-1).GE.</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;     $                      minrgp* abs(work(wbegin+j-1)) ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment">*                          the right relgap is big enough by the Lapack 3.1 criterion</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment">*                          Found a singleton</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                           newlst = j</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( (j.GT.oldfst).AND.(j.EQ.newfst).AND.</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;     $                           ( wgap(wbegin+j-2).GE.</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;     $                             minrgp* abs(work(wbegin+j-1)) ).AND. </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;     $                           ( wgap(wbegin+j-1).GE.</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;     $                             minrgp* abs(work(wbegin+j-1)) ) </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;     $                     ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">*                          Found a singleton</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                           newlst = j</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( (j.GT.newfst).AND.wgap(wbegin+j-1).GE.</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;     $                     (minrgp*abs(work(wbegin+j-1)) ) ) </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;     $                     <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">*                          the right relgap is big enough by the Lapack 3.1 criterion</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                           newlst = j</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>((j.GT.newfst).AND.(j+1.LT.oldlst).AND.</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;     $                     (wgap(wbegin+j-1).GE.enufgp))</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;     $                     <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">*                          the right gap is bigger than ENUFGP</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">*                          Care needs to be taken with this criterion to make</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">*                          sure it does not create a remaining `false&#39; singleton</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                           newlst = j</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">*                          inside a child cluster, the relative gap is not</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">*                          big enough.</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                           <span class="keywordflow">GOTO</span> 140</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="keywordflow">            ENDIF</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                     <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (vrtree.EQ.use32b) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                        <span class="keywordflow">IF</span>( (j.EQ.oldfst).AND.( wgap(wbegin+j-1).GE.</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;     $                      minrgp* abs(work(wbegin+j-1)) ) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">*                          the right relgap is big enough by the Lapack 3.1 criterion</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">*                          Found a singleton</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                           newlst = j</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( (j.GT.oldfst).AND.(j.EQ.newfst).AND.</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;     $                           ( wgap(wbegin+j-2).GE.</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;     $                             minrgp* abs(work(wbegin+j-1)) ).AND. </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;     $                           ( wgap(wbegin+j-1).GE.</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;     $                             minrgp* abs(work(wbegin+j-1)) ) </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;     $                     ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">*                          Found a singleton</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                           newlst = j</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>( (j.GT.newfst).AND.wgap(wbegin+j-1).GE.</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;     $                     (minrgp*abs(work(wbegin+j-1)) ) ) </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;     $                     <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment">*                          the right relgap is big enough by the Lapack 3.1 criterion</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                           newlst = j</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>((j.GT.newfst).AND.(j+1.LT.oldlst).AND.</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;     $                     (wgap( wbegin + j -1).GE.</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;     $                     rltl30 * abs(work(wbegin + j -1)) ))</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;     $                     <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">*                          the right relgap is big enough by the Lapack 3.0 criterion</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">*                          Care needs to be taken with this criterion to make</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">*                          sure it does not create a remaining `false&#39; singleton</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                           newlst = j</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">*                          inside a child cluster, the relative gap is not</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">*                          big enough.</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                           <span class="keywordflow">GOTO</span> 140</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="keywordflow">            ENDIF</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="keywordflow">                     END IF</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">*                 Compute size of child cluster found</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                  newsiz = newlst - newfst + 1</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                  maxcls = <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( newsiz, maxcls )</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment">*                 NEWFTT is the place in Z where the new RRR or the computed</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">*                 eigenvector is to be stored</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                  <span class="keywordflow">IF</span>((dol.EQ.1).AND.(dou.EQ.m)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">*                    Store representation at location of the leftmost evalue</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">*                    of the cluster</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                     newftt = wbegin + newfst - 1</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                     <span class="keywordflow">IF</span>(wbegin+newfst-1.LT.dol) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">*                       Store representation at the left end of Z array </span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                        newftt = dol - 1</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                     <span class="keywordflow">ELSEIF</span>(wbegin+newfst-1.GT.dou) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">*                       Store representation at the right end of Z array </span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                        newftt = dou</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                        newftt = wbegin + newfst - 1</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="keywordflow">                     ENDIF</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="keywordflow">                  ENDIF</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment">*                 FOR 1D-DISTRIBUTED Z, COMPUTE NEWFTT SHIFTED BY ZOFFSET</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                  newftt = newftt - zoffset</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                  <span class="keywordflow">IF</span>( newsiz.GT.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment">*                    Current child is not a singleton but a cluster.</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                     <span class="keywordflow">IF</span>((wbegin+newlst-1.LT.dol).OR.</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;     $                  (wbegin+newfst-1.GT.dou)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">*                       if the cluster contains no desired eigenvalues</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">*                       skip the computation of that branch of the rep. tree</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                        <span class="keywordflow">GOTO</span> 139</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="keywordflow">                     ENDIF</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">*                    Compute left and right cluster gap.</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                     <span class="keywordflow">IF</span>( newfst.EQ.1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                        lgap = <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( zero, </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;     $                       w(wbegin)-werr(wbegin) - vl )</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                        lgap = wgap( wbegin+newfst-2 )</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="keywordflow">                     ENDIF</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                     rgap = wgap( wbegin+newlst-1 )</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">*                    For larger clusters, record the largest gap observed </span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">*                    somewhere near the middle of the cluster as a possible </span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment">*                    alternative position for a shift when TRYMID is TRUE</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment">*            </span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                     mgap = zero</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                     <span class="keywordflow">IF</span>(newsiz.GE.50) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                        kk = newfst</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                        <span class="keywordflow">DO</span> 545 k =newfst+newsiz/3,newlst-newsiz/3</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                   <span class="keywordflow">IF</span>(mgap.LT.wgap( wbegin+k-1 )) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                      kk = k</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                      mgap = wgap( wbegin+k-1 )</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="keywordflow">                           ENDIF</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; 545                    <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="keywordflow">                     ENDIF</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;             </div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment">*                    Record the left- and right-most eigenvalues needed</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment">*                    for the next level of the representation tree</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                     needil = <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>(needil,wbegin+newfst-1)</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                     neediu = <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>(neediu,wbegin+newlst-1)</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment">*                    Check if middle gap is large enough to shift there</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                     gap = <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>(lgap,rgap)</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;             trymid = (mgap.GT.gap)</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160; </div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;             splace(1) = newfst</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;             splace(2) = newlst</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;             <span class="keywordflow">IF</span>(trymid) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                splace(3) = kk</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                        splace(4) = kk+1</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;             <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                splace(3) = newfst</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                splace(4) = newlst</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="keywordflow">             ENDIF</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment">*                    Compute left- and rightmost eigenvalue of child</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment">*                    to high precision in order to shift as close</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment">*                    as possible and obtain as large relative gaps</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment">*                    as possible</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160; </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                     <span class="keywordflow">DO</span> 55 k =1,4</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                        p = indexw( wbegin-1+splace(k) )</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                        offset = indexw( wbegin ) - 1</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                        <span class="keyword">CALL </span>slarrb2( in, d(ibegin), </div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;     $                       work( indlld+ibegin-1 ),p,p,</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;     $                       rqtol, rqtol, offset, </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;     $                       work(wbegin),wgap(wbegin),</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;     $                       werr(wbegin),work( indwrk ), </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;     $                       iwork( iindwk ), </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;     $                       pivmin, lgpvmn, lgspdm, in, iinfo )</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160; 55                  <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">*                    Compute RRR of child cluster.</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment">*                    Note that the new RRR is stored in Z                     </span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">C                    SLARRF2 needs LWORK = 2*N</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                     <span class="keyword">CALL </span><a class="code" href="../../d7/db3/slarrf2_8f.html#adb7f59f6153d9f99ea0bb3304fc6937e">slarrf2</a>( in, d( ibegin ), l( ibegin ),</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;     $                         work(indld+ibegin-1), </div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;     $                         splace(1), splace(2), </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;     $                         splace(3), splace(4), work(wbegin),</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;     $                         wgap(wbegin), werr(wbegin), trymid,</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;     $                         spdiam, lgap, rgap, pivmin, tau, </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;     $                         z( ibegin, newftt ),</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;     $                         z( ibegin, newftt+1 ),</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;     $                         work( indwrk ), iinfo )</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                     <span class="keywordflow">IF</span>( iinfo.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment">*                       a new RRR for the cluster was found by SLARRF2</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment">*                       update shift and store it         </span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                        ssigma = sigma + tau</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                        z( iend, newftt+1 ) = ssigma</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment">*                       WORK() are the midpoints and WERR() the semi-width</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment">*                       Note that the entries in W are unchanged.</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                        <span class="keywordflow">DO</span> 116 k = newfst, newlst</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                           fudge = </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;     $                          three*eps*abs(work(wbegin+k-1))</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                           work( wbegin + k - 1 ) = </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;     $                          work( wbegin + k - 1) - tau</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                           fudge = fudge + </div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;     $                          four*eps*abs(work(wbegin+k-1))</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment">*                          Fudge errors</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                           werr( wbegin + k - 1 ) =</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;     $                          werr( wbegin + k - 1 ) + fudge</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; 116                    <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160; </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                        nclus = nclus + 1</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                        k = newcls + 2*nclus</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                        iwork( k-1 ) = newfst</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                        iwork( k ) = newlst</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                        <span class="keywordflow">IF</span>(.NOT.delref) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                           onlylc = .true.</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                           <span class="keywordflow">IF</span>(onlylc) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                              mywfst = <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>(wbegin-1+newfst,dol-1)</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                              mywlst = <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>(wbegin-1+newlst,dou+1)</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                           <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                              mywfst = wbegin-1+newfst</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                              mywlst = wbegin-1+newlst </div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="keywordflow">                           ENDIF</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160; </div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">*                          Compute LLD of new RRR</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                           <span class="keywordflow">DO</span> 5000 k = ibegin, iend-1</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                              work( indwrk-1+k ) = </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;     $                        z(k,newftt)*</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;     $                       (z(k,newftt+1)**2)</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160; 5000                      <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment">*                          P and Q are index of the first and last </span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment">*                          eigenvalue to compute within the new cluster</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                           p = indexw( mywfst )</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                           q = indexw( mywlst )</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment">*                          Offset for the arrays WORK, WGAP and WERR</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                           offset = indexw( wbegin ) - 1</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="comment">*                          perform limited bisection (if necessary) to get approximate </span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="comment">*                          eigenvalues to the precision needed.</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                           <span class="keyword">CALL </span>slarrb2( in, </div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;     $                         z(ibegin, newftt ),</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;     $                         work(indwrk+ibegin-1),</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;     $                         p, q, rtol1, rtol2, offset, </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;     $                         work(wbegin),wgap(wbegin),werr(wbegin),</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;     $                         work( indwrk+n ), iwork( iindwk ),</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;     $                         pivmin, lgpvmn, lgspdm, in, iinfo )</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                           <span class="keywordflow">IF</span>( iinfo.NE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                              info = -1</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                              <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="keywordflow">                           ENDIF</span>       </div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">*                          Each time the eigenvalues in WORK get refined, we store</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment">*                          the newly found approximation with all shifts applied in W</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                           <span class="keywordflow">DO</span> 5003 k=newfst,newlst</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                              w(wbegin+k-1) = work(wbegin+k-1)+ssigma</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160; 5003                      <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="keywordflow">                        ENDIF</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                     <span class="keywordflow">ELSE</span>    </div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                        info = -2</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                        <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="keywordflow">                     ENDIF</span>      </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment">*                    Compute eigenvector of singleton</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                     iter = 0</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment">*                    </span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                     tol = four * log_in * eps</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                     k = newfst</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                     windex = wbegin + k - 1</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                     zindex = windex - zoffset</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                     windmn = <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>(windex - 1,1)</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                     windpl = <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>(windex + 1,m)</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                     lambda = work( windex )</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="comment">*                    Check if eigenvector computation is to be skipped</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                     <span class="keywordflow">IF</span>((windex.LT.dol).OR.</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;     $                  (windex.GT.dou)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                        eskip = .true.</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                        <span class="keywordflow">GOTO</span> 125</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                        eskip = .false.</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="keywordflow">                     ENDIF</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                     left = work( windex ) - werr( windex )</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                     right = work( windex ) + werr( windex )</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                     indeig = indexw( windex )</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                     <span class="keywordflow">IF</span>( k .EQ. 1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                        lgap = eps*<a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>(abs(left),abs(right))</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                        lgap = wgap(windmn)</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="keywordflow">                     ENDIF</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                     <span class="keywordflow">IF</span>( k .EQ. im) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                        rgap = eps*<a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>(abs(left),abs(right))</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                        rgap = wgap(windex)</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="keywordflow">                     ENDIF</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                     gap = <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>( lgap, rgap )</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                     <span class="keywordflow">IF</span>(( k .EQ. 1).OR.(k .EQ. im)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                        gaptol = zero</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                        gaptol = gap * eps</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="keywordflow">                     ENDIF</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                     isupmn = in</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                     isupmx = 1</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">*                    Update WGAP so that it holds the minimum gap </span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">*                    to the left or the right. This is crucial in the</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">*                    case where bisection is used to ensure that the</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">*                    eigenvalue is refined up to the required precision.</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">*                    The correct value is restored afterwards.</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                     savegp = wgap(windex)</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                     wgap(windex) = gap</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">*                    We want to use the Rayleigh Quotient Correction</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">*                    as often as possible since it converges quadratically</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment">*                    when we are close enough to the desired eigenvalue.</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="comment">*                    However, the Rayleigh Quotient can have the wrong sign</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="comment">*                    and lead us away from the desired eigenvalue. In this</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="comment">*                    case, the best we can do is to use bisection.</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                     usedbs = .false.</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                     usedrq = .false.</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment">*                    Bisection is initially turned off unless it is forced</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                     needbs =  .NOT.tryrqc </div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">*                    Reset ITWIST</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                     itwist = 0</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160; 120                 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment">*                    Check if bisection should be used to refine eigenvalue</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                     <span class="keywordflow">IF</span>(needbs) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="comment">*                       Take the bisection as new iterate</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                        usedbs = .true.</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="comment">*                       Temporary copy of twist index needed</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                        itmp1 = itwist</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                        offset = indexw( wbegin ) - 1</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                        <span class="keyword">CALL </span>slarrb2( in, d(ibegin), </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;     $                       work(indlld+ibegin-1),indeig,indeig,</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;     $                       zero, two*eps, offset, </div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;     $                       work(wbegin),wgap(wbegin),</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;     $                       werr(wbegin),work( indwrk ), </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;     $                       iwork( iindwk ), </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;     $                       pivmin, lgpvmn, lgspdm, itmp1, iinfo )</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                        <span class="keywordflow">IF</span>( iinfo.NE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                           info = -3</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                           <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="keywordflow">                        ENDIF</span>       </div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                        lambda = work( windex )</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment">*                       Reset twist index from inaccurate LAMBDA to</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">*                       force computation of true MINGMA  </span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                        itwist = 0</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="keywordflow">                     ENDIF</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment">*                    Given LAMBDA, compute the eigenvector.</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                     <span class="keyword">CALL </span>slar1va( in, 1, in, lambda, d(ibegin),</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;     $                    l( ibegin ), work(indld+ibegin-1), </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;     $                    work(indlld+ibegin-1),</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;     $                    pivmin, gaptol, z( ibegin, zindex),</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;     $                    .NOT.usedbs, negcnt, ztz, mingma,</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;     $                    itwist, isuppz( 2*windex-1 ),</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;     $                    nrminv, resid, rqcorr, work( indwrk ) )</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                     <span class="keywordflow">IF</span>(iter .EQ. 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                        bstres = resid</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                        bstw = lambda</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                     <span class="keywordflow">ELSEIF</span>(resid.LT.bstres) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                        bstres = resid</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                        bstw = lambda</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="keywordflow">                     ENDIF</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                     isupmn = <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>(isupmn,isuppz( 2*windex-1 ))</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                     isupmx = <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>(isupmx,isuppz( 2*windex ))</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                     iter = iter + 1</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment">*            </span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment">*                    Convergence test for Rayleigh-Quotient iteration</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">*                    (omitted when Bisection has been used)</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                     <span class="keywordflow">IF</span>( resid.GT.tol*gap .AND. abs( rqcorr ).GT.</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;     $                    rqtol*abs( lambda ) .AND. .NOT. usedbs) </div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;     $                    <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment">*                       We need to check that the RQCORR update doesn&#39;t</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">*                       move the eigenvalue away from the desired one and</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">*                       towards a neighbor. -&gt; protection with bisection</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                        <span class="keywordflow">IF</span>(indeig.LE.negcnt) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment">*                          The wanted eigenvalue lies to the left</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                           sgndef = -one</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">*                          The wanted eigenvalue lies to the right</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                           sgndef = one</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="keywordflow">                        ENDIF</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment">*                       We only use the RQCORR if it improves the</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">*                       the iterate reasonably.</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                        <span class="keywordflow">IF</span>( ( rqcorr*sgndef.GE.zero )</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;     $                       .AND.( lambda + rqcorr.LE. right)</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;     $                       .AND.( lambda + rqcorr.GE. left)</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;     $                       ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                           usedrq = .true.</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment">*                          Store new midpoint of bisection interval in WORK</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                           <span class="keywordflow">IF</span>(sgndef.EQ.one) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment">*                             The current LAMBDA is on the left of the true</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment">*                             eigenvalue</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                              left = lambda</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                           <span class="keywordflow">ELSE</span>   </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment">*                             The current LAMBDA is on the right of the true</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment">*                             eigenvalue</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                              right = lambda</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="keywordflow">                           ENDIF</span>  </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                           work( windex ) = </div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;     $                       half * (right + left)</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment">*                          Take RQCORR since it has the correct sign and</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment">*                          improves the iterate reasonably</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                           lambda = lambda + rqcorr</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment">*                          Update width of error interval</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                           werr( windex ) =                </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;     $                             half * (right-left)</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                           needbs = .true.</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="keywordflow">                        ENDIF</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                        <span class="keywordflow">IF</span>(right-left.LT.rqtol*abs(lambda)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="comment">*                             The eigenvalue is computed to bisection accuracy</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="comment">*                             compute eigenvector and stop</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                           usedbs = .true.</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                           <span class="keywordflow">GOTO</span> 120</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                        <span class="keywordflow">ELSEIF</span>( iter.LT.maxitr ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                           <span class="keywordflow">GOTO</span> 120</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                        <span class="keywordflow">ELSEIF</span>( iter.EQ.maxitr ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                           needbs = .true.</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                           <span class="keywordflow">GOTO</span> 120</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                           info = 5</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                           <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="keywordflow">                        END IF</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                     <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                        stp2ii = .false.</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                        <span class="keywordflow">IF</span>(usedrq .AND. usedbs .AND. </div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;     $                     bstres.LE.resid) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                           lambda = bstw</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                           stp2ii = .true.</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="keywordflow">                        ENDIF</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                        <span class="keywordflow">IF</span> (stp2ii) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                           <span class="keyword">CALL </span>slar1va( in, 1, in, lambda,</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;     $                          d( ibegin ), l( ibegin ), </div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;     $                          work(indld+ibegin-1), </div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;     $                          work(indlld+ibegin-1),</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;     $                          pivmin, gaptol, </div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;     $                          z( ibegin, zindex ),</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;     $                          .NOT.usedbs, negcnt, ztz, mingma,</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;     $                          itwist, </div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;     $                          isuppz( 2*windex-1 ),</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;     $                          nrminv, resid, rqcorr, work( indwrk ) )</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="keywordflow">                        ENDIF</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                        work( windex ) = lambda</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="keywordflow">                     END IF</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="comment">*                    Compute FP-vector support w.r.t. whole matrix</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                     isuppz( 2*windex-1 ) = isuppz( 2*windex-1 )+oldien</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                     isuppz( 2*windex ) = isuppz( 2*windex )+oldien</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                     zfrom = isuppz( 2*windex-1 )</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                     zto = isuppz( 2*windex )</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                     isupmn = isupmn + oldien</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                     isupmx = isupmx + oldien</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="comment">*                    Ensure vector is ok if support in the RQI has changed</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                     <span class="keywordflow">IF</span>(isupmn.LT.zfrom) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                        <span class="keywordflow">DO</span> 122 ii = isupmn,zfrom-1</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                           z( ii, zindex ) = zero</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160; 122                    <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="keywordflow">                     ENDIF</span>   </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                     <span class="keywordflow">IF</span>(isupmx.GT.zto) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                        <span class="keywordflow">DO</span> 123 ii = zto+1,isupmx</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                           z( ii, zindex ) = zero</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160; 123                    <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="keywordflow">                     ENDIF</span>   </div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                     <span class="keyword">CALL </span>sscal( zto-zfrom+1, nrminv,</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;     $                       z( zfrom, zindex ), 1 )</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; 125                 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="comment">*                    Update W </span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                     w( windex ) = lambda+sigma</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="comment">*                    Recompute the gaps on the left and right</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="comment">*                    But only allow them to become larger and not</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="comment">*                    smaller (which can only happen through &quot;bad&quot;</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment">*                    cancellation and doesn&#39;t reflect the theory</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="comment">*                    where the initial gaps are underestimated due</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="comment">*                    to WERR being too crude.)</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                     <span class="keywordflow">IF</span>(.NOT.eskip) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                        <span class="keywordflow">IF</span>( k.GT.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                           wgap( windmn ) = <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( wgap(windmn),</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;     $                          w(windex)-werr(windex) </div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;     $                          - w(windmn)-werr(windmn) )</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="keywordflow">                        ENDIF</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                        <span class="keywordflow">IF</span>( windex.LT.wend ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                           wgap( windex ) = <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( savegp, </div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;     $                          w( windpl )-werr( windpl ) </div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;     $                          - w( windex )-werr( windex) )</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="keywordflow">                        ENDIF</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="keywordflow">                     ENDIF</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="keywordflow">                  ENDIF</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="comment">*                 here ends the code for the current child</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160; 139              <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="comment">*                 Proceed to any remaining child nodes</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                  newfst = j + 1</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160; 140           <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160; 150        <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="comment">*           Store number of clusters             </span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;            iwork( iincls + jblk ) = nclus</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;         ibegin = iend + 1</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;         wbegin = wend + 1</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160; 170  <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="comment">*     Check if everything is done: no clusters left for </span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="comment">*     this processor in any block</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      finish = .true.</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      <span class="keywordflow">DO</span> 180 jblk = 1, iblock( m )      </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;         finish = finish .AND. (iwork(iincls + jblk).EQ.0)</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160; 180  <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160; </div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;      <span class="keywordflow">IF</span>(.NOT.finish) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;         ndepth = ndepth + 1</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;         <span class="keywordflow">IF</span>((needil.GE.dol).AND.(neediu.LE.dou)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="comment">*           Once this processor&#39;s part of the </span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="comment">*           representation tree consists exclusively of eigenvalues</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="comment">*           between DOL and DOU, it can work independently from all </span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="comment">*           others.</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;            <span class="keywordflow">GOTO</span> 40</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="keywordflow">         ENDIF</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160; </div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="comment">*     End of SLARRV2</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      <span class="keyword">END</span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="apcgemr_8c_html_a24e753bacac6be5f30e18f8a2bdefda4"><div class="ttname"><a href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a></div><div class="ttdeci">#define max(A, B)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dad/pcgemr_8c_source.html#l00180">pcgemr.c:180</a></div></div>
<div class="ttc" id="aslarrv2_8f_html_a9f3582f5994be29f7e4b0061e35008dd"><div class="ttname"><a href="../../d4/d69/slarrv2_8f.html#a9f3582f5994be29f7e4b0061e35008dd">slarrv2</a></div><div class="ttdeci">subroutine slarrv2(N, VL, VU, D, L, PIVMIN, ISPLIT, M, DOL, DOU, NEEDIL, NEEDIU, MINRGP, RTOL1, RTOL2, W, WERR, WGAP, IBLOCK, INDEXW, GERS, SDIAM, Z, LDZ, ISUPPZ, WORK, IWORK, VSTART, FINISH, MAXCLS, NDEPTH, PARITY, ZOFFSET, INFO)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d69/slarrv2_8f_source.html#l00008">slarrv2.f:8</a></div></div>
<div class="ttc" id="aslarrf2_8f_html_adb7f59f6153d9f99ea0bb3304fc6937e"><div class="ttname"><a href="../../d7/db3/slarrf2_8f.html#adb7f59f6153d9f99ea0bb3304fc6937e">slarrf2</a></div><div class="ttdeci">subroutine slarrf2(N, D, L, LD, CLSTRT, CLEND, CLMID1, CLMID2, W, WGAP, WERR, TRYMID, SPDIAM, CLGAPL, CLGAPR, PIVMIN, SIGMA, DPLUS, LPLUS, WORK, INFO)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/slarrf2_8f_source.html#l00005">slarrf2.f:5</a></div></div>
<div class="ttc" id="apcgemr_8c_html_a2d017cd3beb218080a7988e2deed2a11"><div class="ttname"><a href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a></div><div class="ttdeci">#define min(A, B)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dad/pcgemr_8c_source.html#l00181">pcgemr.c:181</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_1e771ff450ae847412a8c28572c155bb.html">SRC</a></li><li class="navelem"><a class="el" href="../../d4/d69/slarrv2_8f.html">slarrv2.f</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
  </ul>
</div>
</body>
</html>
