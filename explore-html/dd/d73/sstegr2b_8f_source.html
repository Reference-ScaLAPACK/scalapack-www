<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ScaLAPACK 2.1: SRC/sstegr2b.f Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../ScaLAPACK logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ScaLAPACK 2.1
   &#160;<span id="projectnumber">2.1</span>
   </div>
   <div id="projectbrief">ScaLAPACK: Scalable Linear Algebra PACKage</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('dd/d73/sstegr2b_8f_source.html','../../');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">sstegr2b.f</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../dd/d73/sstegr2b_8f.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;      <span class="keyword">SUBROUTINE </span><a class="code" href="../../dd/d73/sstegr2b_8f.html#a97ac74a0ccca4a076750c8ada7f72f97">sstegr2b</a>( JOBZ, N, D, E, </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;     $                   M, W, Z, LDZ, NZC, ISUPPZ, WORK, LWORK, IWORK,</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;     $                   LIWORK, DOL, DOU, NEEDIL, NEEDIU,</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;     $                   INDWLC, PIVMIN, SCALE, WL, WU,</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;     $                   VSTART, FINISH, MAXCLS,</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;     $                   NDEPTH, PARITY, ZOFFSET, INFO )</div>
<div class="line"><a name="l00007"></a><span class="lineno"><a class="line" href="../../dd/d73/sstegr2b_8f.html#a97ac74a0ccca4a076750c8ada7f72f97">    7</a></span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">*  -- ScaLAPACK auxiliary routine (version 2.0) --</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">*     Univ. of Tennessee, Univ. of California Berkeley, Univ. of Colorado Denver</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">*     July 4, 2010</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">*     .. Scalar Arguments ..</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;      <span class="keywordtype">CHARACTER</span>          JOBZ</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;      <span class="keywordtype">INTEGER</span>            DOL, DOU, INDWLC, INFO, LDZ, LIWORK, LWORK, M,</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;     $                   maxcls, n, ndepth, needil, neediu, nzc, parity,</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;     $                   zoffset</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keywordtype">      REAL</span>             PIVMIN, SCALE, WL, WU</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;      <span class="keywordtype">LOGICAL</span> VSTART, FINISH</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">*     .. Array Arguments ..</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;      <span class="keywordtype">INTEGER</span>            ISUPPZ( * ), IWORK( * )</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keywordtype">      REAL</span>               D( * ), E( * ), W( * ), WORK( * )</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;      <span class="keywordtype">REAL</span>               Z( LDZ, * )</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">*  Purpose</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">*  =======</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">*  SSTEGR2B should only be called after a call to SSTEGR2A.</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">*  From eigenvalues and initial representations computed by SSTEGR2A,</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">*  SSTEGR2B computes the selected eigenvalues and eigenvectors</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">*  of the real symmetric tridiagonal matrix in parallel </span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">*  on multiple processors. It is potentially invoked multiple times</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">*  on a given processor because the locally relevant representation tree </span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">*  might depend on spectral information that is &quot;owned&quot; by other processors</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">*  and might need to be communicated. </span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">* </span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">*  Please note:</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">*  1. The calling sequence has two additional INTEGER parameters, </span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">*     DOL and DOU, that should satisfy M&gt;=DOU&gt;=DOL&gt;=1. </span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">*     These parameters are only relevant for the case JOBZ = &#39;V&#39;.</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">*     SSTEGR2B  ONLY computes the eigenVECTORS </span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">*     corresponding to eigenvalues DOL through DOU in W. (That is,</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">*     instead of computing the eigenvectors belonging to W(1) </span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">*     through W(M), only the eigenvectors belonging to eigenvalues</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">*     W(DOL) through W(DOU) are computed. In this case, only the</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">*     eigenvalues DOL:DOU are guaranteed to be accurately refined</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">*     to all figures by Rayleigh-Quotient iteration.</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">*  2. The additional arguments VSTART, FINISH, NDEPTH, PARITY, ZOFFSET </span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">*     are included as a thread-safe implementation equivalent to SAVE variables.</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">*     These variables store details about the local representation tree which is</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">*     computed layerwise. For scalability reasons, eigenvalues belonging to the </span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">*     locally relevant representation tree might be computed on other processors.</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">*     These need to be communicated before the inspection of the RRRs can proceed</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">*     on any given layer.           </span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">*     Note that only when the variable FINISH is true, the computation has ended</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">*     All eigenpairs between DOL and DOU have been computed. M is set = DOU - DOL + 1.</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">*  3. SSTEGR2B needs more workspace in Z than the sequential SSTEGR. </span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">*     It is used to store the conformal embedding of the local representation tree.  </span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">*  </span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">*  Arguments</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">*  =========</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">*  JOBZ    (input) CHARACTER*1</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">*          = &#39;N&#39;:  Compute eigenvalues only;</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">*          = &#39;V&#39;:  Compute eigenvalues and eigenvectors.</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">*  N       (input) INTEGER</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">*          The order of the matrix.  N &gt;= 0.</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">*  D       (input/output) REAL array, dimension (N)</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">*          On entry, the N diagonal elements of the tridiagonal matrix</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">*          T. On exit, D is overwritten.</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">*  E       (input/output) REAL array, dimension (N)</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">*          On entry, the (N-1) subdiagonal elements of the tridiagonal</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">*          matrix T in elements 1 to N-1 of E. E(N) need not be set on</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">*          input, but is used internally as workspace.</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">*          On exit, E is overwritten.</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">*  M       (input) INTEGER</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">*          The total number of eigenvalues found</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">*          in SSTEGR2A.  0 &lt;= M &lt;= N.</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">*  W       (input) REAL array, dimension (N)</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">*          The first M elements contain approximations to the selected </span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">*          eigenvalues in ascending order. Note that only the eigenvalues from</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">*          the locally relevant part of the representation tree, that is</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">*          all the clusters that include eigenvalues from DOL:DOU, are reliable </span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">*          on this processor. (It does not need to know about any others anyway.)</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">*  Z       (output) REAL array, dimension (LDZ, max(1,M) )</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">*          If JOBZ = &#39;V&#39;, and if INFO = 0, then </span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">*          a subset of the first M columns of Z</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">*          contain the orthonormal eigenvectors of the matrix T</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">*          corresponding to the selected eigenvalues, with the i-th</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">*          column of Z holding the eigenvector associated with W(i).</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">*          See DOL, DOU for more information.</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">*  LDZ     (input) INTEGER</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">*          The leading dimension of the array Z.  LDZ &gt;= 1, and if</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">*          JOBZ = &#39;V&#39;, then LDZ &gt;= max(1,N).</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">*  NZC     (input) INTEGER</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">*          The number of eigenvectors to be held in the array Z.  </span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">*  ISUPPZ  (output) INTEGER ARRAY, dimension ( 2*max(1,M) )</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">*          The support of the eigenvectors in Z, i.e., the indices</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">*          indicating the nonzero elements in Z. The i-th computed eigenvector</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">*          is nonzero only in elements ISUPPZ( 2*i-1 ) through</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">*          ISUPPZ( 2*i ). This is relevant in the case when the matrix </span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">*          is split. ISUPPZ is only set if N&gt;2.</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">*  WORK    (workspace/output) REAL array, dimension (LWORK)</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">*          On exit, if INFO = 0, WORK(1) returns the optimal</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">*          (and minimal) LWORK.</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">*  LWORK   (input) INTEGER</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">*          The dimension of the array WORK. LWORK &gt;= max(1,18*N)</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">*          if JOBZ = &#39;V&#39;, and LWORK &gt;= max(1,12*N) if JOBZ = &#39;N&#39;.</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">*          If LWORK = -1, then a workspace query is assumed; the routine</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">*          only calculates the optimal size of the WORK array, returns</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">*          this value as the first entry of the WORK array, and no error</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">*          message related to LWORK is issued.</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">*  IWORK   (workspace/output) INTEGER array, dimension (LIWORK)</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">*          On exit, if INFO = 0, IWORK(1) returns the optimal LIWORK.</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">*  LIWORK  (input) INTEGER</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">*          The dimension of the array IWORK.  LIWORK &gt;= max(1,10*N)</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">*          if the eigenvectors are desired, and LIWORK &gt;= max(1,8*N)</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">*          if only the eigenvalues are to be computed.</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">*          If LIWORK = -1, then a workspace query is assumed; the</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">*          routine only calculates the optimal size of the IWORK array,</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">*          returns this value as the first entry of the IWORK array, and</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">*          no error message related to LIWORK is issued.</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">*  DOL     (input) INTEGER</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">*  DOU     (input) INTEGER</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">*          From the eigenvalues W(1:M), only eigenvectors </span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">*          Z(:,DOL) to Z(:,DOU) are computed.</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">*          If DOL &gt; 1, then Z(:,DOL-1-ZOFFSET) is used and overwritten.</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">*          If DOU &lt; M, then Z(:,DOU+1-ZOFFSET) is used and overwritten.</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">*  NEEDIL  (input/output) INTEGER </span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">*  NEEDIU  (input/output) INTEGER</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">*          Describes which are the left and right outermost eigenvalues </span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">*          still to be computed. Initially computed by SLARRE2A,</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">*          modified in the course of the algorithm.</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">*  INDWLC  (output) REAL</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">*          Pointer into the workspace, location where the local</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">*          eigenvalue representations are stored. (&quot;Local eigenvalues&quot;</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">*          are those relative to the individual shifts of the RRRs.)</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">*  PIVMIN  (input) REAL</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">*          The minimum pivot in the sturm sequence for T.</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">*  SCALE   (input) REAL </span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">*          The scaling factor for T. Used for unscaling the eigenvalues</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">*          at the very end of the algorithm.</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">*  WL      (input) REAL</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">*  WU      (input) REAL</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">*          The interval (WL, WU] contains all the wanted eigenvalues.         </span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">*  VSTART  (input/output) LOGICAL </span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">*          .TRUE. on initialization, set to .FALSE. afterwards.</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">*  FINISH  (input/output) LOGICAL</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">*          indicates whether all eigenpairs have been computed</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">*  MAXCLS  (input/output) INTEGER</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">*          The largest cluster worked on by this processor in the</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">*          representation tree.</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">*  NDEPTH  (input/output) INTEGER</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">*          The current depth of the representation tree. Set to</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">*          zero on initial pass, changed when the deeper levels of</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">*          the representation tree are generated. </span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">*  PARITY  (input/output) INTEGER</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">*          An internal parameter needed for the storage of the</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">*          clusters on the current level of the representation tree.</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">*  ZOFFSET (input) INTEGER</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">*          Offset for storing the eigenpairs when Z is distributed</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">*          in 1D-cyclic fashion</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">*  INFO    (output) INTEGER</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">*          On exit, INFO</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">*          = 0:  successful exit</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">*          other:if INFO = -i, the i-th argument had an illegal value</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">*                if INFO = 20X, internal error in SLARRV2.</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">*                Here, the digit X = ABS( IINFO ) &lt; 10, where IINFO is </span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">*                the nonzero error code returned by SLARRV2.</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">*     .. Parameters ..</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="keywordtype">      REAL</span>               ONE, FOUR, MINRGP</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="keywordtype">PARAMETER</span>          ( ONE = 1.0e0,</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;     $                     four = 4.0e0,</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;     $                     minrgp = 3.0e-3 )</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">*     .. Local Scalars ..</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="keywordtype">LOGICAL</span>            LQUERY, WANTZ, ZQUERY</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="keywordtype">INTEGER</span>            IINDBL, IINDW, IINDWK, IINFO, IINSPL, INDERR,</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;     $                   INDGP, INDGRS, INDSDM, INDWRK, ITMP, J, LIWMIN,</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;     $                   LWMIN</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keywordtype">REAL</span>               EPS, RTOL1, RTOL2</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">*     .. External Functions ..</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <span class="keywordtype">LOGICAL</span>            LSAME</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="keywordtype">REAL</span>               SLAMCH, SLANST</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <span class="keywordtype">EXTERNAL</span>           lsame, slamch, slanst</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">*     .. External Subroutines ..</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="keywordtype">EXTERNAL</span>           <a class="code" href="../../d4/d69/slarrv2_8f.html#a9f3582f5994be29f7e4b0061e35008dd">slarrv2</a>, sscal</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">*     .. Intrinsic Functions ..</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <span class="keywordtype">INTRINSIC</span>          <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>, <a class="code" href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a>, real, sqrt</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">*     ..</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">*     .. Executable Statements ..</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">*     Test the input parameters.</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      wantz = lsame( jobz, <span class="stringliteral">&#39;V&#39;</span> )</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      lquery = ( ( lwork.EQ.-1 ).OR.( liwork.EQ.-1 ) )</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      zquery = ( nzc.EQ.-1 )</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">*     SSTEGR2B needs WORK of size 6*N, IWORK of size 3*N.</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">*     In addition, SLARRE2A needed WORK of size 6*N, IWORK of size 5*N.</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">*     Workspace is kept consistent even though SLARRE2A is not called here.</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">*     Furthermore, SLARRV2 needs WORK of size 12*N, IWORK of size 7*N.</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="keywordflow">IF</span>( wantz ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;         lwmin = 18*n</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;         liwmin = 10*n</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">*        need less workspace if only the eigenvalues are wanted         </span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;         lwmin = 12*n</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;         liwmin = 8*n</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      info = 0</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">*     Get machine constants.</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      eps = slamch( <span class="stringliteral">&#39;Precision&#39;</span> )</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="keywordflow">IF</span>( (n.EQ.0).OR.(n.EQ.1) ) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;         finish = .true.       </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;         <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="keywordflow">IF</span>(zquery.OR.lquery)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;     $   <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      indgrs = 1</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      inderr = 2*n + 1</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      indgp = 3*n + 1</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      indsdm = 4*n + 1</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      indwrk = 6*n + 1</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      indwlc = indwrk</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      iinspl = 1</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      iindbl = n + 1</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      iindw = 2*n + 1</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      iindwk = 3*n + 1</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">*     Set the tolerance parameters for bisection</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      rtol1 = four*sqrt(eps)</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      rtol2 = <a class="code" href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>( sqrt(eps)*5.0e-3, four * eps )</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="keywordflow">IF</span>( wantz ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">*        Compute the desired eigenvectors corresponding to the computed</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">*        eigenvalues</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;         <span class="keyword">CALL </span><a class="code" href="../../d4/d69/slarrv2_8f.html#a9f3582f5994be29f7e4b0061e35008dd">slarrv2</a>( n, wl, wu, d, e,</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;     $                pivmin, iwork( iinspl ), m, </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;     $                dol, dou, needil, neediu, minrgp, rtol1, rtol2, </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;     $                w, work( inderr ), work( indgp ), iwork( iindbl ),</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;     $                iwork( iindw ), work( indgrs ), </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;     $                work( indsdm ), z, ldz,</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;     $                isuppz, work( indwrk ), iwork( iindwk ), </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;     $                vstart, finish, </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;     $                maxcls, ndepth, parity, zoffset, iinfo )</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;         <span class="keywordflow">IF</span>( iinfo.NE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            info = 200 + abs( iinfo )</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">*        SLARRE2A computed eigenvalues of the (shifted) root representation</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">*        SLARRV2 returns the eigenvalues of the unshifted matrix.</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">*        However, if the eigenvectors are not desired by the user, we need</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">*        to apply the corresponding shifts from SLARRE2A to obtain the </span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">*        eigenvalues of the original matrix. </span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;         <span class="keywordflow">DO</span> 30 j = 1, m</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            itmp = iwork( iindbl+j-1 )</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            w( j ) = w( j ) + e( iwork( iinspl+itmp-1 ) )</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; 30      <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;         finish = .true.</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="keywordflow">IF</span>(finish) <span class="keywordflow">THEN</span>        </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">*        All eigenpairs have been computed       </span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">*        If matrix was scaled, then rescale eigenvalues appropriately.</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;         <span class="keywordflow">IF</span>( scale.NE.one ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="keyword">CALL </span>sscal( m, one / scale, w, 1 )</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">*        Correct M if needed </span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;         <span class="keywordflow">IF</span> ( wantz ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            <span class="keywordflow">IF</span>( dol.NE.1 .OR. dou.NE.m ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;               m = dou - dol +1</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="keywordflow">            ENDIF</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="keywordflow">         ENDIF</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">*        No sorting of eigenpairs is done here, done later in the</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">*        calling subroutine</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;         work( 1 ) = lwmin</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;         iwork( 1 ) = liwmin</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">*     End of SSTEGR2B</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <span class="keyword">END</span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="apcgemr_8c_html_a24e753bacac6be5f30e18f8a2bdefda4"><div class="ttname"><a href="../../d4/dad/pcgemr_8c.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a></div><div class="ttdeci">#define max(A, B)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dad/pcgemr_8c_source.html#l00180">pcgemr.c:180</a></div></div>
<div class="ttc" id="aslarrv2_8f_html_a9f3582f5994be29f7e4b0061e35008dd"><div class="ttname"><a href="../../d4/d69/slarrv2_8f.html#a9f3582f5994be29f7e4b0061e35008dd">slarrv2</a></div><div class="ttdeci">subroutine slarrv2(N, VL, VU, D, L, PIVMIN, ISPLIT, M, DOL, DOU, NEEDIL, NEEDIU, MINRGP, RTOL1, RTOL2, W, WERR, WGAP, IBLOCK, INDEXW, GERS, SDIAM, Z, LDZ, ISUPPZ, WORK, IWORK, VSTART, FINISH, MAXCLS, NDEPTH, PARITY, ZOFFSET, INFO)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d69/slarrv2_8f_source.html#l00008">slarrv2.f:8</a></div></div>
<div class="ttc" id="asstegr2b_8f_html_a97ac74a0ccca4a076750c8ada7f72f97"><div class="ttname"><a href="../../dd/d73/sstegr2b_8f.html#a97ac74a0ccca4a076750c8ada7f72f97">sstegr2b</a></div><div class="ttdeci">subroutine sstegr2b(JOBZ, N, D, E, M, W, Z, LDZ, NZC, ISUPPZ, WORK, LWORK, IWORK, LIWORK, DOL, DOU, NEEDIL, NEEDIU, INDWLC, PIVMIN, SCALE, WL, WU, VSTART, FINISH, MAXCLS, NDEPTH, PARITY, ZOFFSET, INFO)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d73/sstegr2b_8f_source.html#l00007">sstegr2b.f:7</a></div></div>
<div class="ttc" id="apcgemr_8c_html_a2d017cd3beb218080a7988e2deed2a11"><div class="ttname"><a href="../../d4/dad/pcgemr_8c.html#a2d017cd3beb218080a7988e2deed2a11">min</a></div><div class="ttdeci">#define min(A, B)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dad/pcgemr_8c_source.html#l00181">pcgemr.c:181</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_1e771ff450ae847412a8c28572c155bb.html">SRC</a></li><li class="navelem"><a class="el" href="../../dd/d73/sstegr2b_8f.html">sstegr2b.f</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
  </ul>
</div>
</body>
</html>
